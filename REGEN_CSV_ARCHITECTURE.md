# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ CSV (–í–µ—Ä—Å–∏—è 2.0)

**üìå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å–æ–∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ (Co-authorship):** —Å–º. [COAUTHORSHIP_FEATURE.md](COAUTHORSHIP_FEATURE.md)

## –û–ë–ù–û–í–õ–ï–ù–ò–ï (–§–µ–≤—Ä–∞–ª—å 2026): –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–æ–¥—É–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–∞ –Ω–∞ –º–æ–¥—É–ª—å–Ω—É—é 6-PASS –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:**

```
–ë—ã–ª–æ:  regen_csv.py (1951 —Å—Ç—Ä–æ–∫) ‚Üê –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª
–°—Ç–∞–ª–æ: passes/ (9 –º–æ–¥—É–ª–µ–π = ~600 —Å—Ç—Ä–æ–∫) ‚Üê –ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ **folder_author_parser** ‚Üí –ø–∞–ø–∫–∞ `passes/folder_author_parser/` (PASS0+PASS1+PASS2)
- ‚úÖ –ö–∞–∂–¥—ã–π PASS –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –ø–æ–¥ `passes/`
- ‚úÖ **orchestrator** `regen_csv.py` (158 —Å—Ç—Ä–æ–∫) –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—Å–µ PASS'—ã
- ‚úÖ **precache.py** –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (PRECACHE —Ñ–∞–∑–∞)
- ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã
- ‚úÖ CSV —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è: 337 —Ñ–∞–π–ª–æ–≤, 291 (86.4%) –∏–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫

**–°–º–æ—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª 1 –Ω–∏–∂–µ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã 2.0**

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ò—Å—Ç–æ—á–Ω–∏–∫ FB2 —Ñ–∞–π–ª–æ–≤ vs –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ß—Ç–µ–Ω–∏–µ FB2 —Ñ–∞–π–ª–æ–≤

**–í—Å–µ FB2 —Ñ–∞–π–ª—ã —Å–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è –∏–∑ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º config.json:**

```json
"last_scan_path": "C:/Users/dmitriy.murov/Downloads/TriblerDownloads/Test1"
```

- **last_scan_path** = —Ä–∞–±–æ—á–∞—è –ø–∞–ø–∫–∞, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è FB2 —Ñ–∞–π–ª—ã (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
- **library_path** = –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤!
- –ê–ª–≥–æ—Ä–∏—Ç–º: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∏—â–µ—Ç –≤—Å–µ `*.fb2` –≤ `last_scan_path` –∏ –µ–≥–æ –ø–æ–¥–ø–∞–ø–∫–∞—Ö
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ CSV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç `last_scan_path`

### ‚≠ê –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ CSV —Ñ–∞–π–ª–∞

**CSV —Ñ–∞–π–ª –í–°–ï–ì–î–ê —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É –ü–†–û–ï–ö–¢–ê (c:\\Temp\\fb2parser), –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç last_scan_path!**

```
c:\Temp\fb2parser\regen.csv  ‚Üê –§–ò–ö–°–ò–†–û–í–ê–ù–ù–û–ï –ú–ï–°–¢–û
                              (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç config.json)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- project_dir –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø–∞–ø–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ `regen_csv.py`
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ CSV –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 2.0: –ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ PASS (–§–µ–≤—Ä–∞–ª—å 2026)

### 1.0 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

CSV —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ **6-PASS —Å–∏—Å—Ç–µ–º–∞ —Å PRECACHE**, —Ä–∞–∑–±–∏—Ç–∞—è –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥—É–ª–∏:

```
fb2parser/
‚îú‚îÄ‚îÄ passes/                               # PASS stages + folder_author_parser
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py                      # –≠–∫—Å–ø–æ—Ä—Ç—ã –≤—Å–µ—Ö PASS –∫–ª–∞—Å—Å–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ pass1_read_files.py              # PASS 1: –ß–∏—Ç–∞—Ç—å FB2, –∏–∑–≤–ª–µ—á—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ pass2_filename.py                # PASS 2: –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ pass2_fallback.py                # PASS 2 Fallback: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω—è—è –Ω–∞–¥–µ–∂–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ pass3_normalize.py               # PASS 3: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ pass4_consensus.py               # PASS 4: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å (—Å –∑–∞—â–∏—Ç–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ pass5_conversions.py             # PASS 5: –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–∏—Ç—å conversions
‚îÇ   ‚îú‚îÄ‚îÄ pass6_abbreviations.py           # PASS 6: –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ folder_author_parser/            # –ü–∞—Ä—Å–∏–Ω–≥ –∏–º—ë–Ω –ø–∞–ø–æ–∫ (PASS0+PASS1+PASS2)
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py                  # –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è parse_author_from_folder_name()
‚îÇ       ‚îú‚îÄ‚îÄ pass0_structural_analysis.py # PASS0: –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (—Å–∫–æ–±–∫–∏, –∑–∞–ø—è—Ç—ã–µ, –¥–µ—Ñ–∏—Å—ã)
‚îÇ       ‚îú‚îÄ‚îÄ pass1_pattern_selection.py   # PASS1: –í—ã–±–æ—Ä –∏–∑ 7 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ pass2_author_extraction.py   # PASS2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
‚îÇ
‚îú‚îÄ‚îÄ precache.py                          # PRECACHE: –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫
‚îú‚îÄ‚îÄ regen_csv.py                         # Orchestrator: –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—Å–µ PASS'—ã
‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã)
```

### 1.1 –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ë—ã–ª–æ (–º–æ–Ω–æ–ª–∏—Ç) | –°—Ç–∞–ª–æ (–º–æ–¥—É–ª–∏) |
|---|---|---|
| **–†–∞–∑–º–µ—Ä regen_csv.py** | 1951 —Å—Ç—Ä–æ–∫ | 158 —Å—Ç—Ä–æ–∫ |
| **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | –°–ª–æ–∂–Ω–æ | –ö–∞–∂–¥—ã–π PASS –Ω–µ–∑–∞–≤–∏—Å–∏–º |
| **–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å** | –ó–∞–ø—É—Ç–∞–Ω–Ω—ã–π –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª | –Ø—Å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ |
| **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** | –¢—Ä—É–¥–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å | –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ PASS'—ã |
| **–û—Ç–ª–∞–¥–∫–∞** | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–º–µ—à–∞–Ω–æ | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –ø–æ PASS |

### 1.2 –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (Orchestrator)

```python
# regen_csv.py - –≥–ª–∞–≤–Ω—ã–π –æ—Ä—Ö–µ—Å—Ç—Ä–∞—Ç–æ—Ä
RegenCSVService.regenerate():
    ‚îÇ
    ‚îú‚îÄ PRECACHE (precache.py)
    ‚îÇ  ‚îî‚îÄ –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –ø–∞–ø–æ–∫ (74 –ø–∞–ø–∫–∏)
    ‚îÇ     ‚îú‚îÄ –°–∫–∞–Ω–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é folder_parse_limit=3
    ‚îÇ     ‚îú‚îÄ –ü–∞—Ä—Å–∏—Ç—å –∏–º–µ–Ω–∞ –ø–∞–ø–æ–∫ (folder_author_parser.parse_author_from_folder_name)
    ‚îÇ     ‚îî‚îÄ –í–µ—Ä–Ω—É—Ç—å Dict[Path, (author_name, confidence)]
    ‚îÇ
    ‚îú‚îÄ PASS 1 (pass1_read_files.py)
    ‚îÇ  ‚îî‚îÄ –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ FB2 —Ñ–∞–π–ª—ã (337 —Ñ–∞–π–ª–æ–≤)
    ‚îÇ     ‚îú‚îÄ –ò–∑–≤–ª–µ—á—å —Ñ–∞–±—É–ª–∞, –∞–≤—Ç–æ—Ä, —Å–µ—Ä–∏—é –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    ‚îÇ     ‚îú‚îÄ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ FROM folder cache (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: folder > metadata)
    ‚îÇ     ‚îî‚îÄ –í–µ—Ä–Ω—É—Ç—å List[BookRecord]
    ‚îÇ
    ‚îú‚îÄ PASS 2 (pass2_filename.py)
    ‚îÇ  ‚îî‚îÄ –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤
    ‚îÇ     ‚îú‚îÄ –ü–∞—Ç—Ç–µ—Ä–Ω—ã: " - ", ". ", ","
    ‚îÇ     ‚îî‚îÄ –¢–æ–ª—å–∫–æ –¥–ª—è records –±–µ–∑ folder_dataset
    ‚îÇ
    ‚îú‚îÄ PASS 2 Fallback (pass2_fallback.py)
    ‚îÇ  ‚îî‚îÄ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–∞–¥–µ–∂–¥—É
    ‚îÇ     ‚îî‚îÄ –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ proposed_author –≤—Å—ë –µ—â—ë –ø—É—Å—Ç
    ‚îÇ
    ‚îú‚îÄ PASS 3 (pass3_normalize.py)
    ‚îÇ  ‚îî‚îÄ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤
    ‚îÇ     ‚îî‚îÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å extractor._normalize_author_format()
    ‚îÇ
    ‚îú‚îÄ PASS 4 (pass4_consensus.py)
    ‚îÇ  ‚îî‚îÄ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å –∞–≤—Ç–æ—Ä–∞ –∫ –≥—Ä—É–ø–ø–∞–º –≤ –ø–∞–ø–∫–∞—Ö
    ‚îÇ     ‚îú‚îÄ –ó–∞—â–∏—Ç–∞: folder_dataset –∏ metadata –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
    ‚îÇ     ‚îî‚îÄ –ü—Ä–∏–º–µ–Ω—è—Ç—å –¢–û–õ–¨–ö–û –∫ undetermined records (author_source="")
    ‚îÇ
    ‚îú‚îÄ PASS 5 (pass5_conversions.py)
    ‚îÇ  ‚îî‚îÄ –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–∏—Ç—å author_surname_conversions
    ‚îÇ     ‚îî‚îÄ –ü–æ—Å–ª–µ PASS 4 (–∫–æ–Ω—Å–µ–Ω—Å—É—Å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ—Ä–æ–≤)
    ‚îÇ
    ‚îú‚îÄ PASS 6 (pass6_abbreviations.py)
    ‚îÇ  ‚îî‚îÄ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤
    ‚îÇ     ‚îú‚îÄ –ü–∞—Ç—Ç–µ—Ä–Ω: "–§–∞–º–∏–ª–∏—è –ò." ‚Üí "–§–∞–º–∏–ª–∏—è –ò–º—è"
    ‚îÇ     ‚îî‚îÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å –∏–º—ë–Ω –æ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤
    ‚îÇ
    ‚îî‚îÄ SAVE CSV
       ‚îî‚îÄ –ó–∞–ø–∏—Å–∞—Ç—å records –≤ regen.csv
```

### 1.3 –°—Ç–∞—Ç—É—Å PASS (–¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

| PASS | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–∞–ø–∏—Å–µ–π | –£—Å–ø–µ—à–Ω–æ | Status |
|---|---|---|---|---|
| PRECACHE | –ö—ç—à –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫ | ‚Äî | 74 –ø–∞–ø–∫–∏ | ‚úÖ |
| PASS 1 | –ß–∏—Ç–∞—Ç—å FB2 | 337 | 337 | ‚úÖ |
| PASS 2 | –ò–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ | ‚Äî | 46 –æ–±–Ω–æ–≤–ª–µ–Ω–æ | ‚úÖ |
| PASS 2 FB | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ fallback | ‚Äî | 0 –æ–±–Ω–æ–≤–ª–µ–Ω–æ | ‚úÖ |
| PASS 3 | –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è | 337 | 337 | ‚úÖ |
| PASS 4 | –ö–æ–Ω—Å–µ–Ω—Å—É—Å | 337 | ~5-10 –æ–±–Ω–æ–≤–ª–µ–Ω–æ | ‚úÖ |
| PASS 5 | Conversions | 337 | ~2-3 –æ–±–Ω–æ–≤–ª–µ–Ω–æ | ‚úÖ |
| PASS 6 | –°–æ–∫—Ä–∞—â–µ–Ω–∏—è | 337 | ~0-2 –æ–±–Ω–æ–≤–ª–µ–Ω–æ | ‚úÖ |

### 1.4 –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∞–≤—Ç–æ—Ä–æ–≤ (author_source field)

–ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –ø–æ–º–µ—á–µ–Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∞–≤—Ç–æ—Ä–∞:

```
folder_dataset:  291  (86.4%)  ‚Üê –∏–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫ (PRECACHE + PASS1)
filename:         46  (13.6%)  ‚Üê –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (PASS2)
metadata:          0  (0%)     ‚Üê –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö FB2 (PASS2 Fallback)
consensus:         0  (0%)     ‚Üê –∏–∑ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ (PASS4)
```

---

## 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: name_normalizer.py vs author_utils.py

### –ü—Ä–æ–±–ª–µ–º–∞: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ

–û–±–∞ —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–æ–≥–∏–∫—É –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–æ–≤, –Ω–æ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏:

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞  | `name_normalizer.py`              | `author_utils.py`                       |
|---              |---                                |---                                      |
| **–ö–ª–∞—Å—Å**       | `AuthorName`                      | `AuthorUtils`                           |
| **–§–æ–∫—É—Å**       | –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –∏–º–µ–Ω–∏         | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∫ –∑–∞–ø–∏—Å—è–º     |
| **–ü–æ–ª—è**        | `.raw_name`, `.normalized`        | –†–∞–±–æ—Ç–∞–µ—Ç —Å `BookRecord`                 |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è**   | –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º—É—Å–æ—Ä/blacklist       | –ö–æ–Ω—Å–µ–Ω—Å—É—Å –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏                 |
| **–ö–æ–Ω—Ñ–∏–≥**      | –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (static) | –ß–µ—Ä–µ–∑ `SettingsManager`                 |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | –¢–æ–ª—å–∫–æ config.json                | `SettingsManager`, `FB2AuthorExtractor` |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–ë–™–ï–î–ò–ù–ò–¢–¨ –í –û–î–ò–ù –§–ê–ô–õ

‚úÖ **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `author_utils.py` ‚Üí `author_normalizer_extended.py` –∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º:

```python
# –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- normalize_single_name()        # –ò–∑ name_normalizer.py
- validate_author_name()         # –ò–∑ name_normalizer.py
- apply_surname_conversions()    # –ò–∑ author_utils.py

# –§—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø–∏—Å–µ–π
- apply_surname_conversions_to_records()
- expand_abbreviated_authors()
- apply_author_consensus()
- build_authors_map()
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–¥–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–π
- –ï–¥–∏–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ñ–∏–≥–æ–º
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏

---

## 3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Å–ø–∏—Å–∫–∏ –∏–∑ config.json

### 3.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è regen_csv.py

```json
{
  "folder_parse_limit": 3,
  "author_surname_conversions": {
    "–ì–æ–±–ª–∏–Ω (MeXXanik)": "–ì–æ–±–ª–∏–Ω MeXXanik",
    "–ê–π–∑–µ–Ω–±–µ—Ä–≥": "–ë–µ—Ä–≥",
    "–°—Ç–∞—Ä–µ—Ü": "–°—Ç–∞—Ä–∏—Ü—ã–Ω"
  },
  "male_names": ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–Ω–¥—Ä–µ–π", "–ê—Ä—Ç–µ–º", "–í–∞—Å–∏–ª–∏–π", ...],
  "female_names": ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ê–ª–∏—Å–∞", "–ê–Ω–Ω–∞", "–í–∏–∫—Ç–æ—Ä–∏—è", ...],
  "filename_blacklist": ["–∫–æ–º–ø–∏–ª—è—Ü–∏—è", "—Å–±–æ—Ä–Ω–∏–∫", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è", "–∑–∞–≥—Ä—É–∑–∫–∏", ...],
  "service_words": ["—Ç–æ–º", "–∫–Ω–∏–≥–∞", "—á–∞—Å—Ç—å", "—á", "–∫–Ω", "vol", ...],
  "sequence_patterns": ["—Ç–æ–º \\d+", "–∫–Ω–∏–≥–∞ \\d+", ...],
  "author_series_patterns_in_files": [...],
  "author_series_patterns_in_folders": [...],
  "author_name_patterns": [...]
}
```

### 3.2 –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ regen_csv.py

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
settings = SettingsManager('config.json')
folder_parse_limit = settings.get_folder_parse_limit()           # –ì–ª—É–±–∏–Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫
male_names = settings.get_male_names()                           # –ú—É–∂—Å–∫–∏–µ –∏–º–µ–Ω–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞
female_names = settings.get_female_names()                       # –ñ–µ–Ω—Å–∫–∏–µ –∏–º–µ–Ω–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞
surname_conversions = settings.get_author_surname_conversions()  # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–º–∏–ª–∏–π
blacklist = settings.get_filename_blacklist()                    # –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —à—É–º–∞

# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
# 1. –î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä—Å–∫–æ–≥–æ –∏–º–µ–Ω–∏ (–Ω–µ –º—É—Å–æ—Ä –ª–∏)
if name in blacklist:
    skip_name()

# 2. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ "–ò–º—è –§–∞–º–∏–ª–∏—è" vs "–§–∞–º–∏–ª–∏—è –ò–º—è"
if first_word.lower() in male_names:
    order = "–ò–º—è –§–∞–º–∏–ª–∏—è"
else:
    order = "–§–∞–º–∏–ª–∏—è –ò–º—è"

# 3. –î–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ñ–∞–º–∏–ª–∏–π
if original_author in surname_conversions:
    canonical_author = surname_conversions[original_author]

# 4. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫ (PASS 1)
# folder_parse_limit = 3 ‚Üí —Å–º–æ—Ç—Ä–∏–º –º–∞–∫—Å–∏–º—É–º 3 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö –≤ –ø–∞–ø–∫–∞—Ö
```

---

## 4. –ü–æ–¥–∫–ª—é—á–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 3.1 `settings_manager.py` - SettingsManager

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
from settings_manager import SettingsManager
settings = SettingsManager('config.json')
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
settings.get_folder_parse_limit()        # ‚Üí int (–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ config.json: 3)
settings.get_generate_csv()              # ‚Üí bool (–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏ CSV)

# –°–ø–∏—Å–∫–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
settings.get_male_names()                 # ‚Üí List[str]
settings.get_female_names()               # ‚Üí List[str]
settings.get_filename_blacklist()         # ‚Üí List[str]
settings.get_service_words()              # ‚Üí List[str]
settings.get_author_surname_conversions() # ‚Üí Dict[str, str]

# –ü—É—Ç–∏ –∏ –∫–∞—Ç–∞–ª–æ–≥–∏
settings.get_library_path()              # ‚Üí str
settings.get_last_scan_path()            # ‚Üí str
settings.get_genres_file_path()          # ‚Üí str

# –†–∞–±–æ—Ç–∞ —Å –æ–∫–Ω–∞–º–∏
settings.set_window_size(name, w, h)
settings.get_window_sizes()
```

### 3.2 `fb2_author_extractor.py` - FB2AuthorExtractor

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
from fb2_author_extractor import FB2AuthorExtractor
extractor = FB2AuthorExtractor('config.json')
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

```python
# ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–ú –í regen_csv.py:

# 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É: –ø–∞–ø–∫–∞ ‚Üí —Ñ–∞–π–ª ‚Üí –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (PASS 1)
author, source = extractor.resolve_author_by_priority(fb2_filepath, folder_parse_limit)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: (–∞–≤—Ç–æ—Ä, "folder" / "filename" / "metadata")

# 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∞–≤—Ç–æ—Ä–∞ ("–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω")
normalized = extractor._normalize_author_format(author_string)

# 4. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä ("–ê.–§–∞–º–∏–ª–∏—è" ‚Üí "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –§–∞–º–∏–ª–∏—è")
expanded = extractor.expand_abbreviated_author(abbreviated, authors_map)

# 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º—ë–Ω (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
all_names = extractor.all_names  # Set –∏–∑ male_names + female_names

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–º–∏–ª–∏–∏ –≤ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∞—Ö
is_author = extractor.is_author(name)


```

### 3.3 `author_processor.py` - AuthorProcessor

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ FB2AuthorExtractor.**

**–ú–µ—Ç–æ–¥—ã –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã:**
```python
processor = self.extractor.author_processor

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (–∑–∞–º–µ–Ω–∞ —ë‚Üí–µ, etc)
normalized_text = processor.normalize_text(text)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∞ –ø–æ –∏–º–µ–Ω–∏
gender = processor.determine_gender(first_name)  # ‚Üí 'M', 'F', 'U' (Unknown)
```

### 3.4 `logger.py` - Logger

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:**
```python
from logger import Logger
logger = Logger()

logger.log("–°–æ–æ–±—â–µ–Ω–∏–µ")                    # –û–±—ã—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logger.log("–û—à–∏–±–∫–∞!", "error")             # –û—à–∏–±–∫–∞
logger.log("[PASS 1] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤")    # –° –ø—Ä–µ—Ñ–∏–∫—Å–æ–º
```

---

## 5. –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: 6 PASS —Å–∏—Å—Ç–µ–º—ã

### 4.0 PRECACHE Phase: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø–∞–ø–æ–∫

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ñ–∞–π–ª–æ–≤ –î–û PASS 1 –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø–∞–ø–æ–∫.

**–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:** –î–û PASS 1, –≤ –º–µ—Ç–æ–¥–µ `_build_author_folder_cache()`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–æ–π—Ç–∏ –≤—Å–µ –ø–∞–ø–∫–∏ –≤ work_dir –¥–æ folder_parse_limit —É—Ä–æ–≤–Ω–µ–π
2. –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–∏:
   a) –ü—Ä–∏–º–µ–Ω–∏—Ç—å folder_name conversions ("–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik")
   b) –ü—Ä–∏–º–µ–Ω–∏—Ç—å PASS0+PASS1+PASS2 structural analysis (—Å–º. —Ä–∞–∑–¥–µ–ª –Ω–∏–∂–µ)
   c) –ï—Å–ª–∏ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç FB2 —Ñ–∞–π–ª—ã –ò –∏–º—è –ø–∞—Ä—Å–∏—Ç—Å—è –∫–∞–∫ –∞–≤—Ç–æ—Ä ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫—çÃÅ—à
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: self.author_folder_cache = {Path: (author_name, confidence)}

PRECACHE –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø–∞–ø–æ–∫ –≤ PASS 1 (–∫—ç—à –≤–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ (–≤—Å–µ —Ñ–∞–π–ª—ã –ø–æ–¥ –∞–≤—Ç–æ—Ä—Å–∫–æ–π –ø–∞–ø–∫–æ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ (–ø–∞–ø–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑, consistency –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞)

–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–º—å—Ç–∞—Ç–∞ PRECACHE:
  Path("Books/–ì–æ–±–ª–∏–Ω (MeXXanik)") ‚Üí ("–ì–æ–±–ª–∏–Ω MeXXanik", "high")
  Path("Books/–°–±–æ—Ä–Ω–∏–∫ –∫–Ω–∏–≥")      ‚Üí –Ω–µ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è (–≤ blacklist)
  Path("Books/–ü–µ—Ç—Ä–æ–≤ –ò.")         ‚Üí ("–ü–µ—Ç—Ä–æ–≤ –ò.", "low")
```

**PASS0+PASS1+PASS2 Structural Analysis (–ø–æ–¥—Ä–æ–±–Ω–æ)**

–°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–º—ë–Ω –ø–∞–ø–æ–∫ –≤ `folder_author_parser.py`:

**PASS0: –ù–∞–π—Ç–∏ –≤—Å–µ —Å–∫–æ–±–∫–∏ –∏ –∏—Ö –ø–æ–∑–∏—Ü–∏–∏**
```python
# Input: "–ú–í–ü-2 (1) –û–¥–∏—Å—Å–µ—è –∫—Ä–µ–π—Å–µ—Ä–∞ ¬´–í–∞—Ä—è–≥¬ª (–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ß–µ—Ä–Ω–æ–≤)"
# –†–µ–∑—É–ª—å—Ç–∞—Ç PASS0:
parens = [
    (start=7, end=11, content='1'),
    (start=70, end=84, content='–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ß–µ—Ä–Ω–æ–≤')
]
```

**PASS1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω**
```python
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
patterns = [
    "Series (Author)",          # –ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∫–æ–±–∫–∞ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏
    "(Series) Author",          # –ü–µ—Ä–≤–∞—è —Å–∫–æ–±–∫–∞ –≤ –Ω–∞—á–∞–ª–µ
    "Author, Author",           # –ó–∞–ø—è—Ç–∞—è –≤ —Å–∫–æ–±–∫–µ –∏–ª–∏ –±–µ–∑
    "Author - Folder Name",     # –î–µ—Ñ–∏—Å —Ä–∞–∑–¥–µ–ª—è–µ—Ç
    "Series",                   # –ë–µ–∑ —Å–∫–æ–±–æ–∫
]

# –î–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:
last_paren_content = "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ß–µ—Ä–Ω–æ–≤"
text_after_last_paren = ""  # –ø—É—Å—Ç–æ (–ø–æ—Å —Å–∫–æ–±–∫–æ–π –Ω–∏—á–µ–≥–æ –Ω–µ—Ç)
text_before_first_paren = "–ú–í–ü-2 "  # –µ—Å—Ç—å —Ç–µ–∫—Å—Ç

# –í—ã–≤–æ–¥: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É "Series (Author)"
# –ü–æ—Ç–æ–º—É —á—Ç–æ: last_paren –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏ –ò –µ—Å—Ç—å text –î–û —Å–∫–æ–±–∫–∏
```

**PASS2: –ò–∑–≤–ª–µ—á—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É**
```python
# –î–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "Series (Author)":
series = text_before_last_paren = "–ú–í–ü-2"
author = last_paren_content = "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ß–µ—Ä–Ω–æ–≤"

# –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ß–µ—Ä–Ω–æ–≤"
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π–Ω—ã—Ö –ø–∞–ø–æ–∫ (Blacklist):**
```python
blacklist_starts = [
    '–°–µ—Ä–∏—è', '–°–±–æ—Ä–Ω–∏–∫', '–ö–æ–ª–ª–µ–∫—Ü–∏—è', '–ê–Ω—Ç–æ–ª–æ–≥–∏—è',
    '–¶–∏–∫–ª', '–ü–æ–¥–±–æ—Ä–∫–∞', '–ê—Ä—Ö–∏–≤', '–†–∞–∑–Ω–æ–µ', '–î—Ä—É–≥–æ–µ',
]

# –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —ç—Ç–∏—Ö —Å–ª–æ–≤ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ (–ù–ï –ø–∞—Ä—Å–∏–º –∫–∞–∫ –∞–≤—Ç–æ—Ä–∞)
if name.lower().startswith(word.lower()):
    return ""
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã PASS0+PASS1+PASS2:**
```
1. "–ì–æ–±–ª–∏–Ω (MeXXanik)"
   PASS0: –ø–∞—Äens = [(7, 18, 'MeXXanik')]
   PASS1: Pattern = "Series (Author)" (text –¥–æ —Å–∫–æ–±–∫–∏ + —Å–∫–æ–±–∫–∞ –≤ –∫–æ–Ω—Ü–µ)
   PASS2: author = "MeXXanik" ‚úÖ

2. "(–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞) –ü–µ—Ç—Ä–æ–≤ –ò."
   PASS0: parens = [(0, 19, '–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞')]
   PASS1: Pattern = "(Series) Author" (—Å–∫–æ–±–∫–∞ –≤ –Ω–∞—á–∞–ª–µ)
   PASS2: author = "–ü–µ—Ç—Ä–æ–≤ –ò." ‚úÖ

3. "–ë–µ–ª–∞—à –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –õ—é–¥–º–∏–ª–∞"
   PASS0: parens = [] (–Ω–µ—Ç —Å–∫–æ–±–æ–∫)
   PASS1: Pattern = "Author, Author" (–µ—Å—Ç—å –∑–∞–ø—è—Ç–∞—è)
   PASS2: authors = ["–ë–µ–ª–∞—à –ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–õ—é–¥–º–∏–ª–∞"] ‚Üí "–ë–µ–ª–∞—à –ê–ª–µ–∫—Å–∞–Ω–¥—Ä; –õ—é–¥–º–∏–ª–∞ –ë–µ–ª–∞—à" ‚úÖ

4. "–°–µ—Ä–∏—è - –§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"
   PASS0: parens = []
   PASS1: –ü—Ä–æ–≤–µ—Ä–∫–∞ blacklist: "–°–µ—Ä–∏—è" –≤ –Ω–∞—á–∞–ª–µ ‚úÖ
   PASS2: –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ (—ç—Ç–æ –ù–ï –∞–≤—Ç–æ—Ä) ‚ùå
```

**–†–∞–∑–ª–∏—á–∏–µ —Ç–∏–ø–æ–≤ –¥–µ—Ñ–∏—Å–æ–≤ –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö (–í–ê–ñ–ù–û!):**

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–ª–∏—á–∞–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ –¥–µ—Ñ–∏—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Ä–∞–∑–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:

1. **–°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ—Ñ–∏—Å (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)** - —á–∞—Å—Ç—å –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞/—Å–µ—Ä–∏–∏
   ```
   "–ú–í–ü-2"       ‚Üê –¥–µ—Ñ–∏—Å –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤, —á–∞—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∫–Ω–∏–≥–∏/—Å–µ—Ä–∏–∏
   "–§–ò-1 –ê—Ä—Ç—ë–º"  ‚Üê –¥–µ—Ñ–∏—Å —Å–≤—è–∑—ã–≤–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ç–µ–∫—Å—Ç
   
   –û–±—Ä–∞–±–æ—Ç–∫–∞: –≠—Ç–∏ –¥–µ—Ñ–∏—Å—ã –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
              –¢–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ—Ñ–∏—Å–æ–º –ù–ï —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –∞–≤—Ç–æ—Ä–æ–º
   ```

2. **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ—Ñ–∏—Å (—Å –ø—Ä–æ–±–µ–ª–∞–º–∏)** - —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
   ```
   "–ü–µ—Ç—Ä–æ–≤ –ò. - –ö–Ω–∏–≥–∞"      ‚Üê –¥–µ—Ñ–∏—Å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
   "–ì–æ–±–ª–∏–Ω - –ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤" ‚Üê –¥–µ—Ñ–∏—Å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
   
   –û–±—Ä–∞–±–æ—Ç–∫–∞: –≠—Ç–æ—Ç –¥–µ—Ñ–∏—Å –Ø–í–õ–Ø–ï–¢–°–Ø —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö
              –¢–µ–∫—Å—Ç –î–û –¥–µ—Ñ–∏—Å–∞ –ø–∞—Ä—Å–∏—Ç—Å—è –∫–∞–∫ –∞–≤—Ç–æ—Ä
              –¢–µ–∫—Å—Ç –ü–û–°–õ–ï –¥–µ—Ñ–∏—Å–∞ –ø–∞—Ä—Å–∏—Ç—Å—è –∫–∞–∫ –Ω–∞–∑–≤–∞–Ω–∏–µ/—Å–µ—Ä–∏—è
   ```

**–ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

```
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã:

"–ú–í–ü-2 (1) –û–¥–∏—Å—Å–µ—è (–ß–µ—Ä–Ω–æ–≤)"
  1. PASS0: –ù–∞–π—Ç–∏ —Å–∫–æ–±–∫–∏: [(7, 11, '1'), (70, 84, '–ß–µ—Ä–Ω–æ–≤')]
  2. PASS1: "–ú–í–ü-2" - —ç—Ç–æ —Ç–µ–∫—Å—Ç –î–û —Å–∫–æ–±–∫–∏ (—á–∞—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è)
           "(–ß–µ—Ä–Ω–æ–≤)" - —ç—Ç–æ —Å–∫–æ–±–∫–∞ –≤ –∫–æ–Ω—Ü–µ
           ‚Üí –ü–∞—Ç—Ç–µ—Ä–Ω: "Series (Author)"
  3. PASS2: author = "–ß–µ—Ä–Ω–æ–≤" ‚úÖ
  –ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç: "–ú–í–ü-2" –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å series, –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è –∫–∞–∫ –∞–≤—Ç–æ—Ä

"–ì–æ–±–ª–∏–Ω - –ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤ (–°–µ—Ä–∏—è 1-3)"
  1. PASS0: –ù–∞–π—Ç–∏ —Å–∫–æ–±–∫–∏: [(29, 48, '–°–µ—Ä–∏—è 1-3')]
  2. PASS1: –ï—Å—Ç—å –¥–µ—Ñ–∏—Å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ " - " ‚Üí –ø–∞—Ç—Ç–µ—Ä–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å "Author - Title"
  3. –ü—Ä–æ–≤–µ—Ä–∫–∞: text –±–µ—Ä—ë—Ç–æ –¥–æ –¥–µ—Ñ–∏—Å–∞, –ø–æ—Å–ª–µ –¥–µ—Ñ–∏—Å–∞
  ‚Üí –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω —Å–æ —Å–∫–æ–±–∫–æ–π –≤ –∫–æ–Ω—Ü–µ "Author - Series (service_words)"
  PASS2: author = "–ì–æ–±–ª–∏–Ω", series = "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤", service_word = "–°–µ—Ä–∏—è 1-3" ‚úÖ

‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–∫–∞–∫ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å):

"–ú–í–ü-2 (–ß–µ—Ä–Ω–æ–≤)"
  –ï–°–õ–ò –±—ã —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ "–ú–í–ü-2" –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ:
  ‚Üí –û—à–∏–±–∫–∞: author = "–ú–í–ü" ‚Üê –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
  
  –†–µ—à–µ–Ω–∏–µ: –°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ—Ñ–∏—Å (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤) –Ω–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç —Å–ª–æ–≤–æ
  ‚Üí "–ú–í–ü-2" –æ—Å—Ç–∞—ë—Ç—Å—è –≤–º–µ—Å—Ç–µ, —Ç–µ–∫—Å—Ç –î–û —Å–∫–æ–±–∫–∏ = series
  ‚Üí –ü—Ä–∞–≤–∏–ª—å–Ω–æ: author = "–ß–µ—Ä–Ω–æ–≤" –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∫–æ–±–∫–∏
```

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ—Ñ–∏—Å–æ–≤ –≤ PASS1:**

```python
# –ü—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

# 1. –ï—Å—Ç—å –ª–∏ –¥–µ—Ñ–∏—Å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å)?
if ' - ' in name:  # –î–µ—Ñ–∏—Å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏!
    # –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω "Author - Title" –∏–ª–∏ "Author - Series (Title)"
    parts = name.split(' - ')
    author_part = parts[0]  # –¢–µ–∫—Å—Ç –î–û —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
    rest = ' - '.join(parts[1:])  # –¢–µ–∫—Å—Ç –ü–û–°–õ–ï —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
    # –î–∞–ª—å—à–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º author_part –∏ rest –æ—Ç–¥–µ–ª—å–Ω–æ

# 2. –°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ñ–∏—Å—ã (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤) –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
else:
    # –í—Å–µ –¥–µ—Ñ–∏—Å—ã –≤ —ç—Ç–æ–º —Å–ª–æ–≤–µ - —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ, —á–∞—Å—Ç—å —Ç–µ–∫—Å—Ç–∞
    # "–ú–í–ü-2" —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–¥–Ω–æ —Ü–µ–ª–æ–µ
    # "–§–ò-1 –ê—Ä—Ç—ë–º" —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–¥–Ω–æ —Ü–µ–ª–æ–µ
    pass
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ PASS0+PASS1+PASS2:**
1. **–°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ—Ñ–∏—Å (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤) - –ù–ï —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å:** "–ú–í–ü-2" –æ—Å—Ç–∞—ë—Ç—Å—è —á–∞—Å—Ç—å—é –Ω–∞–∑–≤–∞–Ω–∏—è
2. **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ—Ñ–∏—Å (—Å –ø—Ä–æ–±–µ–ª–∞–º–∏) - –≠–¢–û —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å:** "–ê–≤—Ç–æ—Ä - –ù–∞–∑–≤–∞–Ω–∏–µ" —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è
3. **Single-word –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∫–æ–±–∫–µ:** "–ú–í–ü-2 (–ß–µ—Ä–Ω–æ–≤)" ‚Üí –∞–≤—Ç–æ—Ä = "–ß–µ—Ä–Ω–æ–≤"
2. **Multi-author –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:** "–ê–≤—Ç–æ—Ä1, –ê–≤—Ç–æ—Ä2" ‚Üí –æ–±–∞ –ø–∞—Ä—Å—è—Ç—Å—è
3. **Blacklist –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ü–ï–†–í–´–ú —Å–ª–æ–≤–æ–º:** "–°–±–æ—Ä–Ω–∏–∫ –†–∞–∑–Ω—ã—Ö" ‚Üí –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–æ
4. **–ù–µ–ø–æ–ª–Ω—ã–µ –§–ò –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–æ–∑–∂–µ –≤ PASS 1:** "–ë–µ–ª–∞—à –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –õ—é–¥–º–∏–ª–∞" ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ñ–∞–º–∏–ª–∏—è
5. **–°–∫–æ–±–∫–∏ –æ—Ç 1 –¥–æ N:** –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–∫–æ–±–∫–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è (–Ω–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è/–ø–æ—Å–ª–µ–¥–Ω—è—è)

**–§–∞–π–ª:** `folder_author_parser.py` —Ñ—É–Ω–∫—Ü–∏—è `parse_author_from_folder_name()`

---

### 4.1 –û–±—â–∞—è —Å—Ö–µ–º–∞ (6-PASS –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 2.0)

```
PASS 1: –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ (–ø–∞–ø–∫–∞ ‚Üí –ø—É—Å—Ç–æ)
        ‚Üì
        1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–ø–∫–∏ –≤–≤–µ—Ä—Ö –¥–æ folder_parse_limit —É—Ä–æ–≤–Ω–µ–π
        2. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ metadata (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø–∞–ø–∫–µ)
        3. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ metadata ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º
        4. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ë–ï–ó –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Üí –æ—Ç–≤–µ—Ä–≥–∞–µ–º
        5. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–∞–ª–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ü–£–°–¢–û (not fallback!)
        –ü—Ä–∏–º–µ–Ω–∏—Ç—å conversions: "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
        ‚Üí BookRecord(metadata_authors="", proposed_author="", author_source="")

PASS 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (filename –¢–û–õ–¨–ö–û)
        ‚Üì
        1. –î–ª—è —Ñ–∞–π–ª–æ–≤ —Å –ø—É—Å—Ç—ã–º proposed_author –∏–∑ PASS 1
        2. –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
        3. Metadata –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ù–ï –¥–ª—è –æ—Ç–∫–∞–∑–∞
        4. –ï—Å–ª–∏ extraction —É—Å–ø–µ—à–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç metadata)
        5. –ï—Å–ª–∏ extraction –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª ‚Üí –æ—Å—Ç–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ
        ‚Üí BookRecord(proposed_author="–∞–≤—Ç–æ—Ä –∏–∑ filename", author_source="filename")

PASS 2 Fallback: –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∫–∞–∫ –ü–û–°–õ–ï–î–ù–ò–ô –∏—Å—Ç–æ—á–Ω–∏–∫
        ‚Üì
        1. –î–ª—è —Ñ–∞–π–ª–æ–≤ —Å –ø—É—Å—Ç—ã–º proposed_author (–Ω–∏ PASS1, –Ω–∏ PASS2 –Ω–µ –¥–∞–ª–∏)
        2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∏–∑ FB2 –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
        3. Metadata –ø—Ä–æ–π–¥–µ—Ç —á–µ—Ä–µ–∑ PASS 3-6 –≤–º–µ—Å—Ç–µ —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∞–≤—Ç–æ—Ä–∞–º–∏
        ‚Üí BookRecord(proposed_author="metadata_authors", author_source="metadata")

PASS 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤
        ‚Üì
        1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (–ò–º—è –§–∞–º–∏–ª–∏—è ‚Üí –§–∞–º–∏–ª–∏—è –ò–º—è)
        2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ extractor._normalize_author_format()
        3. –†–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ –∞–≤—Ç–æ—Ä–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞

PASS 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
        ‚Üì
        1. –ü–æ–∏—Å–∫ –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ
        2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
        3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ –≤—Å–µ–π –≥—Ä—É–ø–ø–µ (–µ—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω–æ–≥–æ folder_dataset)

PASS 5: –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π —Ñ–∞–º–∏–ª–∏–π
        ‚Üì
        1. –í—Ç–æ—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ surname_conversions (–ø–æ—Å–ª–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞)
        2. –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ PASS 4

PASS 6: –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä
        ‚Üì
        1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ "–ê.–§–∞–º–∏–ª–∏—è" ‚Üí "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –§–∞–º–∏–ª–∏—è"
        2. –¢—Ä–µ–±—É–µ—Ç —Å–ª–æ–≤–∞—Ä—è –ø–æ–ª–Ω—ã—Ö –∏–º—ë–Ω (build_authors_map)
        3. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

        ‚Üì
CSV SAVE: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ regen.csv
```

### ‚ö†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã PASS 1-2-Fallback

**–ñ–ï–õ–ï–ó–ù–û–ï –ü–†–ê–í–ò–õ–û: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º**

1. **PASS 1 —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å –ø–∞–ø–∫–æ–π** (folder_dataset)
   - –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º metadata –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
   - –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –ù–ï –¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ü–£–°–¢–û (–Ω–µ fallback!)
   - Metadata –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–µ–Ω–∏—è, –ù–ò–ö–û–ì–î–ê –¥–ª—è –æ—Ç–∫–∞–∑–∞

2. **PASS 2 —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å filename**
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ = –±–∞–∑–∞ –¥–ª—è filename source
   - –ï—Å–ª–∏ extraction —É—Å–ø–µ—à–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
   - Metadata confirmation –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ù–ï –¥–ª—è –æ—Ç–∫–∞–∑–∞

3. **PASS 2 Fallback –ø—Ä–∏–º–µ–Ω—è–µ—Ç metadata –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å**
   - –¢–û–õ–¨–ö–û –µ—Å–ª–∏ PASS 1 + PASS 2 –æ–±–∞ –¥–∞–ª–∏ –ü–£–°–¢–û
   - Metadata –∑–∞—Ç–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ PASS 3-6

4. **PASS 3-6 —Ä–∞–±–æ—Ç–∞—é—Ç —Å –†–ï–ó–£–õ–¨–¢–ê–¢–û–ú (proposed_author)**
   - –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ filename –∏–ª–∏ –ø–∞–ø–∫–µ
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–µ—á–µ—Ç –¢–û–õ–¨–ö–û –≤–ø–µ—Ä–µ–¥ —á–µ—Ä–µ–∑ PASS'—ã
   - –ò—Å—Ç–æ—á–Ω–∏–∫ (author_source) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä: –§–∞–π–ª "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π - –î–∏—Ç—è –ø—Ä–∏–±–æ—è (–°–µ—Ä–∏—è).fb2"**
```
Metadata: "–≠–ª—å—Ö–∞–Ω –ê—Å–∫–µ—Ä–æ–≤" (–î–†–£–ì–û–ô –∞–≤—Ç–æ—Ä!)

PASS 1 (–ø–∞–ø–∫–∞):
  - –ü–∞–ø–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ –∫–∞–∫ –∞–≤—Ç–æ—Ä—Å–∫–∞—è ‚Üí –ø—É—Å—Ç–æ

PASS 2 (filename):
  - Extraction: "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  - Metadata confirm: "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" ‚â† "–≠–ª—å—Ö–∞–Ω –ê—Å–∫–µ—Ä–æ–≤" ‚Üí FALSE
  - ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–ú anyway (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç confirmation)
  - –†–µ–∑—É–ª—å—Ç–∞—Ç: proposed_author="–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π", author_source="filename"

PASS 2 Fallback:
  - proposed_author —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º

PASS 3-6:
  - –†–∞–±–æ—Ç–∞—é—Ç —Å "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" –∫–∞–∫ —Å –æ–±—ã—á–Ω—ã–º –∞–≤—Ç–æ—Ä–æ–º
  
‚úÖ –ò–¢–û–ì: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–≤—Ç–æ—Ä "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" (–∏–∑ filename)
         Metadata "–≠–ª—å—Ö–∞–Ω –ê—Å–∫–µ—Ä–æ–≤" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
```

### 4.2 –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ PASS

#### PASS 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É

**–ñ–ï–õ–ï–ó–ù–û–ï –ü–†–ê–í–ò–õ–û:** –ø–∞–ø–∫–∞ ‚Üí —Ñ–∞–π–ª ‚Üí –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ò—Å—Ç–æ—á–Ω–∏–∫ FB2 —Ñ–∞–π–ª–æ–≤**
- FB2 —Ñ–∞–π–ª—ã —Å–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è **–≤ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ** (—Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `./`)
- **–ù–ï** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `library_path` –∏–∑ config.json –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è!
- `library_path` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ CSV
- –ê–ª–≥–æ—Ä–∏—Ç–º: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∏—â–µ—Ç –≤—Å–µ `*.fb2` —Ñ–∞–π–ª—ã –≤ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ –∏ –µ—ë –ø–æ–¥–ø–∞–ø–∫–∞—Ö

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –ü—É—Ç—å –∫ FB2 —Ñ–∞–π–ª—É (–Ω–∞–π–¥–µ–Ω–æ –≤ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ)
- folder_parse_limit = 3 (–≥–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ –≤–≤–µ—Ä—Ö –ø–æ –ø–∞–ø–∫–∞–º)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –ü–æ–ø—ã—Ç–∫–∞ 1: –ü–∞—Ä—Å–∏–Ω–≥ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫ (–í–ê–†–ò–ê–ù–¢ B - –ü–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∞ –∫–∞–∫ —Ü–µ–ª–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–ø–∫–∏ –≤–≤–µ—Ä—Ö –Ω–∞ folder_parse_limit —É—Ä–æ–≤–Ω–µ–π
   - ‚ö†Ô∏è –ó–ê–©–ò–¢–ê: –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–∞–ø–∫–∏ –≤ filename_blacklist ("—Å–±–æ—Ä–Ω–∏–∫", "–∫–æ–º–ø–∏–ª—è—Ü–∏—è", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è")
   - –ù–∞–π—Ç–∏ –ø–∞–ø–∫—É —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑—É—è patterns)
   - –ï–°–õ–ò –ù–ê–ô–î–ï–ù–ê ‚Üí author_source = "folder_dataset" (—ç—Ç–æ—Ç –∞–≤—Ç–æ—Ä –¥–ª—è –í–°–ï–ô –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–æ–¥ –Ω–µ–π)
   - –ü–†–ò–ú–ï–†: /Books/–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book.fb2
     ‚Üí –ù–∞–π—Ç–∏ "–ì–æ–±–ª–∏–Ω (MeXXanik)" –Ω–∞ —É—Ä–æ–≤–Ω–µ 2 ‚Üí folder_dataset="–ì–æ–±–ª–∏–Ω (MeXXanik)"
     ‚Üí –í–°–ï —Ñ–∞–π–ª—ã –ø–æ–¥ "–ì–æ–±–ª–∏–Ω (MeXXanik)/" –ø–æ–ª—É—á–∞—Ç —ç—Ç–æ—Ç folder_dataset

2. –ü–æ–ø—ã—Ç–∫–∞ 2: –ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
   - –ï—Å–ª–∏ –ü–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∞–≤—Ç–æ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑—É—è patterns)
   - –ü–†–ò–ú–ï–†: "–ì–æ–±–ª–∏–Ω - –ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤.fb2" ‚Üí "–ì–æ–±–ª–∏–Ω"
   - author_source = "filename"

3. –ü–æ–ø—ã—Ç–∫–∞ 3: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ FB2
   - –ï—Å–ª–∏ –ü–æ–ø—ã—Ç–∫–∞ 1 –∏ 2 –Ω–µ –¥–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   - –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ //fb:author –≤ title-info
   - –ü–†–ò–ú–ï–†: FB2 XML —Å–æ–¥–µ—Ä–∂–∏—Ç <first-name>–ü–µ—Ç—Ä</first-name><last-name>–ì–æ–±–ª–∏–Ω (MeXXanik)</last-name>
     ‚Üí "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)"
   - author_source = "metadata"

4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å conversions –Ω–∞ –ö–ê–ñ–î–û–ú —à–∞–≥–µ:
   - "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"

5. ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û:** –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–æ–≤ –Ω–µ—Ç ‚Üí proposed_author = **–ü–£–°–¢–û** (–Ω–µ "–°–±–æ—Ä–Ω–∏–∫"!)
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Ç–æ–∫—É –¥–∞—Ç—å PASS 2 –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
   - ‚ùå –°–¢–ê–†–û–ï: proposed_author = "–°–±–æ—Ä–Ω–∏–∫" ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª fallback –≤ PASS 2 ‚úó
   - ‚úÖ –ù–û–í–û–ï: proposed_author = "" ‚Üí –ø–æ–∑–≤–æ–ª—è–µ—Ç PASS 2 Fallback —Ä–∞–±–æ—Ç–∞—Ç—å ‚úì
   - "–°–±–æ—Ä–Ω–∏–∫" –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –≤ PASS 2 Fallback –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
   - –ü—Ä–∏–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏–ª–æ:
     * "–ñ–µ—Ä–µ–±—å—ë–≤. –ù–µ–≥–æ—Ü–∏–∞–Ω—Ç.fb2" ‚Üí —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è "–ñ–µ—Ä–µ–±—å—ë–≤"  
     * "–õ–æ–≥–∏–Ω–æ–≤. –°–°–°–† - –æ—Ç–≤–µ—Ç–Ω—ã–π —É–¥–∞—Ä.fb2" ‚Üí —Ç–µ–ø–µ—Ä—å "–õ–æ–≥–∏–Ω–æ–≤" –≤–º–µ—Å—Ç–æ "–°–°–°–†"

6. –°–æ–∑–¥–∞—Ç—å BookRecord:
   - file_path = –ø—É—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ library_path
   - metadata_authors = –∞–≤—Ç–æ—Ä—ã –∏–∑ FB2 XML (—Ö—Ä–∞–Ω—è—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª)
   - proposed_author = –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–≤—Ç–æ—Ä —Å –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–º–∏ conversions (–∏–ª–∏ –ü–£–°–¢–û!)
   - author_source = "folder_dataset" / "filename" / "metadata" / "" (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞)
   - file_title = –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ FB2
```

**–ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ –ø–æ –ø–∞–ø–∫–∞–º (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø–∞–ø–æ–∫ –≤ –æ–¥–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ)**
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
/Books/
  ‚îú‚îÄ –ì–æ–±–ª–∏–Ω (MeXXanik)/
  ‚îÇ   ‚îú‚îÄ –ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2
  ‚îÇ   ‚îú‚îÄ –¢—Ä–æ–µ –≤ –ª–æ–¥–∫–µ/book2.fb2
  ‚îÇ   ‚îî‚îÄ –°–µ—Ä–∏—è/book3.fb2
  ‚îú‚îÄ –î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä/
  ‚îÇ   ‚îú‚îÄ –ï–≥–æ –ü–µ—Ä–≤–∞—è –ö–Ω–∏–≥–∞/book4.fb2
  ‚îÇ   ‚îî‚îÄ –ï–≥–æ –í—Ç–æ—Ä–∞—è –ö–Ω–∏–≥–∞/book5.fb2
  ‚îî‚îÄ –¢—Ä–µ—Ç–∏–π/
      ‚îî‚îÄ book6.fb2

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ PASS 1:

–§–∞–π–ª: book1.fb2 (/Books/–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2)
  parents[0] = "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤"
  parents[1] = "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üê –ù–ê–ô–î–ï–ù–û! (–Ω–µ –≤ blacklist)
  
  author_source = "folder_dataset"
  proposed_author = "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí conversions ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
  ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: folder_dataset="–ì–æ–±–ª–∏–Ω MeXXanik" –¥–ª—è –í–°–ï–• —Ñ–∞–π–ª–æ–≤ –ø–æ–¥ —ç—Ç–æ–π –ø–∞–ø–∫–æ–π

–§–∞–π–ª: book4.fb2 (/Books/–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä/–ï–≥–æ –ü–µ—Ä–≤–∞—è –ö–Ω–∏–≥–∞/book4.fb2)
  parents[0] = "–ï–≥–æ –ü–µ—Ä–≤–∞—è –ö–Ω–∏–≥–∞"
  parents[1] = "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä" ‚Üê –ù–ê–ô–î–ï–ù–û! (–¥—Ä—É–≥–æ–π –∞–≤—Ç–æ—Ä)
  
  author_source = "folder_dataset"
  proposed_author = "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä" ‚Üí conversions ‚Üí "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä"
  ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: folder_dataset="–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä" (–û–¢–î–ï–õ–¨–ù–ê–Ø –≥—Ä—É–ø–ø–∞ –æ—Ç book1)

–§–∞–π–ª: book6.fb2 (/Books/–¢—Ä–µ—Ç–∏–π/book6.fb2)
  parents[0] = "–¢—Ä–µ—Ç–∏–π"
  parents[1] = "Books" ‚Üí –Ω–µ –ø–æ—Ö–æ–∂ –Ω–∞ –∞–≤—Ç–æ—Ä–∞
  
  author_source = "folder_dataset" (–Ω–∞–π–¥–µ–Ω–æ)
  proposed_author = "–¢—Ä–µ—Ç–∏–π"
  ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: folder_dataset="–¢—Ä–µ—Ç–∏–π"

‚≠ê –ö–õ–Æ–ß–ï–í–û–ô –†–ï–ó–£–õ–¨–¢–ê–¢:
  - –í—Å–µ book1, book2, book3 –ø–æ–ª—É—á–∞—Ç folder_dataset="–ì–æ–±–ª–∏–Ω MeXXanik"
  - All book4, book5 –ø–æ–ª—É—á–∞—Ç folder_dataset="–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä"
  - book6 –ø–æ–ª—É—á–∏—Ç folder_dataset="–¢—Ä–µ—Ç–∏–π"
  - –ö–ê–ñ–î–ê–Ø –∞–≤—Ç–æ—Ä—Å–∫–∞—è –ø–∞–ø–∫–∞ = –æ—Ç–¥–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞!
```

**–ü—Ä–∏–º–µ—Ä 2: –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–±–æ—Ä–Ω–∏–∫–æ–≤ –≤ blacklist**
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
/Books/
  ‚îî‚îÄ –°–±–æ—Ä–Ω–∏–∫ –†–∞–∑–Ω—ã—Ö –ê–≤—Ç–æ—Ä–æ–≤/          ‚Üê –í blacklist!
      ‚îú‚îÄ –ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2
      ‚îú‚îÄ –î—Ä—É–≥–æ–π - –í—Ç–æ—Ä–∞—è –∫–Ω–∏–≥–∞.fb2
      ‚îî‚îÄ –¢—Ä–µ—Ç–∏–π - –¢—Ä–µ—Ç—å—è –∫–Ω–∏–≥–∞.fb2

–û–±—Ä–∞–±–æ—Ç–∫–∞: book.fb2 (–ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2)
  parents[0] = "–ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2" (—Å–∞–º —Ñ–∞–π–ª)
  parents[1] = "–°–±–æ—Ä–Ω–∏–∫ –†–∞–∑–Ω—ã—Ö –ê–≤—Ç–æ—Ä–æ–≤" ‚Üê –í blacklist? ("–°–±–æ—Ä–Ω–∏–∫") ‚Üí –ü–†–û–ü–£–°–¢–ò–¢–¨!
  
  ‚ùå –ü–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–∑–∞—â–∏—Ç–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞)
  ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –ü–æ–ø—ã—Ç–∫—É 2: –ø–∞—Ä—Å–∏–Ω–≥ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  
  author = "–ì–æ–±–ª–∏–Ω" (–∏–∑ "–ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2")
  author_source = "filename"
```

#### PASS 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (–ê–ö–¢–ò–í–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–ª—è —Ñ–∞–π–ª–æ–≤ –ë–ï–ó folder_dataset –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∏–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º.

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ü–∞—Ä—Å–∏—Ç –¢–û–õ–¨–ö–û –∏–º—è —Ñ–∞–π–ª–∞, –Ω–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å!**
- –ù–∞ Windows –ø—É—Ç–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç `\` (backslash), –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ basename: `record.file_path.replace('\\', '/').split('/')[-1]`
- –£–¥–∞–ª—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ: `filename.rsplit('.', 1)[0]`

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –¢–æ–ª—å–∫–æ –∏–º—è —Ñ–∞–π–ª–∞ (–±–µ–∑ –ø—É—Ç–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- –ü—Ä–∏–º–µ—Ä—ã –∏–∑ Test1:
  - `Achtung! Manager in der Luft! (–ö–æ–º–±–∞—Ç –ù–∞–π—Ç–æ–≤)`
  - `–ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞ (–°–µ–∑–∏–Ω –°–µ—Ä–≥–µ–π, –ß–µ—Ä–∫—É–Ω–æ–≤–∞ –û–ª—å–≥–∞)`
  - `–ê–ª–µ–∫—Å–∞–Ω–¥—Ä II –í–µ–ª–∏–∫–∏–π (–°—Ç–∞—Ä–µ—Ü –í–∏–∫—Ç–æ—Ä)`

**–ü–∞—Ç—Ç–µ—Ä–Ω—ã (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ - –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–Ω–æ):**

```
1. "Title (Author)" ‚Üê –ù–ê–ò–í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–µ—Å—Ç—å –≤ Test1!)
   Example: "Achtung! Manager in der Luft! (–ö–æ–º–±–∞—Ç –ù–∞–π—Ç–æ–≤)"
   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: rfind('(') –∏ rfind(')'), –±–µ—Ä—ë—Ç –ü–û–°–õ–ï–î–ù–Æ–Æ –ø–∞—Ä—É —Å–∫–æ–±–æ–∫
   –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ö–æ–º–±–∞—Ç –ù–∞–π—Ç–æ–≤" ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ "–ù–∞–π—Ç–æ–≤ –ö–æ–º–±–∞—Ç"

2. "Author - Title"
   Example: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ 1"
   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: split(' - ', 1), –±–µ—Ä—ë—Ç –ø–µ—Ä–≤—É—é —á–∞—Å—Ç—å
   –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"

3. "Author. Title"
   Example: "–ë–µ–ª–æ—É—Å. –ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞"
   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: split('. ', 1), –±–µ—Ä—ë—Ç –ø–µ—Ä–≤—É—é —á–∞—Å—Ç—å
   –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ë–µ–ª–æ—É—Å"

4. "Author, Author"
   Example: "–°–µ—Ä–≥–µ–π –ò–≤–∞–Ω–æ–≤, –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: split(',', 1), –±–µ—Ä—ë—Ç –ø–µ—Ä–≤—É—é —á–∞—Å—Ç—å
   –†–µ–∑—É–ª—å—Ç–∞—Ç: "–°–µ—Ä–≥–µ–π –ò–≤–∞–Ω–æ–≤"
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞:**

–ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è:
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: `len(author) > 2` (–∏—Å–∫–ª—é—á–∏—Ç—å –æ–¥–Ω–æ–±—É–∫–≤–µ–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏)
- ‚úÖ –ù–µ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
- ‚úÖ –ù–µ—Ç —Ç—Ä–µ–±—É–µ–º–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å –∑–∞–ø—è—Ç—ã–º–∏, –∏–Ω–∏—Ü–∏–∞–ª–∞–º–∏ –∏ —Ç.–¥.)

**–ü—Ä–∏–º–µ—Ä—ã –∏–∑ Test1:**

```
regen.csv source=filename:  45 –∑–∞–ø–∏—Å–µ–π

–ü—Ä–∏–º–µ—Ä—ã —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞:
  'Achtung! Manager in der Luft! (–ö–æ–º–±–∞—Ç –ù–∞–π—Ç–æ–≤).fb2'
    ‚Üí –ò–∑–≤–ª–µ—á–µ–Ω–æ: "–ö–æ–º–±–∞—Ç –ù–∞–π—Ç–æ–≤"
    ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: "–ù–∞–π—Ç–æ–≤ –ö–æ–º–±–∞—Ç"
    
  '–ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞ (–°–µ–∑–∏–Ω –°–µ—Ä–≥–µ–π, –ß–µ—Ä–∫—É–Ω–æ–≤–∞ –û–ª—å–≥–∞).fb2'
    ‚Üí –ò–∑–≤–ª–µ—á–µ–Ω–æ: "–°–µ–∑–∏–Ω –°–µ—Ä–≥–µ–π, –ß–µ—Ä–∫—É–Ω–æ–≤–∞ –û–ª—å–≥–∞"
    ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: "–°–µ–∑–∏–Ω –°–µ—Ä–≥–µ–π, –ß–µ—Ä–∫—É–Ω–æ–≤–∞ –û–ª—å–≥–∞"
    
  '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä II –í–µ–ª–∏–∫–∏–π (–°—Ç–∞—Ä–µ—Ü –í–∏–∫—Ç–æ—Ä).fb2'
    ‚Üí –ò–∑–≤–ª–µ—á–µ–Ω–æ: "–°—Ç–∞—Ä–µ—Ü –í–∏–∫—Ç–æ—Ä"
    ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: "–°—Ç–∞—Ä–∏—Ü—ã–Ω –í–∏–∫—Ç–æ—Ä" (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ)
```

**–ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

Bug #1 (–§–µ–≤—Ä–∞–ª—å 2026):
- ‚ùå –ë–´–õ–û: `.split('/')[-1]` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows (–ø—É—Ç–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç `\`)
- ‚ùå –†–ï–ó–£–õ–¨–¢–ê–¢: –ø–∞—Ä—Å–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- ‚ùå –ü–†–ò–ú–ï–†: `"–°–µ—Ä–∏—è - ¬´–í–æ–µ–Ω–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞¬ª\Achtung!(...).fb2".split('/')` –≤–µ—Ä–Ω—É–ª –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
  ‚Üí –ü–∞—Ç—Ç–µ—Ä–Ω ` - ` —Å–æ–≤–ø–∞–ª —Å "–°–µ—Ä–∏—è"
- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: `replace('\\', '/').split('/')[-1]` + –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–µ–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

Bug #2 (–§–µ–≤—Ä–∞–ª—å 2026):
- ‚ùå –ë–´–õ–û: –ù–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –¥–ª—è `(Author)` –≤ —Å–∫–æ–±–∫–∞—Ö
- ‚ùå –†–ï–ó–£–õ–¨–¢–ê–¢: 46 —Ñ–∞–π–ª–æ–≤ –∏–∑ "–°–µ—Ä–∏—è - –í–æ–µ–Ω–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞" –ø–æ–ª—É—á–∞–ª–∏ `author="–°–µ—Ä–∏—è"`
- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ç—Ç–µ—Ä–Ω "Title (Author)" —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
  ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç rfind() –¥–ª—è –ü–û–°–õ–ï–î–ù–ï–ô –ø–∞—Ä—ã —Å–∫–æ–±–æ–∫ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —Å —Å–∫–æ–±–∫–∞–º–∏)
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ 46 —Ñ–∞–π–ª–æ–≤ —Ç–µ–ø–µ—Ä—å –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤

**–õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (pass2_filename.py):**

```python
class Pass2Filename:
    def execute(self, records):
        for record in records:
            # Skip –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å folder_dataset
            if record.author_source == "folder_dataset":
                continue
            
            # Skip –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –∞–≤—Ç–æ—Ä
            if record.proposed_author:
                continue
            
            # –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–º—è —Ñ–∞–π–ª–∞ (–Ω–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å!)
            filename = record.file_path.replace('\\', '/').split('/')[-1]
            filename_without_ext = filename.rsplit('.', 1)[0]
            
            # –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)
            author = self._extract_author_from_filename(filename_without_ext)
            
            if author:
                record.proposed_author = author
                record.author_source = "filename"
    
    def _extract_author_from_filename(self, filename):
        # 1. –ü–ï–†–í–´–ô –ü–†–ò–û–†–ò–¢–ï–¢: "Title (Author)"
        if '(' in filename and ')' in filename:
            start = filename.rfind('(')  # –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
            end = filename.rfind(')')    # –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
            if start < end:
                author = filename[start+1:end].strip()
                if author and len(author) > 2:
                    return author
        
        # 2. "Author - Title"
        if ' - ' in filename:
            author = filename.split(' - ', 1)[0].strip()
            if author and len(author) > 2:
                return author
        
        # 3. "Author. Title"
        if '. ' in filename:
            author = filename.split('. ', 1)[0].strip()
            if author and len(author) > 2:
                return author
        
        # 4. "Author, Author"
        if ',' in filename:
            author = filename.split(',', 1)[0].strip()
            if author and len(author) > 2:
                return author
        
        return ""
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ 45 –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤
- ‚úÖ 0 –æ—à–∏–±–æ—á–Ω—ã—Ö "–°–µ—Ä–∏—è" (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Feb 2026)
- ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω `(Author)` —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - ‚úÖ –ï–°–õ–ò –Ω–∞–π–¥–µ–Ω–æ —Å–ª–æ–≤–æ –≤ author_names (–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω–∞—Ö/—Ñ–∞–º–∏–ª–∏—è—Ö) ‚Üí –ø—Ä–∏–Ω—è—Ç—å –∞–≤—Ç–æ—Ä–∞

2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–º–µ–Ω–∏:
   - –ï–°–õ–ò –Ω–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –ø–æ—Ö–æ–∂–µ –ª–∏ –Ω–∞ –∏–º—è
   - –¢—Ä–µ–±—É–µ—Ç: —Å–æ–¥–µ—Ä–∂–∏—Ç –±—É–∫–≤—ã, 2-100 —Å–∏–º–≤–æ–ª–æ–≤, –±–µ–∑ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - ‚úÖ –ï–°–õ–ò –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∏–º—è –ò–ñ –ù–ï –ø–æ—Ö–æ–∂–µ –Ω–∞ —Å–µ—Ä–∏—é ‚Üí –ø—Ä–∏–Ω—è—Ç—å –∞–≤—Ç–æ—Ä–∞

3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —ç—Ç–æ –ù–ï —Å–µ—Ä–∏—è:
   - ‚ùå –ï—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–∞ –∏–∑ blacklist (—Å–±–æ—Ä–Ω–∏–∫, –∫–æ–º–ø–∏–ª—è—Ü–∏—è, etc) ‚Üí –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å
   - ‚ùå –ï—Å–ª–∏ —ç—Ç–æ 2-3 —Å–ª–æ–≤–∞ –ë–ï–ó –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω –∏ –ø–æ—Ö–æ–∂–µ –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–µ ‚Üí –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å
   - ‚úÖ –í–ê–ñ–ù–û: Single-word surnames (—Ñ–∞–º–∏–ª–∏–∏ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞) –ü–†–ò–ù–ò–ú–ê–Æ–¢–°–Ø!
     ¬∑ –ü—Ä–∏–º–µ—Ä: "–ñ–µ—Ä–µ–±—å—ë–≤" (–æ–¥–Ω–æ —Å–ª–æ–≤–æ) ‚Üí ‚úÖ –ø—Ä–∏–Ω—è–ª  
     ¬∑ –ü—Ä–∏–º–µ—Ä: "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞" (–¥–≤–∞ —Å–ª–æ–≤–∞, –Ω–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω) ‚Üí ‚ùå –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç –∫–∞–∫ —Å–µ—Ä–∏—è
```

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –æ–ø–∏—Å–∞–Ω–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**–ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ `config.json` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Å–∏—Å—Ç–µ–º—ã. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–ª—è –Ω–∏—Ö —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è.

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```python
def _generate_regex_from_pattern_desc(self, pattern_desc: str) -> Tuple[str, List[str]]:
    """
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç regex –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞.
    
    –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π:
    - "Author, Author" ‚Üí ^(?P<author>[^,]+?)\s*,\s*(?P<author2>.+)$
    - "Series (Author)" ‚Üí ^(?P<series>[^(]+?)\s*\((?P<author>[^)]+)\)$
    - "Title - Author" ‚Üí ^(?P<title>[^()]+?)\s*\-\s*(?P<author>[^,\-()]+?)$
    
    Placeholders, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è:
    - Author, Author2 ‚Üí –ì—Ä—É–ø–ø–∞ –∞–≤—Ç–æ—Ä–∞ (–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–ø—è—Ç—ã–µ, –¥–µ—Ñ–∏—Å—ã, —Å–∫–æ–±–∫–∏)
    - Series ‚Üí –ì—Ä—É–ø–ø–∞ —Å–µ—Ä–∏–∏ (–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫–æ–±–∫–∏)
    - Title ‚Üí –ì—Ä—É–ø–ø–∞ –Ω–∞–∑–≤–∞–Ω–∏—è (–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫–æ–±–∫–∏)
    - Name, Surname ‚Üí –û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
    - Folder Name ‚Üí –õ—é–±–æ–π —Ç–µ–∫—Å—Ç (–∂–∞–¥–Ω—ã–π –ø–æ–∏—Å–∫)
    
    –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
    - –ó–∞–ø—è—Ç–∞—è: , ‚Üí \s*,\s* (–ø—Ä–æ–±–µ–ª—ã = –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã)
    - –î–µ—Ñ–∏—Å: - ‚Üí \s*-\s*
    - –¢–æ—á–∫–∞: . ‚Üí \.
    - –°–∫–æ–±–∫–∏: () ‚Üí —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å regex
    """
```

**–ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –≤ config.json:**

```json
{
  "author_series_patterns_in_folders": [
    {"pattern": "Series (Author)"},
    {"pattern": "Series (Author, Author)"},
    {"pattern": "(Surname) (Name)"},
    {"pattern": "Author - Folder Name"},
    {"pattern": "MyCustom Pattern (Author) - Title"}  ‚Üê –ù–û–í–´–ô –ü–ê–¢–¢–ï–†–ù!
  ]
}
```

**–ú–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (Priority-based selection):**

‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –í—ã–±–æ—Ä –ù–ï –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ—Ä—è–¥–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ —Å–ø–∏—Å–∫–µ!

–°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç **–∫–∞—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è** –ø–æ 3 –∫—Ä–∏—Ç–µ—Ä–∏—è–º:

1. **–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (Priority):** 
   - 100 points: –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å –≥—Ä—É–ø–ø–æ–π `series` (–≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ "Series (Author)")
   - 50 points: –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å –≥—Ä—É–ø–ø–æ–π `folder_name` (–≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ "Author - Folder Name")  
   - 10 points: –ü—Ä–æ—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ "Author, Author")

2. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø:** 
   - –ë–µ—Ä—ë—Ç—Å—è –∫–∞–∫ –≤—Ç–æ—Ä–æ–π –∫—Ä–∏—Ç–µ—Ä–∏–π (—Ç–∞–π-–±—Ä–µ–π–∫–µ—Ä)
   - –ü–∞—Ç—Ç–µ—Ä–Ω —Å 3 —Å–æ–≤–ø–∞–¥—ë–Ω–Ω—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏ > –ø–∞—Ç—Ç–µ—Ä–Ω —Å 2 –≥—Ä—É–ø–ø–∞–º–∏

3. **–ü–æ—Ä—è–¥–æ–∫ –≤ —Å–ø–∏—Å–∫–µ:**
   - –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è! (–ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –í–°–ï –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ)

**–ü—Ä–∏–º–µ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏:**

```
–ü–∞–ø–∫–∞: "–í—Ç–æ—Ä–æ–π —Å–∏–±–∏—Ä—Å–∫–∏–π (–ï–º–µ–ª—å—è–Ω–æ–≤ –ê–Ω—Ç–æ–Ω, –°–∞–≤–∏–Ω–æ–≤ –°–µ—Ä–≥–µ–π)"

–ü–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç:
- "Author, Author"         ‚Üí quality_score = (10, 2)
- "Series (Author, Author)" ‚Üí quality_score = (100, 3)  ‚Üê –í–´–ë–†–ê–ù! (100 > 10)

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- series: "–í—Ç–æ—Ä–æ–π —Å–∏–±–∏—Ä—Å–∫–∏–π"
- author: "–ï–º–µ–ª—å—è–Ω–æ–≤ –ê–Ω—Ç–æ–Ω"
- author2: "–°–∞–≤–∏–Ω–æ–≤ –°–µ—Ä–≥–µ–π"
```

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (hardcoded, –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):**

–°–∏—Å—Ç–µ–º–∞ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –≤ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ (—ç—Ç–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã):

```python
patterns_map = {
    # –ü–∞–ø–∫–∏ (folder patterns)
    "Author, Author": r'^(?P<author>[^,]+?)\s*,\s*(?P<author2>.+)$',
    "(Surname) (Name)": r'^(?P<author>\S+)\s+(?P<author2>\S+)$',
    "Author - Folder Name": r'^(?P<author>[^-]+?)\s*-\s*(?P<folder_name>.+)$',
    "Series (Author)": r'^(?P<series>[^(]+?)\s*\((?P<author>[^)]+)\)$',
    "Series (Author, Author)": r'^(?P<series>[^(]+?)\s*\((?P<author>[^,]+?)\s*,\s*(?P<author2>[^)]+)\)$',
    "(Series) Author": r'^\((?P<series>[^)]+)\)\s*(?P<author>.+)$',
    "Series": r'^(?P<series>.+)$',
    
    # –§–∞–π–ª—ã (file patterns)
    "(Author) - Title": r'^\((?P<author>[^)]+)\)\s*-\s*(?P<title>.+)$',
    "Author - Title": r'^(?P<author>.*?)\s*-\s*(?P<title>[^(]+)(?:\(.*\))?$',
    # ... –¥—Ä—É–≥–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã ...
}
```

**–ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ hardcoded liste ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è:**

```python
# –î–ª—è –Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–∑ config.json
regex, groups = self._generate_regex_from_pattern_desc(pattern_desc)
# –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–∏–º–∏ —Ç–∞–∫ –∂–µ, –∫–∞–∫ —Å predefined –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–æ–≤–µ—Ç—ã:**

‚ö†Ô∏è **–≠—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:**
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ regex —Å–∏–º–≤–æ–ª—ã –≤ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è—Ö (–∫—Ä–æ–º–µ `. - ,`)
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–∫–æ–±–∫–∏ (—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –ø–∞—Ä–∞ –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω)
- –°–∏–º–≤–æ–ª—ã –∫—Ä–æ–º–µ –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö –±—É–∫–≤, —Ü–∏—Ñ—Ä, –ø—Ä–æ–±–µ–ª–æ–≤, —Ç–æ—á–µ–∫, –¥–µ—Ñ–∏—Å–æ–≤, –∑–∞–ø—è—Ç—ã—Ö

‚úÖ **–°–æ–≤–µ—Ç—ã –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è placeholders: Author, Series, Title, Name, Surname, Folder Name
- –ü–æ–º–µ—â–∞–π—Ç–µ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–∫–æ–±–∫–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —á—ë—Ç–∫–∞—è –≥—Ä–∞–Ω–∏—Ü–∞: "Series (Author)"
- –†–∞–∑–¥–µ–ª—è–π—Ç–µ –≥—Ä—É–ø–ø—ã —Ç–æ—á–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏: `-`, `,`, `.` (–Ω–µ –¥—Ä—É–≥–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏)
- –°—Ç–∞–≤—å—Ç–µ –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (—Å "Series") –í–´ÃÅ–®–ï –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏ (—Å–∏—Å—Ç–µ–º–∞ –≤—ã–±–µ—Ä–µ—Ç –∏—Ö)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
python test_auto_pattern_generation.py

# –ò–ª–∏ –ø—Ä—è–º–æ –≤ –∫–æ–¥–µ:
service = RegenCSVService()
pattern_desc = "My Custom (Author) - Title"
regex, groups = service._file_pattern_to_regex(pattern_desc)
print(f"Regex: {regex}")
print(f"Groups: {groups}")
```

---

**Critical moment: Single-word surnames vs. Series names**

–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–∑–ª–∏—á–∞—Ç—å:
- **Single-word surname:** "–ñ–µ—Ä–µ–±—å—ë–≤", "–ò–≤–∞–Ω–æ–≤", "–°–º–∏—Ä–Ω–æ–≤" (–∏–º–µ–Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤)
- **Multi-word phrase:** "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", "–î—Ä—É–≥–æ–π –º–∏—Ä" (–Ω–∞–∑–≤–∞–Ω–∏—è —Å–µ—Ä–∏–π)

–≠–≤—Ä–∏—Å—Ç–∏–∫–∞ `_looks_like_series_name()`:
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º: –µ—Å—Ç—å –ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–µ?
words_in_author_names = count(known_first_names_found)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
- –ï—Å–ª–∏ words > 0 ‚Üí —ç—Ç–æ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" —Å–æ–¥–µ—Ä–∂–∏—Ç "–∏–≤–∞–Ω")
- –ï—Å–ª–∏ words == 0 –ò 2-3 —Å–ª–æ–≤–∞ ‚Üí –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–µ—Ä–∏–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞")
- –ï—Å–ª–∏ words == 0 –ò 1 —Å–ª–æ–≤–æ ‚Üí —ç—Ç–æ —Ñ–∞–º–∏–ª–∏—è, –ù–ï —Å–µ—Ä–∏—è! (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ñ–µ—Ä–µ–±—å—ë–≤")
  
‚ö†Ô∏è –ü–û–ß–ï–ú–£ –æ–¥–Ω–æ —Å–ª–æ–≤–æ = —Ñ–∞–º–∏–ª–∏—è?
- author_names —Å–æ–¥–µ—Ä–∂–∏—Ç –¢–û–õ–¨–ö–û –ò–ú–ïÃÅ–ù–ê (first names) ‚Äî –ò–≤–∞–Ω, –ü–µ—Ç—Ä, –°–µ—Ä–≥–µ–π, etc.
- –§–∞–º–∏–ª–∏–∏ —Ä–µ–¥–∫–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∏–º–µ–Ω–Ω–æ first names)
- –ü–æ—ç—Ç–æ–º—É check "words_in_author_names == 0" –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ = —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ñ–∞–º–∏–ª–∏—è
- –°–µ—Ä–∏–∏ –æ–±—ã—á–Ω–æ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è, —Ä–µ–¥–∫–æ –æ–¥–Ω–æ —Å–ª–æ–≤–æ
```

**–ü—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

```
–°–ª—É—á–∞–π 1: Single-word surname
Text: "–ñ–µ—Ä–µ–±—å—ë–≤"
- Contains known first name? NO
- Structurally looks like name? YES (–±—É–∫–≤—ã, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞)
- Looks like series name? NO (1 —Å–ª–æ–≤–æ –æ–¥–Ω–æ)
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚úÖ –ü–†–ò–ù–Ø–õ –∫–∞–∫ –∞–≤—Ç–æ—Ä–∞

–°–ª—É—á–∞–π 2: Multi-word description
Text: "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"
- Contains known first name? NO
- Structurally looks like name? YES (–±—É–∫–≤—ã)
- Looks like series name? YES (2 —Å–ª–æ–≤–∞, no known names) 
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚ùå –û–¢–í–ï–†–ì–ù–£–õ –∫–∞–∫ —Å–µ—Ä–∏—é

–°–ª—É—á–∞–π 3: First name present
Text: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
- Contains known first name? YES ("–∏–≤–∞–Ω")
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚úÖ –ü–†–ò–ù–Ø–õ (–Ω–µ –Ω—É–∂–Ω–∞ –¥–∞–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

–°–ª—É—á–∞–π 4: Part of known name
Text: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
- Contains "–∞–Ω–¥—Ä–µ–π"? YES (–≤ author_names)
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚úÖ –ü–†–ò–ù–Ø–õ (—Å–æ–¥–µ—Ä–∂–∏—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è)
```

**–ê–ª–≥–æ—Ä–∏—Ç–º PASS 2:**

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord —Å author_source != "folder_dataset":
  1. –ü–æ–ª—É—á–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
  2. –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –ø–æ –ª—É—á—à–µ–º—É —Å–æ–≤–ø–∞–¥–∞—é—â–µ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É:
     _extract_author_from_filename_by_patterns(filename)
     
  3. –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä –Ω–∞–π–¥–µ–Ω:
     a) –û—á–∏—Å—Ç–∏—Ç—å –æ—Ç –ø–∞—Ä–∞–∑–∏—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤: _clean_author_name()
        - –£–±—Ä–∞—Ç—å —Ü–∏—Ç–∞—Ç—ã: ¬´¬ª " '
        - –£–±—Ä–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫–æ–±–æ–∫: (xxx) ‚Üí –ø—É—Å—Ç–æ
        - –£–±—Ä–∞—Ç—å trailing dots: "–î–µ–º—á–µ–Ω–∫–æ." ‚Üí "–î–µ–º—á–µ–Ω–∫–æ"
        - –£–±—Ä–∞—Ç—å unneeded commas: "–î–µ–º—á–µ–Ω–∫–æ," ‚Üí "–î–µ–º—á–µ–Ω–∫–æ"
        - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å whitespace: multiple spaces ‚Üí single space
        
     b) –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–æ–≤: _process_and_expand_authors()
        - –®–∞–≥ 0: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ ("–ê–≤—Ç–æ—Ä, –ê–≤—Ç–æ—Ä" ‚Üí "–ê–≤—Ç–æ—Ä")
        - –®–∞–≥ 1: –†–∞–∑–±–∏—Ç—å –ø–æ –∑–∞–ø—è—Ç—ã–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä–æ–≤
        - –®–∞–≥ 2: –†–∞—Å—à–∏—Ä–∏—Ç—å –∫–∞–∂–¥–æ–≥–æ (–ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –Ω–∞–π—Ç–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è –≤ metadata):
          ¬∑ –î–ª—è 1-—Å–ª–æ–≤–∞ (—Ñ–∞–º–∏–ª–∏—è): –∏—Å–∫–∞—Ç—å –≤ metadata –∏ —Å–æ—Å–µ–¥–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö
          ¬∑ –î–ª—è 2-—Å–ª–æ–≤: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–Ω–æ–µ –∏–º—è –∏–ª–∏ 2 —Ä–∞–∑–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∞
        - –®–∞–≥ 3: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã post-expansion (—Å–æ—Ö—Ä–∞–Ω—è—è –ø–æ—Ä—è–¥–æ–∫)
        - –®–∞–≥ 3.5: ‚≠ê –û–¢–°–û–†–¢–ò–†–û–í–ê–¢–¨ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (A-Z, –ê-–Ø)
        - –®–∞–≥ 4: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º "; " (—Ç–æ—á–∫–∞-–∑–∞–ø—è—Ç–∞—è-–ø—Ä–æ–±–µ–ª)
        
  4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: record.proposed_author = final_author
     record.author_source = "filename"
```

**–ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ PASS 2:**

```
–°–ª—É—á–∞–π 1: –ü—Ä–æ—Å—Ç–æ–π multi-author —Ñ–∞–π–ª
Filename: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å - –ê–∫–∞–¥–µ–º–∏–∫ (–°—Ç—Ä–∞–Ω–Ω–∏–∫ 4-5) - 2022.fb2"
  Extracted: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
  Cleaned: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
  Expanded: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å" (–Ω–∞—à–ª–∏ –≤ metadata)
  Sorted: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
  ‚úÖ Final: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"

–°–ª—É—á–∞–π 2: 2-word name - –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–∏–º –∞–≤—Ç–æ—Ä–æ–º
Filename: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ (–°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏. –¢–µ—Ç—Ä–∞–ª–æ–≥–∏—è).fb2"
Metadata: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–≤—Ä–∞–º–µ–Ω–∫–æ"
  Extracted: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"
  Cleaned: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"
  Expansion check: 2 —Å–ª–æ–≤–∞ –Ω–∞–π–¥–µ–Ω—ã –≤ metadata –∫–∞–∫ –æ–¥–∏–Ω –∞–≤—Ç–æ—Ä ("–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–≤—Ä–∞–º–µ–Ω–∫–æ")
  ‚úÖ Final: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä" (–≤ format of metadata –∏–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

–°–ª—É—á–∞–π 3: Single surname - —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–ª–Ω—ã–º –∏–º–µ–Ω–µ–º
Filename: "–î–µ–º—á–µ–Ω–∫–æ - –ë–æ—è—Ä–∏—á (–í–æ–∑–¥—É—à–Ω—ã–π —Å—Ç—Ä–µ–ª–æ–∫ 1-3).fb2"
Metadata: "–ê–Ω—Ç–æ–Ω –î–µ–º—á–µ–Ω–∫–æ"
  Extracted: "–î–µ–º—á–µ–Ω–∫–æ"
  Cleaned: "–î–µ–º—á–µ–Ω–∫–æ"
  Expanded: –ò—â–µ–º "–î–µ–º—á–µ–Ω–∫–æ" –≤ metadata ‚Üí "–ê–Ω—Ç–æ–Ω –î–µ–º—á–µ–Ω–∫–æ"
  ‚úÖ Final: "–î–µ–º—á–µ–Ω–∫–æ –ê–Ω—Ç–æ–Ω" (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

–°–ª—É—á–∞–π 4: Parasitic symbols
Filename: "–î–µ–º—á–µ–Ω–∫–æ. –ë–æ—è—Ä–∏—á (–í–æ–∑–¥—É—à–Ω—ã–π —Å—Ç—Ä–µ–ª–æ–∫ 1-3).fb2"
Metadata: "–ê–Ω—Ç–æ–Ω –î–µ–º—á–µ–Ω–∫–æ"
  Extracted: "–î–µ–º—á–µ–Ω–∫–æ"
  Cleaned: "–î–µ–º—á–µ–Ω–∫–æ" (trailing dot removed)
  Expanded: "–î–µ–º—á–µ–Ω–∫–æ –ê–Ω—Ç–æ–Ω"
  ‚úÖ Final: "–î–µ–º—á–µ–Ω–∫–æ –ê–Ω—Ç–æ–Ω"
```

**–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (–®–∞–≥ 3.5):**

–ö–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–æ–≤ –Ω–∞–π–¥–µ–Ω—ã, –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

```
Unsorted:  "–ü—Ä–æ–∑–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π"
Sorted:    "–ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π; –ü—Ä–æ–∑–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"  ‚Üê –ê < –ü

Unsorted:  "–û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å; –ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π"  
Sorted:    "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"   ‚Üê –ó < –û
```

**–§—É–Ω–∫—Ü–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:**
```python
# –ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 3 (—É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤):
unique_authors.sort()  # ‚Üê –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è Python —Ñ—É–Ω–∫—Ü–∏—è, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ Unicode

# –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º "; "
return "; ".join(unique_authors)
```

#### PASS 2 Fallback: –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∏–∑ FB2 —Ñ–∞–π–ª–∞ –∫–∞–∫ –∫—Ä–∞–π–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –Ω–∏ –≤ PASS 1, –Ω–∏ –≤ PASS 2.

**–£—Å–ª–æ–≤–∏–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:**
```
IF proposed_author == ""  (–ø—É—Å—Ç–æ –ø–æ—Å–ª–µ PASS 1 –ò PASS 2)
   ‚îú‚îÄ PASS 1 (folder_author_parser): –Ω–∏—á–µ–≥–æ –Ω–µ –≤–µ—Ä–Ω—É–ª
   ‚îî‚îÄ PASS 2 (filename parsing): –Ω–∏—á–µ–≥–æ –Ω–µ –≤–µ—Ä–Ω—É–ª
   THEN ‚Üí PASS 2 Fallback –ø—Ä–∏–º–µ–Ω—è–µ—Ç metadata
```

**–ê–ª–≥–æ—Ä–∏—Ç–º (pass2_fallback.py):**
```python
class Pass2Fallback:
    def execute(self, records):
        for record in records:
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –∞–≤—Ç–æ—Ä –∏–∑ PASS 1 –∏–ª–∏ PASS 2
            if record.proposed_author:
                continue
            
            # –£ –Ω–∞—Å –µ—Å—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑ FB2?
            if record.metadata_authors:
                # –û—á–∏—Å—Ç–∏—Ç—å –æ—Ç –ø–∞—Ä–∞–∑–∏—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å
                author = self._clean_and_normalize(record.metadata_authors)
                if author:
                    record.proposed_author = author
                    record.author_source = "metadata"
            else:
                # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç - —Ñ–∞–π–ª —ç—Ç–æ —Å–±–æ—Ä–Ω–∏–∫ –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ
                record.proposed_author = "–°–±–æ—Ä–Ω–∏–∫"
                record.author_source = ""
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**

1. **Metadata –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –æ–±–∞ PASS 1 –∏ PASS 2 –¥–∞–ª–∏ –ü–£–°–¢–û**
   - ‚ùå –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ PASS 1 –∏–ª–∏ PASS 2
   - ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–ú metadata –¢–û–õ–¨–ö–û –∫–∞–∫ –∫—Ä–∞–π–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
   - ‚úÖ author_source –æ—Å—Ç–∞—ë—Ç—Å—è "folder_dataset" –∏–ª–∏ "filename" –µ—Å–ª–∏ —Ç–∞–º –±—ã–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç

2. **Metadata –ø–æ–∑–∂–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ PASS 3-6**
   - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤ Fallback –∞–≤—Ç–æ—Ä—ã –∏–¥—É—Ç –≤ PASS 3 –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞
   - –ó–∞—Ç–µ–º PASS 4 –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Å–µ–Ω—Å—É—Å
   - PASS 5-6 —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
     - "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" (metadata) ‚Üí PASS 3 ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω" (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ Test1):**

- ‚úÖ 45 –∑–∞–ø–∏—Å–µ–π –ø—Ä–∏–º–µ–Ω–∏–ª–∏ metadata –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑ 45 —Ñ–∞–π–ª–æ–≤ —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–∏–ª–∏—Å—å –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–ª–∏—Å—å
- ‚úÖ –ö–æ–Ω—Å–µ–Ω—Å—É—Å (PASS 4) –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤ —Å metadata
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –í –∏—Ç–æ–≥–æ–≤–æ–º CSV 337 –∑–∞–ø–∏—Å–µ–π, –≥–¥–µ 291 (86.4%) –∏–∑ –ø–∞–ø–æ–∫, 46 (13.6%) –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤

---

#### PASS 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –∏–º—ë–Ω –∞–≤—Ç–æ—Ä–æ–≤ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥: "–§–∞–º–∏–ª–∏—è –ò–º—è".

**–£—Å–ª–æ–≤–∏–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:**
```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord:
  1. –ï—Å–ª–∏ proposed_author == "–°–±–æ—Ä–Ω–∏–∫" ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å (–º–µ—Ç–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∞)
  2. –ï—Å–ª–∏ proposed_author != "" ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å
```

**–ê–ª–≥–æ—Ä–∏—Ç–º (pass3_normalize.py):**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Å `author_normalizer_extended.AuthorNormalizer` –¥–ª—è —Ä–∞–±–æ—Ç—ã:

```python
class Pass3Normalize:
    def execute(self, records):
        normalizer = author_normalizer_extended.AuthorNormalizer()
        for record in records:
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º "–°–±–æ—Ä–Ω–∏–∫" –∏ –ø—É—Å—Ç—ã–µ
            if record.proposed_author in ["–°–±–æ—Ä–Ω–∏–∫", ""]:
                continue
            
            # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç "–§–∞–º–∏–ª–∏—è –ò–º—è"
            normalized = normalizer.normalize(record.proposed_author)
            
            if normalized != record.proposed_author:
                # –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
                record.proposed_author = normalized
```

**–ü—Ä–∏–º–µ—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**

```
"–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"       ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"
"–ü–µ—Ç—Ä–æ–≤ –ò."         ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò."              (–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã –Ω–µ –º–µ–Ω—è—é—Ç—Å—è)
"–ì–æ–±–ª–∏–Ω"            ‚Üí "–ì–æ–±–ª–∏–Ω"                 (–æ–¥–Ω–æ —Å–ª–æ–≤–æ - –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)
"–ú–æ–ª—á–∞–Ω–æ–≤, –í–∏–∫—Ç–æ—Ä"  ‚Üí "–ú–æ–ª—á–∞–Ω–æ–≤ –í–∏–∫—Ç–æ—Ä"       (—É–±–∏—Ä–∞–µ—Ç –∑–∞–ø—è—Ç—ã–µ)
"–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π" ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å (multi-author)
```

**–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –∏–º—ë–Ω –∏ —Ñ–∞–º–∏–ª–∏–π
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ (–æ–∫–æ–Ω—á–∞–Ω–∏—è, —É–¥–∞—Ä–µ–Ω–∏—è)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç multi-author —Ñ–æ—Ä–º–∞—Ç—ã (—Å `;` separator)

#### PASS 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—ã–π –≤—ã–±–æ—Ä –∞–≤—Ç–æ—Ä–∞ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –≤ –≥—Ä—É–ø–ø–µ –ø–∞–ø–æ–∫ (–¥–ª—è —Ñ–∞–π–ª–æ–≤, –≥–¥–µ –∞–≤—Ç–æ—Ä –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∏–∑ –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞).

**–ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ—Ç:** 
- –ï—Å–ª–∏ –≤ –ø–∞–ø–∫–µ –µ—Å—Ç—å 5 —Ñ–∞–π–ª–æ–≤ "–ì–æ–±–ª–∏–Ω–∞" (–∏–∑ –ø–∞–ø–∫–∏) –∏ 1 —Ñ–∞–π–ª "–î—Ä—É–≥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞" (–∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö) - –∫–∞–∫–æ–≥–æ –≤—ã–±—Ä–∞—Ç—å –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ?
- –ö–æ–Ω—Å–µ–Ω—Å—É—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û:** –ö–æ–Ω—Å–µ–Ω—Å—É—Å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –∫ —Ñ–∞–π–ª–∞–º –±–µ–∑ –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

```
‚úÖ author_source="folder_dataset" ‚Üí –ù–ï–ü–†–ò–ö–û–°–ù–û–í–ï–ù–ï–ù (–Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º)
‚úÖ author_source="metadata"      ‚Üí –ù–ï–ü–†–ò–ö–û–°–ù–û–í–ï–ù–ï–ù (–Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º)
‚ùå author_source=""              ‚Üí –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å consensus
‚ùå author_source="filename"      ‚Üí –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å consensus
```

**–ê–ª–≥–æ—Ä–∏—Ç–º (pass4_consensus.py):**

```python
class Pass4Consensus:
    def execute(self, records):
        # –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–∞–ø–∫–µ (file_path.parent)
        folders = {}
        for record in records:
            folder = Path(record.file_path).parent
            if folder not in folders:
                folders[folder] = []
            folders[folder].append(record)
        
        # –î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –ø–∞–ø–∫–∏
        for folder, group in folders.items():
            # –û—Ç–æ–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã —Å author_source="folder_dataset" –∏–ª–∏ "metadata"
            determined = [r for r in group 
                         if r.author_source in ["folder_dataset", "metadata"]]
            
            # –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã - –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –¥–ª—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
            undetermined = [r for r in group 
                           if r.author_source in ["", "filename"]]
            
            if determined and undetermined:
                # –ù–∞–π—Ç–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ (—Å–∞–º—ã–π —á–∞—Å—Ç—ã–π –≤ determined)
                consensus_author = self._find_consensus(determined)
                
                # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å –∫ undetermined —Ñ–∞–π–ª–∞–º
                for record in undetermined:
                    if record.proposed_author:  # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–∞–∫–æ–π-—Ç–æ –∞–≤—Ç–æ—Ä
                        record.proposed_author = consensus_author
                        record.author_source = "consensus"
```

**–ü—Ä–∏–º–µ—Ä:**

```
–ü–∞–ø–∫–∞: /Books/–ì–æ–±–ª–∏–Ω/
  book1.fb2 ‚Üí author="–ì–æ–±–ª–∏–Ω", source="folder_dataset" ‚Üê –ù–ï –ú–ï–ù–Ø–¢–¨
  book2.fb2 ‚Üí author="–ì–æ–±–ª–∏–Ω", source="metadata"      ‚Üê –ù–ï –ú–ï–ù–Ø–¢–¨
  book3.fb2 ‚Üí author="", source=""                     ‚Üê –ö–∞–Ω–¥–∏–¥–∞—Ç –¥–ª—è consensus
  book4.fb2 ‚Üí author="–î—Ä—É–≥–æ–π", source="filename"      ‚Üê –ö–∞–Ω–¥–∏–¥–∞—Ç –¥–ª—è consensus

–ö–æ–Ω—Å–µ–Ω—Å—É—Å –¥–ª—è determined (book1, book2): "–ì–æ–±–ª–∏–Ω"
–ü—Ä–∏–º–µ–Ω—è–µ–º –∫ undetermined:
  book3.fb2 ‚Üí author="–ì–æ–±–ª–∏–Ω", source="consensus"  ‚úÖ
  book4.fb2 ‚Üí author="–ì–æ–±–ª–∏–Ω", source="consensus"  ‚úÖ

–†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ —Ñ–∞–π–ª—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∞–≤—Ç–æ—Ä–æ–º "–ì–æ–±–ª–∏–Ω"
```

**–ü—Ä–∏–º–µ—Ä:**
```
–ü–∞–ø–∫–∞: /–°–µ—Ä–∏—è - –§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏ –±–æ–µ–≤–∏–∫/
  book1.fb2 ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik", author_source = "metadata"
  book2.fb2 ‚Üí proposed_author = "MeXXanik –ì–æ–±–ª–∏–Ω", author_source = "metadata"
  book3.fb2 ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω", author_source = "metadata"
  book4.fb2 ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik", author_source = "metadata"
  book5.fb2 ‚Üí proposed_author = "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä", author_source = "metadata"

–ö–æ–Ω—Å–µ–Ω—Å—É—Å: "–ì–æ–±–ª–∏–Ω MeXXanik" (3 –∏–∑ 5)
–†–µ–∑—É–ª—å—Ç–∞—Ç: –í–°–ï 5 —Ñ–∞–π–ª–æ–≤ ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik", author_source = cons
```

#### PASS 5: –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π —Ñ–∞–º–∏–ª–∏–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–º–∏–ª–∏–π –∫ –∞–≤—Ç–æ—Ä–∞–º –ø–æ—Å–ª–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ (–º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è, –µ—Å–ª–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å –∏–∑–º–µ–Ω–∏–ª –∞–≤—Ç–æ—Ä–∞).

**–õ–æ–≥–∏–∫–∞:**
```
PASS 1: –ü—Ä–∏–º–µ–Ω—è–µ–º surname_conversions –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ FB2 —Ñ–∞–π–ª–∞
PASS 5: –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω—è–µ–º –ø–æ—Å–ª–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
  - –ü—Ä–∏—á–∏–Ω–∞: –ö–æ–Ω—Å–µ–Ω—Å—É—Å (PASS 4) –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ—Ä–∞
  - –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–æ–≤—ã–π –∞–≤—Ç–æ—Ä –ø—Ä–æ—à–µ–ª —á–µ—Ä–µ–∑ conversions
```

**–ê–ª–≥–æ—Ä–∏—Ç–º (pass5_conversions.py):**

```python
class Pass5Conversions:
    def execute(self, records):
        # –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–∏—Ç—å conversions –ø–æ—Å–ª–µ consensus
        for record in records:
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º "–°–±–æ—Ä–Ω–∏–∫" –∏ –ø—É—Å—Ç—ã–µ
            if record.proposed_author in ["–°–±–æ—Ä–Ω–∏–∫", ""]:
                continue
            
            # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–º–∏–ª–∏–π
            converted = self._apply_conversions(record.proposed_author)
            
            if converted != record.proposed_author:
                record.proposed_author = converted
```

**–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–º–∏–ª–∏–π:**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä—å –∏–∑ `config.json` "surname_conversions":
```json
{
  "–°—Ç–∞—Ä–µ—Ü": "–°—Ç–∞—Ä–∏—Ü—ã–Ω",
  "–°–µ–∑–∏–Ω": "–°–µ–∑–∏–Ω",
  ...
}
```

**–ü—Ä–∏–º–µ—Ä:**
```
–ö–æ–Ω—Å–µ–Ω—Å—É—Å –≤—ã–±—Ä–∞–ª: "–°—Ç–∞—Ä–µ—Ü –í–∏–∫—Ç–æ—Ä"
PASS 5: –ü—Ä–∏–º–µ–Ω–∏—Ç—å conversions ‚Üí "–°—Ç–∞—Ä–∏—Ü—ã–Ω –í–∏–∫—Ç–æ—Ä"
```

---

#### PASS 6: –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å–∫—Ä—ã—Ç—å –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã –∞–≤—Ç–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ò.–ü–µ—Ç—Ä–æ–≤" ‚Üí "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤") –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–≤–∞—Ä—è, —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–∑ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤ –≤ –Ω–∞–±–æ—Ä–µ.

**–ê–ª–≥–æ—Ä–∏—Ç–º (pass6_abbreviations.py):**

```python
class Pass6Abbreviations:
    def execute(self, records):
        # –®–∞–≥ 1: –°–æ–±—Ä–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å –≤—Å–µ—Ö —Ü–µ–ª—ã—Ö –∏–º—ë–Ω
        names_map = self._build_names_map(records)  # –ø–µ—Ç—Ä–æ–≤ ‚Üí [–ò–≤–∞–Ω, –°–µ—Ä–≥–µ–π]
        
        # –®–∞–≥ 2: –†–∞—Å–∫—Ä—ã—Ç—å –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã
        for record in records:
            if record.proposed_author in ["–°–±–æ—Ä–Ω–∏–∫", ""]:
                continue
            
            expanded = self._expand_abbreviations(record.proposed_author, names_map)
            
            if expanded != record.proposed_author:
                record.proposed_author = expanded
    
    def _build_names_map(self, records):
        """–°–æ–±—Ä–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å –ø–æ–ª–Ω—ã—Ö –∏–º—ë–Ω –∏–∑ –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤"""
        # –†–µ–∑—É–ª—å—Ç–∞—Ç: {
        #   "–ø–µ—Ç—Ä–æ–≤": {"–∏–≤–∞–Ω", "—Å–µ—Ä–≥–µ–π"},
        #   "–≥–æ–±–ª–∏–Ω": {"mexxanik"},
        #   ...
        # }
        ...
    
    def _expand_abbreviations(self, author, names_map):
        """–†–∞—Å–∫—Ä—ã—Ç—å –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã –≤ –∞–≤—Ç–æ—Ä–µ"""
        # "–ò.–ü–µ—Ç—Ä–æ–≤" ‚Üí –ø–æ–∏—Å–∫ "–ø–µ—Ç—Ä–æ–≤" –≤ names_map
        # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ ‚Üí –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π
        ...
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```
–°–ª–æ–≤–∞—Ä—å –∏–º—ë–Ω:
  –ø–µ—Ç—Ä–æ–≤ ‚Üí {–∏–≤–∞–Ω, —Å–µ—Ä–≥–µ–π}
  –≥–æ–±–ª–∏–Ω ‚Üí {mexxanik}

–†–∞—Å–∫—Ä—ã—Ç–∏–µ:
  "–ò.–ü–µ—Ç—Ä–æ–≤"       ‚Üí "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"        (–Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ª–æ–≤–∞—Ä–µ)
  "–°.–ì–æ–±–ª–∏–Ω"       ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å    (–Ω–µ –≤ —Å–ª–æ–≤–∞—Ä–µ)
  "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è         (–Ω–µ—Ç —Ç–æ—á–µ–∫)
```

---

## 6. –ö–ª–∞—Å—Å BookRecord

```python
@dataclass
class BookRecord:
    """–ó–∞–ø–∏—Å—å –æ –∫–Ω–∏–≥–µ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –Ω–∞ —Ä–∞–∑–Ω—ã—Ö PASS."""
    
    file_path: str              # –ü—É—Ç—å –∫ FB2 —Ñ–∞–π–ª—É (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ library_path)
    metadata_authors: str       # –ò—Å—Ö–æ–¥–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã –∏–∑ FB2 XML
    proposed_author: str        # –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –∏—Ç–æ–≥–æ–≤—ã–π –∞–≤—Ç–æ—Ä (evolves —á–µ—Ä–µ–∑ PASS)
    author_source: str          # –ò—Å—Ç–æ—á–Ω–∏–∫: "metadata", "folder_dataset", "filename", etc
    file_title: str             # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –∏–∑ title-info
    file_path_normalized: str   # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

**–ö–∞–∫ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è:**

```
PASS 1:
  file_path = "–ì–æ–±–ª–∏–Ω/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book.fb2"
  metadata_authors = "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)"
  proposed_author = "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω MeXXanik"    ‚Üê conversions –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
  author_source = "metadata"
  file_title = "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤"

PASS 3:
  proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik –ü–µ—Ç—Ä"    ‚Üê normalized format

PASS 4:
  (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ, –∫–æ–Ω—Å–µ–Ω—Å—É—Å —Å–æ–≤–ø–∞–ª)

PASS 5:
  proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik"         ‚Üê conversions –ø–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–µ–Ω—ã

PASS 6:
  (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–µ—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä)

```

---

## 7. CSV –í—ã—Ö–æ–¥: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

### 6.1 –ü–µ—Ä–µ—á–µ–Ω—å –∫–æ–ª–æ–Ω–æ–∫ (–≤ –ø–æ—Ä—è–¥–∫–µ —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ)

| ‚Ññ | –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---|---------|-----|---------|--------|
| 1 | `file_path` | str | –ü—É—Ç—å –∫ FB2 —Ñ–∞–π–ª—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ library_path | `–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2` |
| 2 | `metadata_authors` | str | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã –∏–∑ FB2 XML (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ) | `–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)` |
| 3 | `proposed_author` | str | –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ—Ä –ø–æ—Å–ª–µ –≤—Å–µ—Ö PASS (—ç–≤–æ–ª—é—Ü–∏—è –ø–æ PASS) | `–ì–æ–±–ª–∏–Ω MeXXanik` |
| 4 | `author_source` | str | –ò—Å—Ç–æ—á–Ω–∏–∫ –∞–≤—Ç–æ—Ä–∞ (PASS 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç) | `folder_dataset` / `filename` / `metadata` / `consensus` |
| 5 | `metadata_series` | str | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–∏–∏ –∏–∑ FB2 XML (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ) | `–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤` |
| 6 | `proposed_series` | str | –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–µ—Ä–∏—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö PASS (—ç–≤–æ–ª—é—Ü–∏—è –ø–æ PASS) | `–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤` |
| 7 | `series_source` | str | –ò—Å—Ç–æ—á–Ω–∏–∫ —Å–µ—Ä–∏–∏ (PASS 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç) | `folder_dataset` / `filename` / `metadata` / `consensus` |
| 8 | `file_title` | str | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ (–∏–∑ FB2 title-info) | `–ü–µ—Ä–≤–æ–µ –¥–µ–ª–æ` |


### 6.2 –ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä–æ–∫ CSV

```csv
file_path,metadata_authors,proposed_author,author_source,metadata_series,proposed_series,series_source,file_title
–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2,–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik),–ì–æ–±–ª–∏–Ω MeXXanik,folder_dataset,–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤,–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤,folder_dataset,–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤
–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ/–ö–Ω–∏–≥–∞ –æ—Ç —Ñ–∞–π–ª–∞.fb2,–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ê–≤—Ç–æ—Ä,–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ,filename,,–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ,filename,–ö–Ω–∏–≥–∞ –æ—Ç —Ñ–∞–π–ª–∞
–°–±–æ—Ä–Ω–∏–∫/book3.fb2,–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤,–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω,metadata,,–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω,metadata,–¢—Ä–µ—Ç—å—è –∫–Ω–∏–≥–∞
–ö–æ–º–ø–∏–ª—è—Ü–∏—è/–°–µ—Ä–∏—è1/book4.fb2,–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω,–ì–æ–±–ª–∏–Ω MeXXanik,consensus,–°–µ—Ä–∏—è1,–°–±–æ—Ä–Ω–∏–∫,consensus,–ß–µ—Ç–≤–µ—Ä—Ç–∞—è
```

### 6.3 –≠–≤–æ–ª—é—Ü–∏—è `proposed_author` –∏ `proposed_series` –ø–æ PASS

```
PASS 1 (init):    author: "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)" (—Å conversions) ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
                  series: "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤" ‚Üí "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤"
                  author_source = "folder_dataset", series_source = "folder_dataset"

PASS 2 (filename): author: "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (–∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞)
                  –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–æ–≤:
                    - "–ì–æ–±–ª–∏–Ω, –ü–µ—Ç—Ä–æ–≤" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik; –ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω" (sorted alphabetically!)
                  series: –∏–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑ —Å–∫–æ–±–æ–∫ –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
                  author_source = "filename"

PASS 3:           author: "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí "MeXXanik –ì–æ–±–ª–∏–Ω" (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
                  (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞)

PASS 4:           author: "MeXXanik –ì–æ–±–ª–∏–Ω" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (–∫–æ–Ω—Å–µ–Ω—Å—É—Å –ø—Ä–∏–º–µ–Ω–µ–Ω)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ–∑–∂–µ)
                  author_source = "consensus", series_source = "consensus" (–µ—Å–ª–∏ –±—ã–ª consensus)

PASS 5:           author: "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (conversions –ø–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–µ–Ω—ã)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

PASS 6:           author: "–ì.MeXXanik" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã —Ä–∞—Å–∫—Ä—ã—Ç—ã)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

FINAL CSV ROW:    file_path | metadata_authors | proposed_author | author_source | metadata_series | proposed_series | series_source | file_title

‚≠ê –ö–õ–Æ–ß–ï–í–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï –í PASS 2:
   - Multi-author —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω
   - –ê–≤—Ç–æ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –°–û–†–¢–ò–†–£–Æ–¢–°–Ø –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –ø–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º
   - –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: "; " (—Ç–æ—á–∫–∞-–∑–∞–ø—è—Ç–∞—è-–ø—Ä–æ–±–µ–ª), –ù–ï –∑–∞–ø—è—Ç–∞—è
   - –ü—Ä–∏–º–µ—Ä: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å" ‚Üí "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
```

### 6.4 –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```python
# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö PASS:
# 1. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å records –ø–æ file_path (–¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)
# 2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª CSV (–æ–±—ã—á–Ω–æ regen.csv –∏–ª–∏ —Å timestamp)
# 3. –ù–∞–ø–∏—Å–∞—Ç—å header: file_path,metadata_authors,proposed_author,author_source,metadata_series,proposed_series,series_source,file_title
# 4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord:
#    - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è (–∫–∞–≤—ã—á–∫–∏ –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–ø—è—Ç—É—é)
#    - –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç—Ä–æ–∫—É CSV –≤ –ø–æ—Ä—è–¥–∫–µ: file_path, metadata_authors, proposed_author, author_source, metadata_series, proposed_series, series_source, file_title
# 5. –ó–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
```

---

## 8. Smart Encoding Detection –¥–ª—è FB2 —Ñ–∞–π–ª–æ–≤

### 7.0 –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–∞–º–∏

FB2 —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∫–∞—Ö:
- **UTF-8** (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **CP1251** (Windows-1251, —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä—É—Å—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–∞—Ö)

**–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (priority-based):**
```
–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å UTF-8
    ‚Üí –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è ‚Üí –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å CP1251
    ‚Üí –ï—Å–ª–∏ –æ–±–µ –æ—à–∏–±–∫–∏ ‚Üí –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ–π –¥–ª—è –æ–±–æ–∏—Ö –∫–æ–¥–µ–∫–æ–≤
```

–ü—Ä–æ–±–ª–µ–º–∞: –ª—É—á—à–µ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–µ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É, –∞ –ø–æ –ø–æ—Ä—è–¥–∫—É.

### 7.1 –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥: Validation-Based Encoding Detection

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –ü–æ–ø—ã—Ç–∫–∞ 1: UTF-8 —Å–æ strict —Ä–µ–∂–∏–º–æ–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º UTF-8
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –ü–æ–ø—ã—Ç–∫–∞ 2

2. –ü–æ–ø—ã—Ç–∫–∞ 2: CP1251 —Å–æ strict —Ä–µ–∂–∏–º–æ–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º CP1251
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê (—Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥—ë–Ω)

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–µ—Ä–≤—ã–π —É—Å–ø–µ—à–Ω—ã–π –¥–µ–∫–æ–¥–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
–ì–∞—Ä–∞–Ω—Ç–∏—è: UTF-8 –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –Ω–æ CP1251 —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ fallback
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
def _detect_and_decode(file_path: Path, content: bytes) -> str:
    """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∫—É –∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —É—Å–ø–µ—Ö–∞."""
    
    # –ü–æ–ø—ã—Ç–∫–∞ 1: UTF-8
    try:
        return content.decode('utf-8')
    except UnicodeDecodeError:
        pass  # –ü–æ–ø—Ä–æ–±—É–µ–º CP1251
    
    # –ü–æ–ø—ã—Ç–∫–∞ 2: CP1251
    try:
        return content.decode('cp1251')
    except UnicodeDecodeError:
        # –û–±–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
        self.logger.log(f"[–ö–æ–¥–∏—Ä–æ–≤–∫–∞] –û–®–ò–ë–ö–ê: {file_path} –Ω–µ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è")
        return None  # –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å —Å –∑–∞–º–µ–Ω–æ–π —Å–∏–º–≤–æ–ª–æ–≤

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ –≤—Å–µ–º –º–µ—Ç–æ–¥–∞–º —á—Ç–µ–Ω–∏—è FB2:
- _extract_author_from_metadata() ‚úÖ
- _extract_all_authors_from_metadata() ‚úÖ  
- _extract_title_from_fb2() ‚úÖ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
–î–û:  6 —Ñ–∞–π–ª–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
–ü–û–°–õ–ï: 0 —Ñ–∞–π–ª–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (100% —É—Å–ø–µ—Ö)
```

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç:**
```
1. "–ó–æ—Ä–∏—á –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –ñ–∞—Ä–∫–æ–≤—Å–∫–∏–π –°–µ—Ä–≥–µ–π - –ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.fb2"
   - –¢—Ä–µ–±–∏–ª CP1251
   - ‚úÖ –¢–µ–ø–µ—Ä—å: "–ó–æ—Ä–∏—á –ê–ª–µ–∫—Å–∞–Ω–¥—Ä; –ñ–∞—Ä–∫–æ–≤—Å–∫–∏–π –°–µ—Ä–≥–µ–π"

2. –§–∞–π–ª—ã —Å —Ä—É—Å—Å–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ (—ë, –π, —à, —â, —é, —Ü, —Ö)
   - ‚úÖ –í—Å–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–µ–∫–æ–¥–∏—Ä—É—é—Ç—Å—è
```

---

## 9. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### 8.1 –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º—É—Å–æ—Ä

```python
blacklist = settings.get_filename_blacklist()
# blacklist = ["–∫–æ–º–ø–∏–ª—è—Ü–∏—è", "—Å–±–æ—Ä–Ω–∏–∫", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è", ...]

if any(word in proposed_author.lower() for word in blacklist):
    # –≠—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏, –∞ –Ω–µ –∞–≤—Ç–æ—Ä
    skip_record = True
```

### 8.2 –ü—Ä–∏–º–µ—Ä 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏–º–µ–Ω–∏/—Ñ–∞–º–∏–ª–∏–∏

```python
male_names = set(n.lower() for n in settings.get_male_names())
female_names = set(n.lower() for n in settings.get_female_names())
all_names = male_names | female_names

author = "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
first_word = author.split()[0].lower()

if first_word in all_names:
    order = "–ò–º—è –§–∞–º–∏–ª–∏—è"  # –ò–≤–∞–Ω - –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è
    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"
else:
    order = "–§–∞–º–∏–ª–∏—è –ò–º—è –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
```

### 8.3 –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π

```python
conversions = settings.get_author_surname_conversions()
# conversions = {
#     "–ì–æ–±–ª–∏–Ω (MeXXanik)": "–ì–æ–±–ª–∏–Ω MeXXanik",
#     "–ê–π–∑–µ–Ω–±–µ—Ä–≥": "–ë–µ—Ä–≥",
#     ...
# }

original = "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)"
if "–ì–æ–±–ª–∏–Ω (MeXXanik)" in original:
    converted = original.replace("–ì–æ–±–ª–∏–Ω (MeXXanik)", conversions["–ì–æ–±–ª–∏–Ω (MeXXanik)"])
    # –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω MeXXanik"
```

### 8.4 –ü—Ä–∏–º–µ—Ä 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫

```python
folder_parse_limit = settings.get_folder_parse_limit()  # 3

file_path = Path("–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book.fb2")

# –ü–æ–∏—Å–∫ –∞–≤—Ç–æ—Ä–∞ –≤–≤–µ—Ä—Ö –Ω–∞ –º–∞–∫—Å–∏–º—É–º 3 —É—Ä–æ–≤–Ω—è
for i in range(min(folder_parse_limit, len(file_path.parts)-1)):
    parent = file_path.parents[i]
    # –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å parent –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–∞
```

---

## 10. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### 9.1 –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ __init__

```python
from settings_manager import SettingsManager
from logger import Logger
from fb2_author_extractor import FB2AuthorExtractor
from author_normalizer_extended import AuthorNormalizerExtended  # –ù–æ–≤—ã–π –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –º–æ–¥—É–ª—å
```

### 9.2 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ RegenCSVService.__init__

```python
class RegenCSVService:
    def __init__(self, settings_manager=None):
        self.settings = settings_manager or SettingsManager('config.json')
        self.logger = Logger()
        self.extractor = FB2AuthorExtractor('config.json')
        self.normalizer = AuthorNormalizerExtended(self.settings, self.extractor)
        
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
        self.folder_parse_limit = self.settings.get_folder_parse_limit()
        self.data_dir = Path(self.settings.get_library_path())
        self.output_csv = Path(self.settings.get_last_scan_path()) / "regen.csv"
```

---

## 10. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 10.1 –î–û (—Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ - —É–¥–∞–ª—è–µ—Ç—Å—è)

```
regen_csv.py (1459 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ –ü–∞—Ä—Å–∏–Ω–≥ –ø–∞–ø–æ–∫ (PASS 1) ‚ùå –£–î–ê–õ–ò–¢–¨
‚îú‚îÄ‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ FB2 (PASS 2) ‚ùå –£–î–ê–õ–ò–¢–¨
‚îú‚îÄ‚îÄ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (PASS 3)  ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
‚îú‚îÄ‚îÄ –ö–æ–Ω—Å–µ–Ω—Å—É—Å (PASS 4)     ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
‚îú‚îÄ‚îÄ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (PASS 5)   ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
‚îî‚îÄ‚îÄ –†–∞—Å–∫—Ä—ã—Ç–∏–µ (PASS 6)     ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
```

### 10.2 –ü–û–°–õ–ï (–Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ - —Å–æ–∑–¥–∞—ë—Ç—Å—è)

```
author_normalizer_extended.py (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π)
‚îú‚îÄ‚îÄ AuthorName (–∏–∑ name_normalizer.py)
‚îú‚îÄ‚îÄ AuthorNormalizerExtended (–Ω–æ–≤—ã–π –∫–ª–∞—Å—Å)
‚îÇ   ‚îú‚îÄ‚îÄ normalize_single_name()
‚îÇ   ‚îú‚îÄ‚îÄ validate_author_name()
‚îÇ   ‚îú‚îÄ‚îÄ apply_surname_conversions()
‚îÇ   ‚îú‚îÄ‚îÄ apply_surname_conversions_to_records()
‚îÇ   ‚îú‚îÄ‚îÄ expand_abbreviated_authors()
‚îÇ   ‚îî‚îÄ‚îÄ apply_author_consensus()
‚îî‚îÄ‚îÄ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

regen_csv.py (–Ω–æ–≤—ã–π - ~500 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ BookRecord
‚îú‚îÄ‚îÄ RegenCSVService
‚îÇ   ‚îú‚îÄ‚îÄ PASS 1: _read_fb2_files()
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PASS 2: _extract_author_from_filename_by_patterns()
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _file_pattern_to_regex()          ‚Üê new: –ø–∞—Ç—Ç–µ—Ä–Ω—ã -> regex
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _clean_author_name()              ‚Üê new: —É–±—Ä–∞—Ç—å –ø–∞—Ä–∞–∑–∏—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _expand_author_to_full_name()     ‚Üê new: —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∏–∑ metadata
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _process_and_expand_authors()     ‚Üê new: –æ—Ä–∫–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å pipeline
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PASS 3: _normalize_authors()
‚îÇ   ‚îú‚îÄ‚îÄ PASS 4: _apply_consensus()
‚îÇ   ‚îú‚îÄ‚îÄ PASS 5: _apply_conversions()
‚îÇ   ‚îú‚îÄ‚îÄ PASS 6: _expand_abbreviations()
‚îÇ   ‚îú‚îÄ‚îÄ _read_fb2_metadata()
‚îÇ   ‚îú‚îÄ‚îÄ _save_csv()
‚îÇ   ‚îî‚îÄ‚îÄ regenerate()
‚îî‚îÄ‚îÄ if __name__ == "__main__": service.regenerate()

settings_manager.py          ‚Üê –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
fb2_author_extractor.py      ‚Üê –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
logger.py                    ‚Üê –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ PASS 2:**

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|-----------|-----------|-----------|
| `_file_pattern_to_regex()` | pattern_desc: str | Tuple[str, List[str]] | –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ ("Author - Title") –≤ regex —Å –≥—Ä—É–ø–ø–∞–º–∏ |
| `_extract_author_from_filename_by_patterns()` | filename: str | Optional[str] | –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–æ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≥—Ä—É–ø–ø) |
| `_clean_author_name()` | extracted_author: str | str | –û—á–∏—Å—Ç–∏—Ç—å –æ—Ç —Ü–∏—Ç–∞—Ç, —Å–∫–æ–±–æ–∫, trailing dots, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å whitespace |
| `_expand_author_to_full_name()` | partial_author: str, metadata_authors: str | str | –†–∞—Å—à–∏—Ä–∏—Ç—å "–§–∞–º–∏–ª–∏—è" –¥–æ "–§–∞–º–∏–ª–∏—è –ò–º—è" –∏—Å–ø–æ–ª—å–∑—É—è metadata |
| `_process_and_expand_authors()` | cleaned_author: str, current_record: BookRecord, all_records: List[BookRecord] | str | –ü–æ–ª–Ω—ã–π pipeline: split ‚Üí expand ‚Üí deduplicate ‚Üí **sort** ‚Üí join —Å "; " |

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ PASS 2:**

‚úÖ –õ—É—á—à–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–≤–ø–∞–¥—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø (3 –≥—Ä—É–ø–ø—ã > 2 –≥—Ä—É–ø–ø—ã)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö —Ñ–∞–º–∏–ª–∏–π —á–µ—Ä–µ–∑ metadata –∏ —Å–æ—Å–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã
‚úÖ **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –ø–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º**
‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å "; " (—Ç–æ—á–∫–∞-–∑–∞–ø—è—Ç–∞—è-–ø—Ä–æ–±–µ–ª) –¥–ª—è multi-author –∑–∞–ø–∏—Å–µ–π
‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
```

---

## 11. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  RegenCSVService.regenerate()       ‚îÇ
‚îÇ  –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ CSV         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                     ‚îÇ
   PASS 1-6            Settings & Config
   read & process      SettingsManager
        ‚îÇ              ‚îÇ
        ‚îú‚Üí Logger       ‚îú‚Üí folder_parse_limit
        ‚îÇ              ‚îú‚Üí male_names
        ‚îî‚Üí FB2AuthorExtractor
           ‚îÇ            ‚îú‚Üí female_names
           ‚îú‚Üí _normalize_author_format()
           ‚îÇ            ‚îú‚Üí author_surname_conversions
           ‚îî‚Üí expand methods
                        ‚îú‚Üí filename_blacklist
                        ‚îî‚Üí service_words

   AuthorNormalizerExtended
   ‚îú‚Üí apply_surname_conversions()
   ‚îú‚Üí apply_author_consensus()
   ‚îú‚Üí expand_abbreviated_authors()
   ‚îî‚Üí build_authors_map()
```

---

## 10. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ regen_csv.py

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ | –§—É–Ω–∫—Ü–∏—è | –ü—Ä–∏–º–µ—Ä |
|---|---|---|---|---|
| `folder_parse_limit` | int | PASS 1 (stub) | –ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ –ø–∞–ø–æ–∫ | 3 |
| `author_surname_conversions` | Dict | PASS 1, 5 | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–∞–º–∏–ª–∏–π | `{"–ì–æ–±–ª–∏–Ω (MeXXanik)": "–ì–æ–±–ª–∏–Ω MeXXanik"}` |
| `male_names` | List | PASS 3, 6 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏–º—ë–Ω | `["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–Ω–¥—Ä–µ–π", ...]` |
| `female_names` | List | PASS 3, 6 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏–º—ë–Ω | `["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ê–Ω–Ω–∞", ...]` |
| `filename_blacklist` | List | PASS 1, 3 | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º—É—Å–æ—Ä–∞ | `["—Å–±–æ—Ä–Ω–∏–∫", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è", ...]` |
| `library_path` | str | PASS 1 | –ü–∞–ø–∫–∞ —Å FB2 —Ñ–∞–π–ª–∞–º–∏ | `"C:/Users/.../EBook Library"` |
| `generate_csv` | bool | –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª | –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏ CSV | `true` |
| `author_series_patterns_in_files` | List[Dict] | PASS 2 | –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ | [—Å–º. –Ω–∏–∂–µ] |

### 10.1 –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è PASS 2: author_series_patterns_in_files

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Feb 2026):

```json
"author_series_patterns_in_files": [
  {
    "pattern": "(Author) - Title",
    "example": "(–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤) - –ò—Å—Ç–æ—Ä–∏—è –†–æ—Å—Å–∏–∏.fb2"
  },
  {
    "pattern": "Author - Title",
    "example": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ - –ò—Å—Ç–æ—Ä–∏—è –†–æ—Å—Å–∏–∏.fb2"
  },
  {
    "pattern": "Author. Title",
    "example": "–ë–µ–ª–æ—É—Å. –ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞.fb2"
  },
  {
    "pattern": "Title (Author)",
    "example": "–í–æ–π–Ω–∞ –∏ –º–∏—Ä (–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π).fb2"
  },
  {
    "pattern": "Title - (Author)",
    "example": "–í–æ–π–Ω–∞ –∏ –º–∏—Ä - (–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π).fb2"
  },
  {
    "pattern": "Author - Series.Title",
    "example": "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ 1. –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏.fb2"
  },
  {
    "pattern": "Author. Series. Title",
    "example": "–ê–Ω–∏—Å–∏–º–æ–≤. –í–∞—Ä–∏–∞–Ω—Ç ¬´–ë–∏—Å¬ª 2. –ì–æ–¥ –º–µ—Ä—Ç–≤–æ–π –∑–º–µ–∏.fb2"
  },
  {
    "pattern": "Author, Author. Title. (Series)",
    "example": "–ñ–∏–≤–æ–π, –ü—Ä–æ–∑–æ—Ä–æ–≤. –õ–µ–≥–∏–æ–Ω (–õ–µ–≥–∏–æ–Ω 1-3).fb2"
  },
  {
    "pattern": "Author. Title. (Series)",
    "example": "–ê–Ω–∏—Å–∏–º–æ–≤. –í–∞—Ä–∏–∞–Ω—Ç ¬´–ë–∏—Å¬ª 2. –ì–æ–¥ –º–µ—Ä—Ç–≤–æ–π –∑–º–µ–∏.fb2"
  },
  {
    "pattern": "Author - Title (Series. service_words)",
    "example": "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ (–°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏. –¢–µ—Ç—Ä–∞–ª–æ–≥–∏—è).fb2",
    "note": "FIXED Feb 2026: –¢–µ–ø–µ—Ä—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Å–∫–æ–±–∫–∏ (e.g., ' - 2021')"
  },
  {
    "pattern": "Author. Title (Series. service_words)",
    "example": "–î–µ–º—á–µ–Ω–∫–æ. –•–æ–ª—å–º–≥—Ä–∞–¥—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (–•–æ–ª—å–º–≥—Ä–∞–¥—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏. –¢—Ä–∏–ª–æ–≥–∏—è).fb2"
  },
  {
    "pattern": "Author, Author - Title (Series. service_words)",
    "example": "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å - –ê–∫–∞–¥–µ–º–∏–∫ (–°—Ç—Ä–∞–Ω–Ω–∏–∫ 4-5) - 2022.fb2",
    "note": "NEW Feb 2026: –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è multi-author —Ñ–∞–π–ª–æ–≤ —Å —Å–µ—Ä–∏–µ–π –≤ —Å–∫–æ–±–∫–∞—Ö"
  }
]
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Feb 2026:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω regex –¥–ª—è "Author - Title (Series. service_words)" - —Ç–µ–ø–µ—Ä—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω "Author, Author - Title (Series. service_words)" –¥–ª—è multi-author —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ–ø–µ—Ä—å —É—á–∏—Ç—ã–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–ª–æ–≤ –≤ series (—Ç–æ–º, –∫–Ω–∏–≥–∞, —á–∞—Å—Ç—å, —Ç–µ—Ç—Ä–∞–ª–æ–≥–∏—è, –¥–∏–ª–æ–≥–∏—è, –∏ —Ç.–¥.)

---

## 11. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ (Feb 2026)

### 11.1 Commit 5431307: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Ñ–∞–º–∏–ª–∏–∏ –ø—Ä–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ –∏–º–µ–Ω–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** "–ò–≤–∞–Ω–æ–≤ –î–º–∏—Ç—Ä–∏–π" –∏–∑ —Ñ–∞–π–ª–∞ ‚Üí "–î–º–∏—Ç—Ä–∏–π" –≤ –≤—ã–≤–æ–¥–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `_expand_author_to_full_name()` –∑–∞–º–µ–Ω—è–ª–∞ –±–æ–ª–µ–µ –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –Ω–∞ –º–µ–Ω–µ–µ –ø–æ–ª–Ω—É—é –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–º–µ–Ω–æ–π
if len(words) > len(full_name_words):
    return partial_author  # –ë–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ filename
else:
    return full_name  # –ë–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ metadata
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–ò–≤–∞–Ω–æ–≤ –î–º–∏—Ç—Ä–∏–π" –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º

---

### 11.2 Commit 0e2478a: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Å–ª–æ–≤ –≤ –∏–º–µ–Ω–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** "–¢—ë –ò–ª—å—è" –∏–∑ —Ñ–∞–π–ª–∞ ‚Üí "–ò–ª—å—è –¢–µ" (–ø–µ—Ä–µ–ø—É—Ç–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤)

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è –Ω–∞—Ö–æ–¥–∏–ª–∞ –æ–±–∞ —Å–ª–æ–≤–∞ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –Ω–æ –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –≤–µ—Ä—Å–∏—é –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å–ª–∏ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å–ª–æ–≤–∞ –≤ —Ä–∞–∑–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
partial_words_set = set(w.lower() for w in words)
full_name_words_set = set(w.lower() for w in full_name_words)
if (len(words) == len(full_name_words) and 
    partial_words_set == full_name_words_set):
    return partial_author  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –∏–∑ filename
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–¢–µ –ò–ª—å—è" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤

---

### 11.3 Commit 8b3875b: –°–±–æ—Ä –≤—Å–µ—Ö —Å–æ–∞–≤—Ç–æ—Ä–æ–≤-–æ–¥–Ω–æ—Ñ–∞–º–∏–ª—å—Ü–µ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** Filename "–ë–µ–ª–∞—à" + metadata "–õ—é–¥–º–∏–ª–∞ –ë–µ–ª–∞—à; –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë–µ–ª–∞—à" ‚Üí —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞–≤—Ç–æ—Ä

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞—Å—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –≤ —Ü–∏–∫–ª–µ.

**–†–µ—à–µ–Ω–∏–µ:**
```python
matching_authors = []  # –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –∞–≤—Ç–æ—Ä–æ–≤
for full_name in metadata_authors_list:
    if surname_matches(full_name, surname):
        matching_authors.append(full_name)

# –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –∞–≤—Ç–æ—Ä–æ–≤ - –≤–µ—Ä–Ω—É—Ç—å –∏—Ö
if matching_authors:
    if len(matching_authors) > 1:
        matching_authors.sort()
        return "; ".join(matching_authors)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë–µ–ª–∞—à; –õ—é–¥–º–∏–ª–∞ –ë–µ–ª–∞—à" (–æ–±–∞ —Å–æ–∞–≤—Ç–æ—Ä–∞), –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

### 11.4 Commit 1d0d26f: –î–µ–±–∞–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è PASS 2 - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–æ–∫ + –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ü–∞–ø–∫–∞ "–ñ–µ—Ä–µ–±—å—ë–≤" –ø–∞—Ä—Å–∏–ª–∞—Å—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –æ—Ç–¥–µ–ª—å–Ω–æ (–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
2. "–ñ–µ—Ä–µ–±—å—ë–≤" –Ω–µ –≤ known_authors ‚Üí `_contains_author_name()` –≤–æ–∑–≤—Ä–∞—â–∞–ª False
3. CSV –æ—à–∏–±–æ—á–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–ª proposed_author = "–õ–µ–Ω–ò–∑–¥–∞—Ç" (–∏–∑ –ø–∞–ø–∫–∏) –≤–º–µ—Å—Ç–æ "–ñ–µ—Ä–µ–±—å—ë–≤"

**–†–µ—à–µ–Ω–∏—è:**

#### A. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫ –≤ PASS 2
```python
folder_cache = {}  # –ö–ª—é—á: –ø–∞–ø–∫–∞, –ó–Ω–∞—á–µ–Ω–∏–µ: –∞–≤—Ç–æ—Ä

for folder_path in parts_to_check:
    if folder_path in folder_cache:
        parsed_author = folder_cache[folder_path]
    else:
        parsed_author = self._parse_author_from_folder_name(folder_name)
        folder_cache[folder_path] = parsed_author  # –ö–µ—à–∏—Ä—É–µ–º
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ö–∞–∂–¥–∞—è –ø–∞–ø–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë ‚Üí –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

#### B. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–∫—Ä–∏—Ç–∏–∫–∏ –≤ `_contains_author_name()`
```python
def _normalize_diacritics(self, text: str) -> str:
    """–ñ–µ—Ä–µ–±—å—ë–≤ ‚Üí –∂–µ—Ä–µ–±—å–µ–≤"""
    nfd = unicodedata.normalize('NFD', text)
    return ''.join(c for c in nfd if unicodedata.category(c) != 'Mn')

# –í –ø—Ä–æ–≤–µ—Ä–∫–µ:
text_normalized = self._normalize_diacritics(text_lower)
```

**–≠—Ñ—Ñ–µ–∫—Ç:** "–ñ–µ—Ä–µ–±—å—ë–≤" (—Å —ë) —Ç–µ–ø–µ—Ä—å —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å "–∂–µ—Ä–µ–±—å–µ–≤" (–±–µ–∑ –¥–∏–∞–∫—Ä–∏—Ç–∏–∫–∏) –≤ –∫–æ–Ω—Ñ–∏–≥–µ

#### C. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ `_looks_like_author_name()`
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–º–µ–Ω–∏ –ë–ï–ó —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±—ã—Ç—å –≤ known_authors
def _looks_like_author_name(self, text: str) -> bool:
    if len(text) < 2 or len(text) > 100:
        return False
    has_letter = any(c.isalpha() for c in text)
    if not has_letter:
        return False
    # –ù–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ —á–∏—Å–µ–ª
    return True

# –í extraction:
if self._contains_author_name(author) or self._looks_like_author_name(author):
    best_author = author
```

**–≠—Ñ—Ñ–µ–∫—Ç:** "–ñ–µ—Ä–µ–±—å—ë–≤" —Ç–µ–ø–µ—Ä—å –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ filename –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –≤ known_authors

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
proposed_author: "–í–ª–∞–¥–∏—Å–ª–∞–≤ –ñ–µ—Ä–µ–±—å–µ–≤" (–≤–º–µ—Å—Ç–æ –æ—à–∏–±–æ—á–Ω–æ–≥–æ "–õ–µ–Ω–ò–∑–¥–∞—Ç")
normalized_author: "–ñ–µ—Ä–µ–±—å–µ–≤ –í–ª–∞–¥–∏—Å–ª–∞–≤"
source: "filename"
```

---

### 11.5 Commit 9bd28a8: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Ñ–∞–º–∏–ª–∏–π –¥–ª—è —Å–æ–∞–≤—Ç–æ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** Filename "–ö–∞–º–µ–Ω—Å–∫–∏–µ - –í–∏—Ç—è–∑—å.fb2" (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ) + metadata "–Æ—Ä–∏–π –ö–∞–º–µ–Ω—Å–∫–∏–π; –í–µ—Ä–∞ –ö–∞–º–µ–Ω—Å–∫–∞—è" ‚Üí –æ–±–∞ –∞–≤—Ç–æ—Ä–∞ —Ç–µ—Ä—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** "–ö–∞–º–µ–Ω—Å–∫–∏–µ" –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª —Å "–ö–∞–º–µ–Ω—Å–∫–∏–π" –∏–ª–∏ "–ö–∞–º–µ–Ω—Å–∫–∞—è"

**–†–µ—à–µ–Ω–∏—è:**

#### A. –§—É–Ω–∫—Ü–∏—è `_extract_surname_from_fullname()` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–∞–º–∏–ª–∏–∏
```python
def _extract_surname_from_fullname(self, full_name: str) -> str:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ñ–∞–º–∏–ª–∏—é –∏–∑ –ø–æ–ª–Ω–æ–≥–æ –∏–º–µ–Ω–∏, –ø—Ä–æ–≤–µ—Ä—è—è –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –ø—Ä–æ—Ç–∏–≤ known_names
    
    –õ–æ–≥–∏–∫–∞:
    1. –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ª–æ–≤–∞
    2. –ò—â–µ–º –∫–∞–∫–æ–µ —Å–ª–æ–≤–æ –µ—Å—Ç—å –≤ known_names (—ç—Ç–æ –ò–ú–Ø)
    3. –û—Å—Ç–∞–ª—å–Ω–æ–µ = –§–ê–ú–ò–õ–ò–Ø
    4. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã (–ê., –ê.–í., –ê.–í.–ú.)
    
    –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞:
    - "–Æ—Ä–∏–π –ö–∞–º–µ–Ω—Å–∫–∏–π" ‚Üí "–ö–∞–º–µ–Ω—Å–∫–∏–π"
    - "–ö–∞–º–µ–Ω—Å–∫–∏–π –Æ—Ä–∏–π" ‚Üí "–ö–∞–º–µ–Ω—Å–∫–∏–π"
    - "–ê.–í. –ß–µ—Ö–æ–≤" ‚Üí "–ß–µ—Ö–æ–≤"
    - "–ß–µ—Ö–æ–≤ –ê.–í." ‚Üí "–ß–µ—Ö–æ–≤"
    """
```

**–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ù–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ —Ñ–∞–º–∏–ª–∏—è –≤—Å–µ–≥–¥–∞ –≤ –∫–æ–Ω—Ü–µ –∏–ª–∏ –≤ –Ω–∞—á–∞–ª–µ - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–æ—Ç–∏–≤ `known_names`

#### B. –§—É–Ω–∫—Ü–∏—è `_normalize_surname_endings()` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏–π
```python
def _normalize_surname_endings(self, surname: str) -> str:
    """–£–¥–∞–ª—è–µ—Ç –≥–µ–Ω–¥–µ—Ä–Ω—ã–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä—É—Å—Å–∫–∏—Ö —Ñ–∞–º–∏–ª–∏–π
    
    –ö–∞–º–µ–Ω—Å–∫–∏–µ ‚Üí –ö–∞–º–µ–Ω—Å–∫ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ)
    –ö–∞–º–µ–Ω—Å–∫–∏–π ‚Üí –ö–∞–º–µ–Ω—Å–∫ (–º—É–∂—Å–∫–æ–µ)
    –ö–∞–º–µ–Ω—Å–∫–∞—è ‚Üí –ö–∞–º–µ–Ω—Å–∫ (–∂–µ–Ω—Å–∫–æ–µ)
    –ö–æ–ª—å—Ü–∫–∏–µ ‚Üí –ö–æ–ª—å—Ü
    –ö–æ–ª—å—Ü–∫–∏–π ‚Üí –ö–æ–ª—å—Ü
    –ö–æ–ª—å—Ü–∫–∞—è ‚Üí –ö–æ–ª—å—Ü
    """
```

#### C. –û–±–Ω–æ–≤–ª–µ–Ω–∞ `_expand_author_to_full_name()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
```python
# –ò–∑–≤–ª–µ–∫–∞–µ–º —Ñ–∞–º–∏–ª–∏—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ
metadata_surname = self._extract_surname_from_fullname(full_name)
metadata_surname_normalized = self._normalize_surname_endings(metadata_surname)

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ—Ä–Ω–∏
if surname_normalized_lower == metadata_surname_normalized_lower:
    matching_authors.append(full_name)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
filename: "–ö–∞–º–µ–Ω—Å–∫–∏–µ - –í–∏—Ç—è–∑—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.fb2"
proposed_author: "–Æ—Ä–∏–π –ö–∞–º–µ–Ω—Å–∫–∏–π; –í–µ—Ä–∞ –ö–∞–º–µ–Ω—Å–∫–∞—è"
normalized_author: "–ö–∞–º–µ–Ω—Å–∫–∞—è –í–µ—Ä–∞, –ö–∞–º–µ–Ω—Å–∫–∏–π –Æ—Ä–∏–π"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ —Å–ª–æ–≤ –≤ –∏–º–µ–Ω–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–æ–≤ –∏ –≥–µ–Ω–¥–µ—Ä–Ω—ã—Ö –æ–∫–æ–Ω—á–∞–Ω–∏–π
- –°–æ–±–∏—Ä–∞–µ—Ç –í–°–ï —Å–æ–∞–≤—Ç–æ—Ä–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ñ–∞–º–∏–ª–∏–µ–π

---

## –ì–æ—Ç–æ–≤–æ.


## 12. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ (Co-authorship)

### 12.1 –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, '–ë–µ–ª–∞—à –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –õ—é–¥–º–∏–ª–∞') —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–±–∞ –∏–º–µ–Ω–∏ –≤ –ø–æ–ª–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –§–ò.
