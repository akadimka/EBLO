# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ CSV

**üìå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å–æ–∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ (Co-authorship):** —Å–º. [COAUTHORSHIP_FEATURE.md](COAUTHORSHIP_FEATURE.md)

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ò—Å—Ç–æ—á–Ω–∏–∫ FB2 —Ñ–∞–π–ª–æ–≤ vs –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ß—Ç–µ–Ω–∏–µ FB2 —Ñ–∞–π–ª–æ–≤

**–í—Å–µ FB2 —Ñ–∞–π–ª—ã —Å–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è –∏–∑ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º config.json:**

```json
"last_scan_path": "C:/Users/dmitriy.murov/Downloads/TriblerDownloads/Test1"
```

- **last_scan_path** = —Ä–∞–±–æ—á–∞—è –ø–∞–ø–∫–∞, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è FB2 —Ñ–∞–π–ª—ã (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
- **library_path** = –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤!
- –ê–ª–≥–æ—Ä–∏—Ç–º: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∏—â–µ—Ç –≤—Å–µ `*.fb2` –≤ `last_scan_path` –∏ –µ–≥–æ –ø–æ–¥–ø–∞–ø–∫–∞—Ö
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ CSV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç `last_scan_path`

### ‚≠ê –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ CSV —Ñ–∞–π–ª–∞

**CSV —Ñ–∞–π–ª –í–°–ï–ì–î–ê —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É –ü–†–û–ï–ö–¢–ê (c:\\Temp\\fb2parser), –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç last_scan_path!**

```
c:\Temp\fb2parser\regen.csv  ‚Üê –§–ò–ö–°–ò–†–û–í–ê–ù–ù–û–ï –ú–ï–°–¢–û
                              (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç config.json)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- project_dir –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø–∞–ø–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ `regen_csv.py`
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ CSV –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

## 1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: name_normalizer.py vs author_utils.py

### –ü—Ä–æ–±–ª–µ–º–∞: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ

–û–±–∞ —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–æ–≥–∏–∫—É –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–æ–≤, –Ω–æ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏:

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞  | `name_normalizer.py`              | `author_utils.py`                       |
|---              |---                                |---                                      |
| **–ö–ª–∞—Å—Å**       | `AuthorName`                      | `AuthorUtils`                           |
| **–§–æ–∫—É—Å**       | –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –∏–º–µ–Ω–∏         | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∫ –∑–∞–ø–∏—Å—è–º     |
| **–ü–æ–ª—è**        | `.raw_name`, `.normalized`        | –†–∞–±–æ—Ç–∞–µ—Ç —Å `BookRecord`                 |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è**   | –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º—É—Å–æ—Ä/blacklist       | –ö–æ–Ω—Å–µ–Ω—Å—É—Å –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏                 |
| **–ö–æ–Ω—Ñ–∏–≥**      | –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (static) | –ß–µ—Ä–µ–∑ `SettingsManager`                 |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | –¢–æ–ª—å–∫–æ config.json                | `SettingsManager`, `FB2AuthorExtractor` |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–ë–™–ï–î–ò–ù–ò–¢–¨ –í –û–î–ò–ù –§–ê–ô–õ

‚úÖ **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `author_utils.py` ‚Üí `author_normalizer_extended.py` –∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º:

```python
# –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- normalize_single_name()        # –ò–∑ name_normalizer.py
- validate_author_name()         # –ò–∑ name_normalizer.py
- apply_surname_conversions()    # –ò–∑ author_utils.py

# –§—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø–∏—Å–µ–π
- apply_surname_conversions_to_records()
- expand_abbreviated_authors()
- apply_author_consensus()
- build_authors_map()
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–¥–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–π
- –ï–¥–∏–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ñ–∏–≥–æ–º
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏

---

## 2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Å–ø–∏—Å–∫–∏ –∏–∑ config.json

### 2.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è regen_csv.py

```json
{
  "folder_parse_limit": 3,
  "author_surname_conversions": {
    "–ì–æ–±–ª–∏–Ω (MeXXanik)": "–ì–æ–±–ª–∏–Ω MeXXanik",
    "–ê–π–∑–µ–Ω–±–µ—Ä–≥": "–ë–µ—Ä–≥",
    "–°—Ç–∞—Ä–µ—Ü": "–°—Ç–∞—Ä–∏—Ü—ã–Ω"
  },
  "male_names": ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–Ω–¥—Ä–µ–π", "–ê—Ä—Ç–µ–º", "–í–∞—Å–∏–ª–∏–π", ...],
  "female_names": ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ê–ª–∏—Å–∞", "–ê–Ω–Ω–∞", "–í–∏–∫—Ç–æ—Ä–∏—è", ...],
  "filename_blacklist": ["–∫–æ–º–ø–∏–ª—è—Ü–∏—è", "—Å–±–æ—Ä–Ω–∏–∫", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è", "–∑–∞–≥—Ä—É–∑–∫–∏", ...],
  "service_words": ["—Ç–æ–º", "–∫–Ω–∏–≥–∞", "—á–∞—Å—Ç—å", "—á", "–∫–Ω", "vol", ...],
  "sequence_patterns": ["—Ç–æ–º \\d+", "–∫–Ω–∏–≥–∞ \\d+", ...],
  "author_series_patterns_in_files": [...],
  "author_series_patterns_in_folders": [...],
  "author_name_patterns": [...]
}
```

### 2.2 –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ regen_csv.py

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
settings = SettingsManager('config.json')
folder_parse_limit = settings.get_folder_parse_limit()           # –ì–ª—É–±–∏–Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫
male_names = settings.get_male_names()                           # –ú—É–∂—Å–∫–∏–µ –∏–º–µ–Ω–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞
female_names = settings.get_female_names()                       # –ñ–µ–Ω—Å–∫–∏–µ –∏–º–µ–Ω–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞
surname_conversions = settings.get_author_surname_conversions()  # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–º–∏–ª–∏–π
blacklist = settings.get_filename_blacklist()                    # –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —à—É–º–∞

# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
# 1. –î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä—Å–∫–æ–≥–æ –∏–º–µ–Ω–∏ (–Ω–µ –º—É—Å–æ—Ä –ª–∏)
if name in blacklist:
    skip_name()

# 2. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ "–ò–º—è –§–∞–º–∏–ª–∏—è" vs "–§–∞–º–∏–ª–∏—è –ò–º—è"
if first_word.lower() in male_names:
    order = "–ò–º—è –§–∞–º–∏–ª–∏—è"
else:
    order = "–§–∞–º–∏–ª–∏—è –ò–º—è"

# 3. –î–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ñ–∞–º–∏–ª–∏–π
if original_author in surname_conversions:
    canonical_author = surname_conversions[original_author]

# 4. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫ (PASS 1)
# folder_parse_limit = 3 ‚Üí —Å–º–æ—Ç—Ä–∏–º –º–∞–∫—Å–∏–º—É–º 3 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö –≤ –ø–∞–ø–∫–∞—Ö
```

---

## 3. –ü–æ–¥–∫–ª—é—á–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 3.1 `settings_manager.py` - SettingsManager

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
from settings_manager import SettingsManager
settings = SettingsManager('config.json')
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
settings.get_folder_parse_limit()        # ‚Üí int (–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ config.json: 3)
settings.get_generate_csv()              # ‚Üí bool (–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏ CSV)

# –°–ø–∏—Å–∫–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
settings.get_male_names()                 # ‚Üí List[str]
settings.get_female_names()               # ‚Üí List[str]
settings.get_filename_blacklist()         # ‚Üí List[str]
settings.get_service_words()              # ‚Üí List[str]
settings.get_author_surname_conversions() # ‚Üí Dict[str, str]

# –ü—É—Ç–∏ –∏ –∫–∞—Ç–∞–ª–æ–≥–∏
settings.get_library_path()              # ‚Üí str
settings.get_last_scan_path()            # ‚Üí str
settings.get_genres_file_path()          # ‚Üí str

# –†–∞–±–æ—Ç–∞ —Å –æ–∫–Ω–∞–º–∏
settings.set_window_size(name, w, h)
settings.get_window_sizes()
```

### 3.2 `fb2_author_extractor.py` - FB2AuthorExtractor

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
from fb2_author_extractor import FB2AuthorExtractor
extractor = FB2AuthorExtractor('config.json')
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

```python
# ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–ú –í regen_csv.py:

# 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É: –ø–∞–ø–∫–∞ ‚Üí —Ñ–∞–π–ª ‚Üí –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (PASS 1)
author, source = extractor.resolve_author_by_priority(fb2_filepath, folder_parse_limit)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: (–∞–≤—Ç–æ—Ä, "folder" / "filename" / "metadata")

# 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∞–≤—Ç–æ—Ä–∞ ("–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω")
normalized = extractor._normalize_author_format(author_string)

# 4. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä ("–ê.–§–∞–º–∏–ª–∏—è" ‚Üí "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –§–∞–º–∏–ª–∏—è")
expanded = extractor.expand_abbreviated_author(abbreviated, authors_map)

# 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º—ë–Ω (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
all_names = extractor.all_names  # Set –∏–∑ male_names + female_names

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–º–∏–ª–∏–∏ –≤ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∞—Ö
is_author = extractor.is_author(name)


```

### 3.3 `author_processor.py` - AuthorProcessor

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ FB2AuthorExtractor.**

**–ú–µ—Ç–æ–¥—ã –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã:**
```python
processor = self.extractor.author_processor

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (–∑–∞–º–µ–Ω–∞ —ë‚Üí–µ, etc)
normalized_text = processor.normalize_text(text)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∞ –ø–æ –∏–º–µ–Ω–∏
gender = processor.determine_gender(first_name)  # ‚Üí 'M', 'F', 'U' (Unknown)
```

### 3.4 `logger.py` - Logger

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:**
```python
from logger import Logger
logger = Logger()

logger.log("–°–æ–æ–±—â–µ–Ω–∏–µ")                    # –û–±—ã—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logger.log("–û—à–∏–±–∫–∞!", "error")             # –û—à–∏–±–∫–∞
logger.log("[PASS 1] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤")    # –° –ø—Ä–µ—Ñ–∏–∫—Å–æ–º
```

---

## 4. –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: 6 PASS —Å–∏—Å—Ç–µ–º—ã

### 4.1 –û–±—â–∞—è —Å—Ö–µ–º–∞ (6-PASS –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 2.0)

```
PASS 1: –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ (–ø–∞–ø–∫–∞ ‚Üí –ø—É—Å—Ç–æ)
        ‚Üì
        1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–ø–∫–∏ –≤–≤–µ—Ä—Ö –¥–æ folder_parse_limit —É—Ä–æ–≤–Ω–µ–π
        2. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ metadata (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø–∞–ø–∫–µ)
        3. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ metadata ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º
        4. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ë–ï–ó –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Üí –æ—Ç–≤–µ—Ä–≥–∞–µ–º
        5. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–∞–ª–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ü–£–°–¢–û (not fallback!)
        –ü—Ä–∏–º–µ–Ω–∏—Ç—å conversions: "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
        ‚Üí BookRecord(metadata_authors="", proposed_author="", author_source="")

PASS 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (filename –¢–û–õ–¨–ö–û)
        ‚Üì
        1. –î–ª—è —Ñ–∞–π–ª–æ–≤ —Å –ø—É—Å—Ç—ã–º proposed_author –∏–∑ PASS 1
        2. –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
        3. Metadata –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ù–ï –¥–ª—è –æ—Ç–∫–∞–∑–∞
        4. –ï—Å–ª–∏ extraction —É—Å–ø–µ—à–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç metadata)
        5. –ï—Å–ª–∏ extraction –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª ‚Üí –æ—Å—Ç–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ
        ‚Üí BookRecord(proposed_author="–∞–≤—Ç–æ—Ä –∏–∑ filename", author_source="filename")

PASS 2 Fallback: –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∫–∞–∫ –ü–û–°–õ–ï–î–ù–ò–ô –∏—Å—Ç–æ—á–Ω–∏–∫
        ‚Üì
        1. –î–ª—è —Ñ–∞–π–ª–æ–≤ —Å –ø—É—Å—Ç—ã–º proposed_author (–Ω–∏ PASS1, –Ω–∏ PASS2 –Ω–µ –¥–∞–ª–∏)
        2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∏–∑ FB2 –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
        3. Metadata –ø—Ä–æ–π–¥–µ—Ç —á–µ—Ä–µ–∑ PASS 3-6 –≤–º–µ—Å—Ç–µ —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∞–≤—Ç–æ—Ä–∞–º–∏
        ‚Üí BookRecord(proposed_author="metadata_authors", author_source="metadata")

PASS 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤
        ‚Üì
        1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (–ò–º—è –§–∞–º–∏–ª–∏—è ‚Üí –§–∞–º–∏–ª–∏—è –ò–º—è)
        2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ extractor._normalize_author_format()
        3. –†–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ –∞–≤—Ç–æ—Ä–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞

PASS 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
        ‚Üì
        1. –ü–æ–∏—Å–∫ –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ
        2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
        3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ –≤—Å–µ–π –≥—Ä—É–ø–ø–µ (–µ—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω–æ–≥–æ folder_dataset)

PASS 5: –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π —Ñ–∞–º–∏–ª–∏–π
        ‚Üì
        1. –í—Ç–æ—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ surname_conversions (–ø–æ—Å–ª–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞)
        2. –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ PASS 4

PASS 6: –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä
        ‚Üì
        1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ "–ê.–§–∞–º–∏–ª–∏—è" ‚Üí "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –§–∞–º–∏–ª–∏—è"
        2. –¢—Ä–µ–±—É–µ—Ç —Å–ª–æ–≤–∞—Ä—è –ø–æ–ª–Ω—ã—Ö –∏–º—ë–Ω (build_authors_map)
        3. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

        ‚Üì
CSV SAVE: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ regen.csv
```

### ‚ö†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã PASS 1-2-Fallback

**–ñ–ï–õ–ï–ó–ù–û–ï –ü–†–ê–í–ò–õ–û: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º**

1. **PASS 1 —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å –ø–∞–ø–∫–æ–π** (folder_dataset)
   - –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º metadata –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
   - –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –ù–ï –¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ü–£–°–¢–û (–Ω–µ fallback!)
   - Metadata –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–µ–Ω–∏—è, –ù–ò–ö–û–ì–î–ê –¥–ª—è –æ—Ç–∫–∞–∑–∞

2. **PASS 2 —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å filename**
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ = –±–∞–∑–∞ –¥–ª—è filename source
   - –ï—Å–ª–∏ extraction —É—Å–ø–µ—à–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
   - Metadata confirmation –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ù–ï –¥–ª—è –æ—Ç–∫–∞–∑–∞

3. **PASS 2 Fallback –ø—Ä–∏–º–µ–Ω—è–µ—Ç metadata –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å**
   - –¢–û–õ–¨–ö–û –µ—Å–ª–∏ PASS 1 + PASS 2 –æ–±–∞ –¥–∞–ª–∏ –ü–£–°–¢–û
   - Metadata –∑–∞—Ç–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ PASS 3-6

4. **PASS 3-6 —Ä–∞–±–æ—Ç–∞—é—Ç —Å –†–ï–ó–£–õ–¨–¢–ê–¢–û–ú (proposed_author)**
   - –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ filename –∏–ª–∏ –ø–∞–ø–∫–µ
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–µ—á–µ—Ç –¢–û–õ–¨–ö–û –≤–ø–µ—Ä–µ–¥ —á–µ—Ä–µ–∑ PASS'—ã
   - –ò—Å—Ç–æ—á–Ω–∏–∫ (author_source) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä: –§–∞–π–ª "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π - –î–∏—Ç—è –ø—Ä–∏–±–æ—è (–°–µ—Ä–∏—è).fb2"**
```
Metadata: "–≠–ª—å—Ö–∞–Ω –ê—Å–∫–µ—Ä–æ–≤" (–î–†–£–ì–û–ô –∞–≤—Ç–æ—Ä!)

PASS 1 (–ø–∞–ø–∫–∞):
  - –ü–∞–ø–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ –∫–∞–∫ –∞–≤—Ç–æ—Ä—Å–∫–∞—è ‚Üí –ø—É—Å—Ç–æ

PASS 2 (filename):
  - Extraction: "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  - Metadata confirm: "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" ‚â† "–≠–ª—å—Ö–∞–Ω –ê—Å–∫–µ—Ä–æ–≤" ‚Üí FALSE
  - ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–ú anyway (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç confirmation)
  - –†–µ–∑—É–ª—å—Ç–∞—Ç: proposed_author="–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π", author_source="filename"

PASS 2 Fallback:
  - proposed_author —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º

PASS 3-6:
  - –†–∞–±–æ—Ç–∞—é—Ç —Å "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" –∫–∞–∫ —Å –æ–±—ã—á–Ω—ã–º –∞–≤—Ç–æ—Ä–æ–º
  
‚úÖ –ò–¢–û–ì: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–≤—Ç–æ—Ä "–¢—Ä–æ—Ñ–∏–º–æ–≤ –ï—Ä–æ—Ñ–µ–π" (–∏–∑ filename)
         Metadata "–≠–ª—å—Ö–∞–Ω –ê—Å–∫–µ—Ä–æ–≤" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
```

### 4.2 –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ PASS

#### PASS 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É

**–ñ–ï–õ–ï–ó–ù–û–ï –ü–†–ê–í–ò–õ–û:** –ø–∞–ø–∫–∞ ‚Üí —Ñ–∞–π–ª ‚Üí –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ò—Å—Ç–æ—á–Ω–∏–∫ FB2 —Ñ–∞–π–ª–æ–≤**
- FB2 —Ñ–∞–π–ª—ã —Å–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è **–≤ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ** (—Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `./`)
- **–ù–ï** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `library_path` –∏–∑ config.json –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è!
- `library_path` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ CSV
- –ê–ª–≥–æ—Ä–∏—Ç–º: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∏—â–µ—Ç –≤—Å–µ `*.fb2` —Ñ–∞–π–ª—ã –≤ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ –∏ –µ—ë –ø–æ–¥–ø–∞–ø–∫–∞—Ö

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –ü—É—Ç—å –∫ FB2 —Ñ–∞–π–ª—É (–Ω–∞–π–¥–µ–Ω–æ –≤ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ)
- folder_parse_limit = 3 (–≥–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ –≤–≤–µ—Ä—Ö –ø–æ –ø–∞–ø–∫–∞–º)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –ü–æ–ø—ã—Ç–∫–∞ 1: –ü–∞—Ä—Å–∏–Ω–≥ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫ (–í–ê–†–ò–ê–ù–¢ B - –ü–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∞ –∫–∞–∫ —Ü–µ–ª–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–ø–∫–∏ –≤–≤–µ—Ä—Ö –Ω–∞ folder_parse_limit —É—Ä–æ–≤–Ω–µ–π
   - ‚ö†Ô∏è –ó–ê–©–ò–¢–ê: –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–∞–ø–∫–∏ –≤ filename_blacklist ("—Å–±–æ—Ä–Ω–∏–∫", "–∫–æ–º–ø–∏–ª—è—Ü–∏—è", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è")
   - –ù–∞–π—Ç–∏ –ø–∞–ø–∫—É —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑—É—è patterns)
   - –ï–°–õ–ò –ù–ê–ô–î–ï–ù–ê ‚Üí author_source = "folder_dataset" (—ç—Ç–æ—Ç –∞–≤—Ç–æ—Ä –¥–ª—è –í–°–ï–ô –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–æ–¥ –Ω–µ–π)
   - –ü–†–ò–ú–ï–†: /Books/–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book.fb2
     ‚Üí –ù–∞–π—Ç–∏ "–ì–æ–±–ª–∏–Ω (MeXXanik)" –Ω–∞ —É—Ä–æ–≤–Ω–µ 2 ‚Üí folder_dataset="–ì–æ–±–ª–∏–Ω (MeXXanik)"
     ‚Üí –í–°–ï —Ñ–∞–π–ª—ã –ø–æ–¥ "–ì–æ–±–ª–∏–Ω (MeXXanik)/" –ø–æ–ª—É—á–∞—Ç —ç—Ç–æ—Ç folder_dataset

2. –ü–æ–ø—ã—Ç–∫–∞ 2: –ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
   - –ï—Å–ª–∏ –ü–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∞–≤—Ç–æ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑—É—è patterns)
   - –ü–†–ò–ú–ï–†: "–ì–æ–±–ª–∏–Ω - –ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤.fb2" ‚Üí "–ì–æ–±–ª–∏–Ω"
   - author_source = "filename"

3. –ü–æ–ø—ã—Ç–∫–∞ 3: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ FB2
   - –ï—Å–ª–∏ –ü–æ–ø—ã—Ç–∫–∞ 1 –∏ 2 –Ω–µ –¥–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   - –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ //fb:author –≤ title-info
   - –ü–†–ò–ú–ï–†: FB2 XML —Å–æ–¥–µ—Ä–∂–∏—Ç <first-name>–ü–µ—Ç—Ä</first-name><last-name>–ì–æ–±–ª–∏–Ω (MeXXanik)</last-name>
     ‚Üí "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)"
   - author_source = "metadata"

4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å conversions –Ω–∞ –ö–ê–ñ–î–û–ú —à–∞–≥–µ:
   - "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"

5. –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–æ–≤ –Ω–µ—Ç ‚Üí proposed_author = "–°–±–æ—Ä–Ω–∏–∫"

6. –°–æ–∑–¥–∞—Ç—å BookRecord:
   - file_path = –ø—É—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ library_path
   - metadata_authors = –∞–≤—Ç–æ—Ä—ã –∏–∑ FB2 XML (—Ö—Ä–∞–Ω—è—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª)
   - proposed_author = –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–≤—Ç–æ—Ä —Å –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–º–∏ conversions
   - author_source = "folder_dataset" / "filename" / "metadata" (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞)
   - file_title = –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ FB2
```

**–ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ –ø–æ –ø–∞–ø–∫–∞–º (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø–∞–ø–æ–∫ –≤ –æ–¥–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ)**
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
/Books/
  ‚îú‚îÄ –ì–æ–±–ª–∏–Ω (MeXXanik)/
  ‚îÇ   ‚îú‚îÄ –ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2
  ‚îÇ   ‚îú‚îÄ –¢—Ä–æ–µ –≤ –ª–æ–¥–∫–µ/book2.fb2
  ‚îÇ   ‚îî‚îÄ –°–µ—Ä–∏—è/book3.fb2
  ‚îú‚îÄ –î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä/
  ‚îÇ   ‚îú‚îÄ –ï–≥–æ –ü–µ—Ä–≤–∞—è –ö–Ω–∏–≥–∞/book4.fb2
  ‚îÇ   ‚îî‚îÄ –ï–≥–æ –í—Ç–æ—Ä–∞—è –ö–Ω–∏–≥–∞/book5.fb2
  ‚îî‚îÄ –¢—Ä–µ—Ç–∏–π/
      ‚îî‚îÄ book6.fb2

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ PASS 1:

–§–∞–π–ª: book1.fb2 (/Books/–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2)
  parents[0] = "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤"
  parents[1] = "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üê –ù–ê–ô–î–ï–ù–û! (–Ω–µ –≤ blacklist)
  
  author_source = "folder_dataset"
  proposed_author = "–ì–æ–±–ª–∏–Ω (MeXXanik)" ‚Üí conversions ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
  ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: folder_dataset="–ì–æ–±–ª–∏–Ω MeXXanik" –¥–ª—è –í–°–ï–• —Ñ–∞–π–ª–æ–≤ –ø–æ–¥ —ç—Ç–æ–π –ø–∞–ø–∫–æ–π

–§–∞–π–ª: book4.fb2 (/Books/–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä/–ï–≥–æ –ü–µ—Ä–≤–∞—è –ö–Ω–∏–≥–∞/book4.fb2)
  parents[0] = "–ï–≥–æ –ü–µ—Ä–≤–∞—è –ö–Ω–∏–≥–∞"
  parents[1] = "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä" ‚Üê –ù–ê–ô–î–ï–ù–û! (–¥—Ä—É–≥–æ–π –∞–≤—Ç–æ—Ä)
  
  author_source = "folder_dataset"
  proposed_author = "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä" ‚Üí conversions ‚Üí "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä"
  ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: folder_dataset="–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä" (–û–¢–î–ï–õ–¨–ù–ê–Ø –≥—Ä—É–ø–ø–∞ –æ—Ç book1)

–§–∞–π–ª: book6.fb2 (/Books/–¢—Ä–µ—Ç–∏–π/book6.fb2)
  parents[0] = "–¢—Ä–µ—Ç–∏–π"
  parents[1] = "Books" ‚Üí –Ω–µ –ø–æ—Ö–æ–∂ –Ω–∞ –∞–≤—Ç–æ—Ä–∞
  
  author_source = "folder_dataset" (–Ω–∞–π–¥–µ–Ω–æ)
  proposed_author = "–¢—Ä–µ—Ç–∏–π"
  ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: folder_dataset="–¢—Ä–µ—Ç–∏–π"

‚≠ê –ö–õ–Æ–ß–ï–í–û–ô –†–ï–ó–£–õ–¨–¢–ê–¢:
  - –í—Å–µ book1, book2, book3 –ø–æ–ª—É—á–∞—Ç folder_dataset="–ì–æ–±–ª–∏–Ω MeXXanik"
  - All book4, book5 –ø–æ–ª—É—á–∞—Ç folder_dataset="–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä"
  - book6 –ø–æ–ª—É—á–∏—Ç folder_dataset="–¢—Ä–µ—Ç–∏–π"
  - –ö–ê–ñ–î–ê–Ø –∞–≤—Ç–æ—Ä—Å–∫–∞—è –ø–∞–ø–∫–∞ = –æ—Ç–¥–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞!
```

**–ü—Ä–∏–º–µ—Ä 2: –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–±–æ—Ä–Ω–∏–∫–æ–≤ –≤ blacklist**
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
/Books/
  ‚îî‚îÄ –°–±–æ—Ä–Ω–∏–∫ –†–∞–∑–Ω—ã—Ö –ê–≤—Ç–æ—Ä–æ–≤/          ‚Üê –í blacklist!
      ‚îú‚îÄ –ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2
      ‚îú‚îÄ –î—Ä—É–≥–æ–π - –í—Ç–æ—Ä–∞—è –∫–Ω–∏–≥–∞.fb2
      ‚îî‚îÄ –¢—Ä–µ—Ç–∏–π - –¢—Ä–µ—Ç—å—è –∫–Ω–∏–≥–∞.fb2

–û–±—Ä–∞–±–æ—Ç–∫–∞: book.fb2 (–ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2)
  parents[0] = "–ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2" (—Å–∞–º —Ñ–∞–π–ª)
  parents[1] = "–°–±–æ—Ä–Ω–∏–∫ –†–∞–∑–Ω—ã—Ö –ê–≤—Ç–æ—Ä–æ–≤" ‚Üê –í blacklist? ("–°–±–æ—Ä–Ω–∏–∫") ‚Üí –ü–†–û–ü–£–°–¢–ò–¢–¨!
  
  ‚ùå –ü–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–∑–∞—â–∏—Ç–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞)
  ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –ü–æ–ø—ã—Ç–∫—É 2: –ø–∞—Ä—Å–∏–Ω–≥ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  
  author = "–ì–æ–±–ª–∏–Ω" (–∏–∑ "–ì–æ–±–ª–∏–Ω - –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞.fb2")
  author_source = "filename"
```

#### PASS 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (–ê–ö–¢–ò–í–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–ª—è —Ñ–∞–π–ª–æ–≤ –ë–ï–ó folder_dataset –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∏–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º.

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –∏–º—è —Ñ–∞–π–ª–∞ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- –ù–∞–±–æ—Ä –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–∑ config.json: `author_series_patterns_in_files`
- –í—Å–µ BookRecords (–¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ —Å–æ—Å–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã)

**–ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤ config.json (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –ø–æ –ø–æ—Ä—è–¥–∫—É, –ª—É—á—à–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–≤–ø–∞–¥—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø):**

```json
"author_series_patterns_in_files": [
  {"pattern": "(Author) - Title"},
  {"pattern": "Author - Title"},
  {"pattern": "Author. Title"},
  {"pattern": "Title (Author)"},
  {"pattern": "Title - (Author)"},
  {"pattern": "Author - Series.Title"},
  {"pattern": "Author. Series. Title"},
  {"pattern": "Author, Author. Title. (Series)"},
  {"pattern": "Author. Title. (Series)"},
  {"pattern": "Author - Title (Series. service_words)"},          ‚Üê 3 –≥—Ä—É–ø–ø—ã (–Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–π)
  {"pattern": "Author. Title (Series. service_words)"},           ‚Üê 3 –≥—Ä—É–ø–ø—ã
  {"pattern": "Author, Author - Title (Series. service_words)"}  ‚Üê 3 –≥—Ä—É–ø–ø—ã (–¥–ª—è multi-author)
]
```

**–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞:**
1. –ü–µ—Ä–µ–±—Ä–∞—Ç—å –í–°–ï –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞
2. –ù–∞–π—Ç–∏ –ø–∞—Ç—Ç–µ—Ä–Ω —Å –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ú –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–≤–ø–∞–¥—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø
3. –ü–†–ò–û–†–ò–¢–ï–¢: –ü–∞—Ç—Ç–µ—Ä–Ω —Å 3+ –≥—Ä—É–ø–ø–∞–º–∏ (–∞–≤—Ç–æ—Ä + –Ω–∞–∑–≤–∞–Ω–∏–µ + —Å–µ—Ä–∏—è) > –ø–∞—Ç—Ç–µ—Ä–Ω —Å 2 –≥—Ä—É–ø–ø–∞–º–∏ (–∞–≤—Ç–æ—Ä + –Ω–∞–∑–≤–∞–Ω–∏–µ)
4. **–ü—Ä–∏–º–µ—Ä:** –§–∞–π–ª "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π - –ü—Ä–æ–µ–∫—Ç ¬´–û–±–æ—Ä–æ—Ç–µ–Ω—å¬ª (–°—Ç—Ä–∞–Ω–Ω–∏–∫ 1-3) - 2021.fb2"
   - –ü–∞—Ç—Ç–µ—Ä–Ω "Author - Title" ‚Üí 2 –≥—Ä—É–ø–ø—ã, –Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤–µ—Å—å —Ç–µ–∫—Å—Ç –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∫–æ–±–∫–∏ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û)
   - –ü–∞—Ç—Ç–µ—Ä–Ω "Author - Title (Series. service_words)" ‚Üí 3 –≥—Ä—É–ø–ø—ã ‚úÖ –í–´–ë–†–ê–ù (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Å–∫–æ–±–∫–∏)

**Regex –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (–≤ _file_pattern_to_regex):**

```python
{
    "Author - Title (Series. service_words)": (
        r'^(?P<author>[^-]+?)\s*-\s*(?P<title>[^(]+?)\s*\((?P<series>[^)]+)\)(?:\s*-\s*.+)?$',
        ['author', 'title', 'series']
    ),
    "Author. Title (Series. service_words)": (
        r'^(?P<author>[^.]+)\.\s*(?P<title>[^(]+?)\s*\((?P<series>[^)]+)\)$',
        ['author', 'title', 'series']
    ),
    "Author, Author - Title (Series. service_words)": (
        r'^(?P<author>[^-]+?\s*,\s*[^-]+?)\s*-\s*(?P<title>[^(]+?)\s*\((?P<series>[^)]+)\)(?:\s*-\s*.+)?$',
        ['author', 'title', 'series']
    ),
}
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ `(?:\s*-\s*.+)?$` –≤ –∫–æ–Ω—Ü–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Å–∫–æ–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä "- 2021")
- ‚úÖ `[^-]+?` –¥–ª—è –∞–≤—Ç–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç non-greedy –ø–æ–∏—Å–∫ –¥–æ –ø–µ—Ä–≤–æ–≥–æ `-`
- ‚úÖ –î–ª—è multi-author –ø–∞—Ç—Ç–µ—Ä–Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ –∑–∞–ø—è—Ç–∞—è –≤ –≥—Ä—É–ø–ø–µ –∞–≤—Ç–æ—Ä–∞

**–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞:**

–ö–æ–≥–¥–∞ –ø–∞—Ç—Ç–µ—Ä–Ω –∏–∑–≤–ª–µ–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–º—è, –∞ –Ω–µ —Å–µ—Ä–∏—è/–æ–ø–∏—Å–∞–Ω–∏–µ:

```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∏–º–µ–Ω–∞–º:
   - –†–∞–∑–±–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞ (–ø–æ –ø—Ä–æ–±–µ–ª–∞–º, –∑–∞–ø—è—Ç—ã–º, —Ç–æ—á–∫–∞–º)
   - –ù–æ—Ä–º–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–∫—Ä–∏—Ç–∏–∫—É: "–ñ–µ—Ä–µ–±—å—ë–≤" ‚Üí "–∂–µ—Ä–µ–±—å–µ–≤"
   - ‚úÖ –ï–°–õ–ò –Ω–∞–π–¥–µ–Ω–æ —Å–ª–æ–≤–æ –≤ author_names (–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω–∞—Ö/—Ñ–∞–º–∏–ª–∏—è—Ö) ‚Üí –ø—Ä–∏–Ω—è—Ç—å –∞–≤—Ç–æ—Ä–∞

2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–º–µ–Ω–∏:
   - –ï–°–õ–ò –Ω–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –ø–æ—Ö–æ–∂–µ –ª–∏ –Ω–∞ –∏–º—è
   - –¢—Ä–µ–±—É–µ—Ç: —Å–æ–¥–µ—Ä–∂–∏—Ç –±—É–∫–≤—ã, 2-100 —Å–∏–º–≤–æ–ª–æ–≤, –±–µ–∑ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - ‚úÖ –ï–°–õ–ò –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∏–º—è –ò–ñ –ù–ï –ø–æ—Ö–æ–∂–µ –Ω–∞ —Å–µ—Ä–∏—é ‚Üí –ø—Ä–∏–Ω—è—Ç—å –∞–≤—Ç–æ—Ä–∞

3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —ç—Ç–æ –ù–ï —Å–µ—Ä–∏—è:
   - ‚ùå –ï—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–∞ –∏–∑ blacklist (—Å–±–æ—Ä–Ω–∏–∫, –∫–æ–º–ø–∏–ª—è—Ü–∏—è, etc) ‚Üí –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å
   - ‚ùå –ï—Å–ª–∏ —ç—Ç–æ 2-3 —Å–ª–æ–≤–∞ –ë–ï–ó –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω –∏ –ø–æ—Ö–æ–∂–µ –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–µ ‚Üí –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å
   - ‚úÖ –í–ê–ñ–ù–û: Single-word surnames (—Ñ–∞–º–∏–ª–∏–∏ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞) –ü–†–ò–ù–ò–ú–ê–Æ–¢–°–Ø!
     ¬∑ –ü—Ä–∏–º–µ—Ä: "–ñ–µ—Ä–µ–±—å—ë–≤" (–æ–¥–Ω–æ —Å–ª–æ–≤–æ) ‚Üí ‚úÖ –ø—Ä–∏–Ω—è–ª  
     ¬∑ –ü—Ä–∏–º–µ—Ä: "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞" (–¥–≤–∞ —Å–ª–æ–≤–∞, –Ω–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω) ‚Üí ‚ùå –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç –∫–∞–∫ —Å–µ—Ä–∏—è
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç: Single-word surnames vs. Series names**

–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–∑–ª–∏—á–∞—Ç—å:
- **Single-word surname:** "–ñ–µ—Ä–µ–±—å—ë–≤", "–ò–≤–∞–Ω–æ–≤", "–°–º–∏—Ä–Ω–æ–≤" (–∏–º–µ–Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤)
- **Multi-word phrase:** "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", "–î—Ä—É–≥–æ–π –º–∏—Ä" (–Ω–∞–∑–≤–∞–Ω–∏—è —Å–µ—Ä–∏–π)

–≠–≤—Ä–∏—Å—Ç–∏–∫–∞ `_looks_like_series_name()`:
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º: –µ—Å—Ç—å –ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–µ?
words_in_author_names = count(known_first_names_found)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
- –ï—Å–ª–∏ words > 0 ‚Üí —ç—Ç–æ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" —Å–æ–¥–µ—Ä–∂–∏—Ç "–∏–≤–∞–Ω")
- –ï—Å–ª–∏ words == 0 –ò 2-3 —Å–ª–æ–≤–∞ ‚Üí –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–µ—Ä–∏–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞")
- –ï—Å–ª–∏ words == 0 –ò 1 —Å–ª–æ–≤–æ ‚Üí —ç—Ç–æ —Ñ–∞–º–∏–ª–∏—è, –ù–ï —Å–µ—Ä–∏—è! (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ñ–µ—Ä–µ–±—å—ë–≤")
  
‚ö†Ô∏è –ü–û–ß–ï–ú–£ –æ–¥–Ω–æ —Å–ª–æ–≤–æ = —Ñ–∞–º–∏–ª–∏—è?
- author_names —Å–æ–¥–µ—Ä–∂–∏—Ç –¢–û–õ–¨–ö–û –ò–ú–ïÃÅ–ù–ê (first names) ‚Äî –ò–≤–∞–Ω, –ü–µ—Ç—Ä, –°–µ—Ä–≥–µ–π, etc.
- –§–∞–º–∏–ª–∏–∏ —Ä–µ–¥–∫–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∏–º–µ–Ω–Ω–æ first names)
- –ü–æ—ç—Ç–æ–º—É check "words_in_author_names == 0" –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ = —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ñ–∞–º–∏–ª–∏—è
- –°–µ—Ä–∏–∏ –æ–±—ã—á–Ω–æ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è, —Ä–µ–¥–∫–æ –æ–¥–Ω–æ —Å–ª–æ–≤–æ
```

**–ü—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

```
–°–ª—É—á–∞–π 1: Single-word surname
Text: "–ñ–µ—Ä–µ–±—å—ë–≤"
- Contains known first name? NO
- Structurally looks like name? YES (–±—É–∫–≤—ã, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞)
- Looks like series name? NO (1 —Å–ª–æ–≤–æ –æ–¥–Ω–æ)
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚úÖ –ü–†–ò–ù–Ø–õ –∫–∞–∫ –∞–≤—Ç–æ—Ä–∞

–°–ª—É—á–∞–π 2: Multi-word description
Text: "–ë–æ–µ–≤–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"
- Contains known first name? NO
- Structurally looks like name? YES (–±—É–∫–≤—ã)
- Looks like series name? YES (2 —Å–ª–æ–≤–∞, no known names) 
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚ùå –û–¢–í–ï–†–ì–ù–£–õ –∫–∞–∫ —Å–µ—Ä–∏—é

–°–ª—É—á–∞–π 3: First name present
Text: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
- Contains known first name? YES ("–∏–≤–∞–Ω")
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚úÖ –ü–†–ò–ù–Ø–õ (–Ω–µ –Ω—É–∂–Ω–∞ –¥–∞–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

–°–ª—É—á–∞–π 4: Part of known name
Text: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
- Contains "–∞–Ω–¥—Ä–µ–π"? YES (–≤ author_names)
- –†–ï–ó–£–õ–¨–¢–ê–¢: ‚úÖ –ü–†–ò–ù–Ø–õ (—Å–æ–¥–µ—Ä–∂–∏—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è)
```

**–ê–ª–≥–æ—Ä–∏—Ç–º PASS 2:**

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord —Å author_source != "folder_dataset":
  1. –ü–æ–ª—É—á–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
  2. –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –ø–æ –ª—É—á—à–µ–º—É —Å–æ–≤–ø–∞–¥–∞—é—â–µ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É:
     _extract_author_from_filename_by_patterns(filename)
     
  3. –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä –Ω–∞–π–¥–µ–Ω:
     a) –û—á–∏—Å—Ç–∏—Ç—å –æ—Ç –ø–∞—Ä–∞–∑–∏—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤: _clean_author_name()
        - –£–±—Ä–∞—Ç—å —Ü–∏—Ç–∞—Ç—ã: ¬´¬ª " '
        - –£–±—Ä–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫–æ–±–æ–∫: (xxx) ‚Üí –ø—É—Å—Ç–æ
        - –£–±—Ä–∞—Ç—å trailing dots: "–î–µ–º—á–µ–Ω–∫–æ." ‚Üí "–î–µ–º—á–µ–Ω–∫–æ"
        - –£–±—Ä–∞—Ç—å unneeded commas: "–î–µ–º—á–µ–Ω–∫–æ," ‚Üí "–î–µ–º—á–µ–Ω–∫–æ"
        - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å whitespace: multiple spaces ‚Üí single space
        
     b) –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–æ–≤: _process_and_expand_authors()
        - –®–∞–≥ 0: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ ("–ê–≤—Ç–æ—Ä, –ê–≤—Ç–æ—Ä" ‚Üí "–ê–≤—Ç–æ—Ä")
        - –®–∞–≥ 1: –†–∞–∑–±–∏—Ç—å –ø–æ –∑–∞–ø—è—Ç—ã–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä–æ–≤
        - –®–∞–≥ 2: –†–∞—Å—à–∏—Ä–∏—Ç—å –∫–∞–∂–¥–æ–≥–æ (–ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –Ω–∞–π—Ç–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è –≤ metadata):
          ¬∑ –î–ª—è 1-—Å–ª–æ–≤–∞ (—Ñ–∞–º–∏–ª–∏—è): –∏—Å–∫–∞—Ç—å –≤ metadata –∏ —Å–æ—Å–µ–¥–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö
          ¬∑ –î–ª—è 2-—Å–ª–æ–≤: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–Ω–æ–µ –∏–º—è –∏–ª–∏ 2 —Ä–∞–∑–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∞
        - –®–∞–≥ 3: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã post-expansion (—Å–æ—Ö—Ä–∞–Ω—è—è –ø–æ—Ä—è–¥–æ–∫)
        - –®–∞–≥ 3.5: ‚≠ê –û–¢–°–û–†–¢–ò–†–û–í–ê–¢–¨ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (A-Z, –ê-–Ø)
        - –®–∞–≥ 4: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º "; " (—Ç–æ—á–∫–∞-–∑–∞–ø—è—Ç–∞—è-–ø—Ä–æ–±–µ–ª)
        
  4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: record.proposed_author = final_author
     record.author_source = "filename"
```

**–ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ PASS 2:**

```
–°–ª—É—á–∞–π 1: –ü—Ä–æ—Å—Ç–æ–π multi-author —Ñ–∞–π–ª
Filename: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å - –ê–∫–∞–¥–µ–º–∏–∫ (–°—Ç—Ä–∞–Ω–Ω–∏–∫ 4-5) - 2022.fb2"
  Extracted: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
  Cleaned: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
  Expanded: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å" (–Ω–∞—à–ª–∏ –≤ metadata)
  Sorted: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
  ‚úÖ Final: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"

–°–ª—É—á–∞–π 2: 2-word name - –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–∏–º –∞–≤—Ç–æ—Ä–æ–º
Filename: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ (–°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏. –¢–µ—Ç—Ä–∞–ª–æ–≥–∏—è).fb2"
Metadata: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–≤—Ä–∞–º–µ–Ω–∫–æ"
  Extracted: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"
  Cleaned: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"
  Expansion check: 2 —Å–ª–æ–≤–∞ –Ω–∞–π–¥–µ–Ω—ã –≤ metadata –∫–∞–∫ –æ–¥–∏–Ω –∞–≤—Ç–æ—Ä ("–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–≤—Ä–∞–º–µ–Ω–∫–æ")
  ‚úÖ Final: "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä" (–≤ format of metadata –∏–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

–°–ª—É—á–∞–π 3: Single surname - —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–ª–Ω—ã–º –∏–º–µ–Ω–µ–º
Filename: "–î–µ–º—á–µ–Ω–∫–æ - –ë–æ—è—Ä–∏—á (–í–æ–∑–¥—É—à–Ω—ã–π —Å—Ç—Ä–µ–ª–æ–∫ 1-3).fb2"
Metadata: "–ê–Ω—Ç–æ–Ω –î–µ–º—á–µ–Ω–∫–æ"
  Extracted: "–î–µ–º—á–µ–Ω–∫–æ"
  Cleaned: "–î–µ–º—á–µ–Ω–∫–æ"
  Expanded: –ò—â–µ–º "–î–µ–º—á–µ–Ω–∫–æ" –≤ metadata ‚Üí "–ê–Ω—Ç–æ–Ω –î–µ–º—á–µ–Ω–∫–æ"
  ‚úÖ Final: "–î–µ–º—á–µ–Ω–∫–æ –ê–Ω—Ç–æ–Ω" (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

–°–ª—É—á–∞–π 4: Parasitic symbols
Filename: "–î–µ–º—á–µ–Ω–∫–æ. –ë–æ—è—Ä–∏—á (–í–æ–∑–¥—É—à–Ω—ã–π —Å—Ç—Ä–µ–ª–æ–∫ 1-3).fb2"
Metadata: "–ê–Ω—Ç–æ–Ω –î–µ–º—á–µ–Ω–∫–æ"
  Extracted: "–î–µ–º—á–µ–Ω–∫–æ"
  Cleaned: "–î–µ–º—á–µ–Ω–∫–æ" (trailing dot removed)
  Expanded: "–î–µ–º—á–µ–Ω–∫–æ –ê–Ω—Ç–æ–Ω"
  ‚úÖ Final: "–î–µ–º—á–µ–Ω–∫–æ –ê–Ω—Ç–æ–Ω"
```

**–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (–®–∞–≥ 3.5):**

–ö–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–æ–≤ –Ω–∞–π–¥–µ–Ω—ã, –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

```
Unsorted:  "–ü—Ä–æ–∑–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π"
Sorted:    "–ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π; –ü—Ä–æ–∑–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä"  ‚Üê –ê < –ü

Unsorted:  "–û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å; –ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π"  
Sorted:    "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"   ‚Üê –ó < –û
```

**–§—É–Ω–∫—Ü–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:**
```python
# –ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 3 (—É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤):
unique_authors.sort()  # ‚Üê –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è Python —Ñ—É–Ω–∫—Ü–∏—è, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ Unicode

# –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º "; "
return "; ".join(unique_authors)
```

#### PASS 2 Fallback: –ü—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫

**–£—Å–ª–æ–≤–∏–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:**
```
IF proposed_author == ""  (–ø—É—Å—Ç–æ –ø–æ—Å–ª–µ PASS 1 –ò PASS 2)
   ‚îú‚îÄ –Ω–∏ –ø–∞–ø–∫–∞ –Ω–µ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (PASS 1 –ø—É—Å—Ç–æ)
   ‚îî‚îÄ –Ω–∏ –∏–º—è —Ñ–∞–π–ª–∞ –Ω–µ –¥–∞–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (PASS 2 –ø—É—Å—Ç–æ)
   THEN ‚Üí –ø—Ä–∏–º–µ–Ω–∏—Ç—å metadata –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord —Å proposed_author == "":
   a) –ü–æ–ª—É—á–∏—Ç—å metadata_authors –∏–∑ FB2
   b) –ï—Å–ª–∏ metadata_authors –Ω–µ –ø—É—Å—Ç–æ:
      - –ü—Ä–∏–º–µ–Ω–∏—Ç—å _clean_author_name() (—É–±—Ä–∞—Ç—å –ø–∞—Ä–∞–∑–∏—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
      - –ü—Ä–∏–º–µ–Ω–∏—Ç—å surname_conversions
      - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: proposed_author = cleaned_metadata
      - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: author_source = "metadata"
   c) –ï—Å–ª–∏ metadata –ø—É—Å—Ç–æ:
      - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: proposed_author = "–°–±–æ—Ä–Ω–∏–∫"
      - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: author_source = ""
      
2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: "[PASS 2 Fallback] –§–∞–π–ª '–∏–º—è': metadata –∏—Å–ø. –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫"
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**

1. **Metadata –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –æ–±–∞ PASS 1 –∏ PASS 2 –¥–∞–ª–∏ –ü–£–°–¢–û**
   - ‚ùå –ù–ï –ø–æ–¥–º–µ–Ω—è–µ–º —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç PASS 1 –∏–ª–∏ PASS 2
   - ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–ú metadata –¢–û–õ–¨–ö–û –∫–∞–∫ –∫—Ä–∞–π–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫

2. **Metadata –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**
   - –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä—É –≤ Fallback ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ PASS 3-6
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç, –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å, —Ä–∞—Å–∫—Ä—ã—Ç—å –∞–±–±—Ä–µ—Ç—É—Ä—ã

**–ü—Ä–∏–º–µ—Ä—ã:**

```
CASE 1: –§–∞–π–ª —Å —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

File: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞.fb2"
Metadata: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"

PASS 1: –ü–∞–ø–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ ‚Üí –ø—É—Å—Ç–æ
PASS 2: –ò–º—è —Ñ–∞–π–ª–∞ –Ω–µ —Ä–∞—Å–ø–∞—Ä—Å–∏–ª–æ—Å—å ‚Üí –ø—É—Å—Ç–æ
PASS 2 Fallback:
  - proposed_author –ø—É—Å—Ç–æ ‚Üí –ø—Ä–∏–º–µ–Ω—è–µ–º metadata!
  - metadata_authors = "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
  - Clean + convert ‚Üí "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
  - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: proposed_author = "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤", author_source = "metadata"
  - ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ PASS 3 –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

PASS 3: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"
Final: proposed_author = "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω", author_source = "metadata"
```

```
CASE 2: –§–∞–π–ª –ë–ï–ó –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –ë–ï–ó —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

File: "–°—Ç—Ä–∞–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É–∫–≤.fb2"
Metadata: (–ø—É—Å—Ç–æ)

PASS 1: –ü–∞–ø–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ ‚Üí –ø—É—Å—Ç–æ
PASS 2: –ò–º—è —Ñ–∞–π–ª–∞ –Ω–µ —Ä–∞—Å–ø–∞—Ä—Å–∏–ª–æ—Å—å ‚Üí –ø—É—Å—Ç–æ
PASS 2 Fallback:
  - proposed_author –ø—É—Å—Ç–æ ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º metadata
  - metadata_authors —Ç–æ–∂–µ –ø—É—Å—Ç–æ ‚Üí "–°–±–æ—Ä–Ω–∏–∫"
  - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: proposed_author = "–°–±–æ—Ä–Ω–∏–∫", author_source = ""
  - ‚úÖ PASS 3 –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç "–°–±–æ—Ä–Ω–∏–∫"

Final: proposed_author = "–°–±–æ—Ä–Ω–∏–∫", author_source = ""
```

```
CASE 3: Multi-author –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

File: "book.fb2"
Metadata: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π"

PASS 1: –ü–∞–ø–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ ‚Üí –ø—É—Å—Ç–æ
PASS 2: –ò–º—è —Ñ–∞–π–ª–∞ –Ω–µ —Ä–∞—Å–ø–∞—Ä—Å–∏–ª–æ—Å—å ‚Üí –ø—É—Å—Ç–æ
PASS 2 Fallback:
  - proposed_author –ø—É—Å—Ç–æ ‚Üí –ø—Ä–∏–º–µ–Ω—è–µ–º metadata!
  - metadata_authors = "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π"
  - Clean + convert
  - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: proposed_author = "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π"
             author_source = "metadata"

PASS 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
  - "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π" ‚Üí "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π" (—É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
  - "–ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π" ‚Üí "–ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π" (—É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

Final: proposed_author = "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –ñ–∏–≤–æ–π –ê–ª–µ–∫—Å–µ–π", author_source = "metadata"
```

---

#### PASS 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord:
  1. –ï—Å–ª–∏ proposed_author == "–°–±–æ—Ä–Ω–∏–∫" ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
  2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å extractor._normalize_author_format(proposed_author)
     –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"
     –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã: "–ü–µ—Ç—Ä–æ–≤ –ò." ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò."
  3. –ï—Å–ª–∏ changed ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ "[PASS 3] –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: '–±—ã–ª–æ' ‚Üí '—Å—Ç–∞–ª–æ'"
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
"–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"       ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"
"–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω –°–µ—Ä–≥–µ–µ–≤–∏—á" ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"  (—Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –æ—Ç—á–µ—Å—Ç–≤–æ–º)
"–ü–µ—Ç—Ä–æ–≤ –ò."         ‚Üí "–ü–µ—Ç—Ä–æ–≤ –ò."          (–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)
"–ì–æ–±–ª–∏–Ω"            ‚Üí "–ì–æ–±–ª–∏–Ω"             (–æ–¥–Ω–æ —Å–ª–æ–≤–æ - –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)
```

#### PASS 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ 5 —Ñ–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ, –Ω–æ 1 —Ñ–∞–π–ª –∏–º–µ–µ—Ç –¥—Ä—É–≥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö ‚Üí –∫–∞–∫–æ–≥–æ –≤—ã–±—Ä–∞—Ç—å?

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û:** –ö–æ–Ω—Å–µ–Ω—Å—É—Å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –∫ —Ñ–∞–π–ª–∞–º —Å author_source="filename" –∏–ª–∏ "metadata"

**–ï—Å–ª–∏ author_source="folder_dataset" ‚Üí –ù–ï –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å!** –≠—Ç–æ —É–∂–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å BookRecords –ø–æ –ø–∞–ø–∫–µ (file_path.parent)
2. –î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª–æ–≤:
   a) –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã —Å author_source="folder_dataset" ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏—Ö
   b) –î–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ñ–∞–π–ª–æ–≤ (source="filename" –∏–ª–∏ "metadata"):
      - –ù–∞–π—Ç–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ (—Å–∞–º—ã–π —á–∞—Å—Ç—ã–π)
      - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∫ –∞–≤—Ç–æ—Ä—É
      - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞–≤—à–∏–º—Å—è —Ñ–∞–π–ª–∞–º –≥—Ä—É–ø–ø—ã
      - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å author_source = "consensus"
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
–ï—Å–ª–∏ –≤ –ø–∞–ø–∫–µ –µ—Å—Ç—å files —Å folder_dataset –∏ –±–µ–∑:
```
/Books/–°–µ—Ä–∏—è1/
  book1.fb2 ‚Üí author_source="folder_dataset" ("–ì–æ–±–ª–∏–Ω") ‚Üê –ù–ï –ú–ï–ù–Ø–¢–¨!
  book2.fb2 ‚Üí author_source="metadata" ("–î—Ä—É–≥–æ–π")     ‚Üê –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å
  book3.fb2 ‚Üí author_source="metadata" ("–ì–æ–±–ª–∏–Ω")     ‚Üê –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å
  
  –ö–æ–Ω—Å–µ–Ω—Å—É—Å –¥–ª—è book2, book3: "–ì–æ–±–ª–∏–Ω" (2 –∏–∑ 2 –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è = 100%)
  –†–µ–∑—É–ª—å—Ç–∞—Ç: book1 –æ—Å—Ç–∞—ë—Ç—Å—è "–ì–æ–±–ª–∏–Ω" (folder_dataset), book2,3 ‚Üí "–ì–æ–±–ª–∏–Ω" (consensus)
```

**–ü—Ä–∏–º–µ—Ä:**
```
–ü–∞–ø–∫–∞: /–°–µ—Ä–∏—è - –§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏ –±–æ–µ–≤–∏–∫/
  book1.fb2 ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik", author_source = "metadata"
  book2.fb2 ‚Üí proposed_author = "MeXXanik –ì–æ–±–ª–∏–Ω", author_source = "metadata"
  book3.fb2 ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω", author_source = "metadata"
  book4.fb2 ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik", author_source = "metadata"
  book5.fb2 ‚Üí proposed_author = "–î—Ä—É–≥–æ–π –ê–≤—Ç–æ—Ä", author_source = "metadata"

–ö–æ–Ω—Å–µ–Ω—Å—É—Å: "–ì–æ–±–ª–∏–Ω MeXXanik" (3 –∏–∑ 5)
–†–µ–∑—É–ª—å—Ç–∞—Ç: –í–°–ï 5 —Ñ–∞–π–ª–æ–≤ ‚Üí proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik", author_source = cons
```

#### PASS 5: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π —Ñ–∞–º–∏–ª–∏–π (–í—Ç–æ—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord:
   a) –ï—Å–ª–∏ proposed_author == "–°–±–æ—Ä–Ω–∏–∫" ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
   b) –ü—Ä–∏–º–µ–Ω–∏—Ç—å author_utils.apply_surname_conversions(proposed_author)
   c) –ï—Å–ª–∏ changed ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   d) –ó–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å extractor._normalize_author_format() –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

**–ü–æ—á–µ–º—É –¥–≤–∞ —Ä–∞–∑–∞?**
- PASS 1: –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ FB2
- PASS 5: –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω—è–µ–º –ø–æ—Å–ª–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ (–º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è, –µ—Å–ª–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å –∏–∑–º–µ–Ω–∏–ª –∞–≤—Ç–æ—Ä–∞)

**–ü—Ä–∏–º–µ—Ä:**
```
–ü–æ—Å–ª–µ PASS 4: proposed_author = "–ì–æ–±–ª–∏–Ω (MeXXanik)"
PASS 5: –ü—Ä–∏–º–µ–Ω–∏—Ç—å conversions ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
```

#### PASS 6: –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å –ø–æ–ª–Ω—ã—Ö –∏–º—ë–Ω –∏–∑ –≤—Å–µ—Ö proposed_author –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:
   authors_map = {
     "–ø–µ—Ç—Ä–æ–≤": ["–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω", "–ü–µ—Ç—Ä–æ–≤ –°–µ—Ä–≥–µ–π"],
     "–≥–æ–±–ª–∏–Ω": ["–ì–æ–±–ª–∏–Ω MeXXanik"]
   }

2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord:
   a) –ï—Å–ª–∏ proposed_author —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–∫—É (–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞):
      "–ò.–ü–µ—Ç—Ä–æ–≤" ‚Üí "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" (–ø–æ–∏—Å–∫ –≤ authors_map)
   b) –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
   c) –ï—Å–ª–∏ changed ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
"–ò.–ü–µ—Ç—Ä–æ–≤"       ‚Üí "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"   (–Ω–∞–π–¥–µ–Ω–æ –≤ authors_map)
"–°.–ì–æ–±–ª–∏–Ω"       ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ)
"–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è (–Ω–µ—Ç —Ç–æ—á–µ–∫)
```

---

## 5. –ö–ª–∞—Å—Å BookRecord

```python
@dataclass
class BookRecord:
    """–ó–∞–ø–∏—Å—å –æ –∫–Ω–∏–≥–µ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –Ω–∞ —Ä–∞–∑–Ω—ã—Ö PASS."""
    
    file_path: str              # –ü—É—Ç—å –∫ FB2 —Ñ–∞–π–ª—É (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ library_path)
    metadata_authors: str       # –ò—Å—Ö–æ–¥–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã –∏–∑ FB2 XML
    proposed_author: str        # –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –∏—Ç–æ–≥–æ–≤—ã–π –∞–≤—Ç–æ—Ä (evolves —á–µ—Ä–µ–∑ PASS)
    author_source: str          # –ò—Å—Ç–æ—á–Ω–∏–∫: "metadata", "folder_dataset", "filename", etc
    file_title: str             # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –∏–∑ title-info
    file_path_normalized: str   # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

**–ö–∞–∫ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è:**

```
PASS 1:
  file_path = "–ì–æ–±–ª–∏–Ω/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book.fb2"
  metadata_authors = "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)"
  proposed_author = "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω MeXXanik"    ‚Üê conversions –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
  author_source = "metadata"
  file_title = "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤"

PASS 3:
  proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik –ü–µ—Ç—Ä"    ‚Üê normalized format

PASS 4:
  (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ, –∫–æ–Ω—Å–µ–Ω—Å—É—Å —Å–æ–≤–ø–∞–ª)

PASS 5:
  proposed_author = "–ì–æ–±–ª–∏–Ω MeXXanik"         ‚Üê conversions –ø–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–µ–Ω—ã

PASS 6:
  (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–µ—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä)

```

---

## 6. CSV –í—ã—Ö–æ–¥: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

### 6.1 –ü–µ—Ä–µ—á–µ–Ω—å –∫–æ–ª–æ–Ω–æ–∫ (–≤ –ø–æ—Ä—è–¥–∫–µ —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ)

| ‚Ññ | –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---|---------|-----|---------|--------|
| 1 | `file_path` | str | –ü—É—Ç—å –∫ FB2 —Ñ–∞–π–ª—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ library_path | `–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2` |
| 2 | `metadata_authors` | str | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã –∏–∑ FB2 XML (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ) | `–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)` |
| 3 | `proposed_author` | str | –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ—Ä –ø–æ—Å–ª–µ –≤—Å–µ—Ö PASS (—ç–≤–æ–ª—é—Ü–∏—è –ø–æ PASS) | `–ì–æ–±–ª–∏–Ω MeXXanik` |
| 4 | `author_source` | str | –ò—Å—Ç–æ—á–Ω–∏–∫ –∞–≤—Ç–æ—Ä–∞ (PASS 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç) | `folder_dataset` / `filename` / `metadata` / `consensus` |
| 5 | `metadata_series` | str | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–∏–∏ –∏–∑ FB2 XML (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ) | `–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤` |
| 6 | `proposed_series` | str | –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–µ—Ä–∏—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö PASS (—ç–≤–æ–ª—é—Ü–∏—è –ø–æ PASS) | `–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤` |
| 7 | `series_source` | str | –ò—Å—Ç–æ—á–Ω–∏–∫ —Å–µ—Ä–∏–∏ (PASS 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç) | `folder_dataset` / `filename` / `metadata` / `consensus` |
| 8 | `file_title` | str | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ (–∏–∑ FB2 title-info) | `–ü–µ—Ä–≤–æ–µ –¥–µ–ª–æ` |


### 6.2 –ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä–æ–∫ CSV

```csv
file_path,metadata_authors,proposed_author,author_source,metadata_series,proposed_series,series_source,file_title
–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book1.fb2,–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik),–ì–æ–±–ª–∏–Ω MeXXanik,folder_dataset,–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤,–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤,folder_dataset,–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤
–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ/–ö–Ω–∏–≥–∞ –æ—Ç —Ñ–∞–π–ª–∞.fb2,–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ê–≤—Ç–æ—Ä,–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ,filename,,–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ,filename,–ö–Ω–∏–≥–∞ –æ—Ç —Ñ–∞–π–ª–∞
–°–±–æ—Ä–Ω–∏–∫/book3.fb2,–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤,–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω,metadata,,–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω,metadata,–¢—Ä–µ—Ç—å—è –∫–Ω–∏–≥–∞
–ö–æ–º–ø–∏–ª—è—Ü–∏—è/–°–µ—Ä–∏—è1/book4.fb2,–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω,–ì–æ–±–ª–∏–Ω MeXXanik,consensus,–°–µ—Ä–∏—è1,–°–±–æ—Ä–Ω–∏–∫,consensus,–ß–µ—Ç–≤–µ—Ä—Ç–∞—è
```

### 6.3 –≠–≤–æ–ª—é—Ü–∏—è `proposed_author` –∏ `proposed_series` –ø–æ PASS

```
PASS 1 (init):    author: "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)" (—Å conversions) ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik"
                  series: "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤" ‚Üí "–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤"
                  author_source = "folder_dataset", series_source = "folder_dataset"

PASS 2 (filename): author: "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (–∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞)
                  –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–æ–≤:
                    - "–ì–æ–±–ª–∏–Ω, –ü–µ—Ç—Ä–æ–≤" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik; –ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω" (sorted alphabetically!)
                  series: –∏–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑ —Å–∫–æ–±–æ–∫ –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
                  author_source = "filename"

PASS 3:           author: "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí "MeXXanik –ì–æ–±–ª–∏–Ω" (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
                  (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞)

PASS 4:           author: "MeXXanik –ì–æ–±–ª–∏–Ω" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (–∫–æ–Ω—Å–µ–Ω—Å—É—Å –ø—Ä–∏–º–µ–Ω–µ–Ω)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ–∑–∂–µ)
                  author_source = "consensus", series_source = "consensus" (–µ—Å–ª–∏ –±—ã–ª consensus)

PASS 5:           author: "–ì–æ–±–ª–∏–Ω MeXXanik" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (conversions –ø–µ—Ä–µ–ø—Ä–∏–º–µ–Ω–µ–Ω—ã)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

PASS 6:           author: "–ì.MeXXanik" ‚Üí "–ì–æ–±–ª–∏–Ω MeXXanik" (–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã —Ä–∞—Å–∫—Ä—ã—Ç—ã)
                  series: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

FINAL CSV ROW:    file_path | metadata_authors | proposed_author | author_source | metadata_series | proposed_series | series_source | file_title

‚≠ê –ö–õ–Æ–ß–ï–í–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï –í PASS 2:
   - Multi-author —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω
   - –ê–≤—Ç–æ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –°–û–†–¢–ò–†–£–Æ–¢–°–Ø –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –ø–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º
   - –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: "; " (—Ç–æ—á–∫–∞-–∑–∞–ø—è—Ç–∞—è-–ø—Ä–æ–±–µ–ª), –ù–ï –∑–∞–ø—è—Ç–∞—è
   - –ü—Ä–∏–º–µ—Ä: "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å" ‚Üí "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π; –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å"
```

### 6.4 –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```python
# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö PASS:
# 1. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å records –ø–æ file_path (–¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)
# 2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª CSV (–æ–±—ã—á–Ω–æ regen.csv –∏–ª–∏ —Å timestamp)
# 3. –ù–∞–ø–∏—Å–∞—Ç—å header: file_path,metadata_authors,proposed_author,author_source,metadata_series,proposed_series,series_source,file_title
# 4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ BookRecord:
#    - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è (–∫–∞–≤—ã—á–∫–∏ –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–ø—è—Ç—É—é)
#    - –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç—Ä–æ–∫—É CSV –≤ –ø–æ—Ä—è–¥–∫–µ: file_path, metadata_authors, proposed_author, author_source, metadata_series, proposed_series, series_source, file_title
# 5. –ó–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
```

---

## 7. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### 7.1 –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º—É—Å–æ—Ä

```python
blacklist = settings.get_filename_blacklist()
# blacklist = ["–∫–æ–º–ø–∏–ª—è—Ü–∏—è", "—Å–±–æ—Ä–Ω–∏–∫", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è", ...]

if any(word in proposed_author.lower() for word in blacklist):
    # –≠—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏, –∞ –Ω–µ –∞–≤—Ç–æ—Ä
    skip_record = True
```

### 6.2 –ü—Ä–∏–º–µ—Ä 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏–º–µ–Ω–∏/—Ñ–∞–º–∏–ª–∏–∏

```python
male_names = set(n.lower() for n in settings.get_male_names())
female_names = set(n.lower() for n in settings.get_female_names())
all_names = male_names | female_names

author = "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
first_word = author.split()[0].lower()

if first_word in all_names:
    order = "–ò–º—è –§–∞–º–∏–ª–∏—è"  # –ò–≤–∞–Ω - –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è
    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω"
else:
    order = "–§–∞–º–∏–ª–∏—è –ò–º—è –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
```

### 6.3 –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π

```python
conversions = settings.get_author_surname_conversions()
# conversions = {
#     "–ì–æ–±–ª–∏–Ω (MeXXanik)": "–ì–æ–±–ª–∏–Ω MeXXanik",
#     "–ê–π–∑–µ–Ω–±–µ—Ä–≥": "–ë–µ—Ä–≥",
#     ...
# }

original = "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω (MeXXanik)"
if "–ì–æ–±–ª–∏–Ω (MeXXanik)" in original:
    converted = original.replace("–ì–æ–±–ª–∏–Ω (MeXXanik)", conversions["–ì–æ–±–ª–∏–Ω (MeXXanik)"])
    # –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ü–µ—Ç—Ä –ì–æ–±–ª–∏–Ω MeXXanik"
```

### 6.4 –ü—Ä–∏–º–µ—Ä 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫

```python
folder_parse_limit = settings.get_folder_parse_limit()  # 3

file_path = Path("–ì–æ–±–ª–∏–Ω (MeXXanik)/–ê–¥–≤–æ–∫–∞—Ç –ß–µ—Ö–æ–≤/book.fb2")

# –ü–æ–∏—Å–∫ –∞–≤—Ç–æ—Ä–∞ –≤–≤–µ—Ä—Ö –Ω–∞ –º–∞–∫—Å–∏–º—É–º 3 —É—Ä–æ–≤–Ω—è
for i in range(min(folder_parse_limit, len(file_path.parts)-1)):
    parent = file_path.parents[i]
    # –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å parent –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–∞
```

---

## 7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### 7.1 –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ __init__

```python
from settings_manager import SettingsManager
from logger import Logger
from fb2_author_extractor import FB2AuthorExtractor
from author_normalizer_extended import AuthorNormalizerExtended  # –ù–æ–≤—ã–π –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –º–æ–¥—É–ª—å
```

### 7.2 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ RegenCSVService.__init__

```python
class RegenCSVService:
    def __init__(self, settings_manager=None):
        self.settings = settings_manager or SettingsManager('config.json')
        self.logger = Logger()
        self.extractor = FB2AuthorExtractor('config.json')
        self.normalizer = AuthorNormalizerExtended(self.settings, self.extractor)
        
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
        self.folder_parse_limit = self.settings.get_folder_parse_limit()
        self.data_dir = Path(self.settings.get_library_path())
        self.output_csv = Path(self.settings.get_last_scan_path()) / "regen.csv"
```

---

## 8. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 8.1 –î–û (—Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ - —É–¥–∞–ª—è–µ—Ç—Å—è)

```
regen_csv.py (1459 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ –ü–∞—Ä—Å–∏–Ω–≥ –ø–∞–ø–æ–∫ (PASS 1) ‚ùå –£–î–ê–õ–ò–¢–¨
‚îú‚îÄ‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ FB2 (PASS 2) ‚ùå –£–î–ê–õ–ò–¢–¨
‚îú‚îÄ‚îÄ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (PASS 3)  ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
‚îú‚îÄ‚îÄ –ö–æ–Ω—Å–µ–Ω—Å—É—Å (PASS 4)     ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
‚îú‚îÄ‚îÄ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (PASS 5)   ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
‚îî‚îÄ‚îÄ –†–∞—Å–∫—Ä—ã—Ç–∏–µ (PASS 6)     ‚úÖ –°–û–•–†–ê–ù–ò–¢–¨
```

### 8.2 –ü–û–°–õ–ï (–Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ - —Å–æ–∑–¥–∞—ë—Ç—Å—è)

```
author_normalizer_extended.py (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π)
‚îú‚îÄ‚îÄ AuthorName (–∏–∑ name_normalizer.py)
‚îú‚îÄ‚îÄ AuthorNormalizerExtended (–Ω–æ–≤—ã–π –∫–ª–∞—Å—Å)
‚îÇ   ‚îú‚îÄ‚îÄ normalize_single_name()
‚îÇ   ‚îú‚îÄ‚îÄ validate_author_name()
‚îÇ   ‚îú‚îÄ‚îÄ apply_surname_conversions()
‚îÇ   ‚îú‚îÄ‚îÄ apply_surname_conversions_to_records()
‚îÇ   ‚îú‚îÄ‚îÄ expand_abbreviated_authors()
‚îÇ   ‚îî‚îÄ‚îÄ apply_author_consensus()
‚îî‚îÄ‚îÄ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

regen_csv.py (–Ω–æ–≤—ã–π - ~500 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ BookRecord
‚îú‚îÄ‚îÄ RegenCSVService
‚îÇ   ‚îú‚îÄ‚îÄ PASS 1: _read_fb2_files()
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PASS 2: _extract_author_from_filename_by_patterns()
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _file_pattern_to_regex()          ‚Üê new: –ø–∞—Ç—Ç–µ—Ä–Ω—ã -> regex
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _clean_author_name()              ‚Üê new: —É–±—Ä–∞—Ç—å –ø–∞—Ä–∞–∑–∏—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _expand_author_to_full_name()     ‚Üê new: —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∏–∑ metadata
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _process_and_expand_authors()     ‚Üê new: –æ—Ä–∫–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å pipeline
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PASS 3: _normalize_authors()
‚îÇ   ‚îú‚îÄ‚îÄ PASS 4: _apply_consensus()
‚îÇ   ‚îú‚îÄ‚îÄ PASS 5: _apply_conversions()
‚îÇ   ‚îú‚îÄ‚îÄ PASS 6: _expand_abbreviations()
‚îÇ   ‚îú‚îÄ‚îÄ _read_fb2_metadata()
‚îÇ   ‚îú‚îÄ‚îÄ _save_csv()
‚îÇ   ‚îî‚îÄ‚îÄ regenerate()
‚îî‚îÄ‚îÄ if __name__ == "__main__": service.regenerate()

settings_manager.py          ‚Üê –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
fb2_author_extractor.py      ‚Üê –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
logger.py                    ‚Üê –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ PASS 2:**

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|-----------|-----------|-----------|
| `_file_pattern_to_regex()` | pattern_desc: str | Tuple[str, List[str]] | –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ ("Author - Title") –≤ regex —Å –≥—Ä—É–ø–ø–∞–º–∏ |
| `_extract_author_from_filename_by_patterns()` | filename: str | Optional[str] | –ò–∑–≤–ª–µ—á—å –∞–≤—Ç–æ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–æ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≥—Ä—É–ø–ø) |
| `_clean_author_name()` | extracted_author: str | str | –û—á–∏—Å—Ç–∏—Ç—å –æ—Ç —Ü–∏—Ç–∞—Ç, —Å–∫–æ–±–æ–∫, trailing dots, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å whitespace |
| `_expand_author_to_full_name()` | partial_author: str, metadata_authors: str | str | –†–∞—Å—à–∏—Ä–∏—Ç—å "–§–∞–º–∏–ª–∏—è" –¥–æ "–§–∞–º–∏–ª–∏—è –ò–º—è" –∏—Å–ø–æ–ª—å–∑—É—è metadata |
| `_process_and_expand_authors()` | cleaned_author: str, current_record: BookRecord, all_records: List[BookRecord] | str | –ü–æ–ª–Ω—ã–π pipeline: split ‚Üí expand ‚Üí deduplicate ‚Üí **sort** ‚Üí join —Å "; " |

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ PASS 2:**

‚úÖ –õ—É—á—à–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–≤–ø–∞–¥—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø (3 –≥—Ä—É–ø–ø—ã > 2 –≥—Ä—É–ø–ø—ã)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö —Ñ–∞–º–∏–ª–∏–π —á–µ—Ä–µ–∑ metadata –∏ —Å–æ—Å–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã
‚úÖ **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –ø–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º**
‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å "; " (—Ç–æ—á–∫–∞-–∑–∞–ø—è—Ç–∞—è-–ø—Ä–æ–±–µ–ª) –¥–ª—è multi-author –∑–∞–ø–∏—Å–µ–π
‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
```

---

## 9. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  RegenCSVService.regenerate()       ‚îÇ
‚îÇ  –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ CSV         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                     ‚îÇ
   PASS 1-6            Settings & Config
   read & process      SettingsManager
        ‚îÇ              ‚îÇ
        ‚îú‚Üí Logger       ‚îú‚Üí folder_parse_limit
        ‚îÇ              ‚îú‚Üí male_names
        ‚îî‚Üí FB2AuthorExtractor
           ‚îÇ            ‚îú‚Üí female_names
           ‚îú‚Üí _normalize_author_format()
           ‚îÇ            ‚îú‚Üí author_surname_conversions
           ‚îî‚Üí expand methods
                        ‚îú‚Üí filename_blacklist
                        ‚îî‚Üí service_words

   AuthorNormalizerExtended
   ‚îú‚Üí apply_surname_conversions()
   ‚îú‚Üí apply_author_consensus()
   ‚îú‚Üí expand_abbreviated_authors()
   ‚îî‚Üí build_authors_map()
```

---

## 10. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ regen_csv.py

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ | –§—É–Ω–∫—Ü–∏—è | –ü—Ä–∏–º–µ—Ä |
|---|---|---|---|---|
| `folder_parse_limit` | int | PASS 1 (stub) | –ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ –ø–∞–ø–æ–∫ | 3 |
| `author_surname_conversions` | Dict | PASS 1, 5 | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–∞–º–∏–ª–∏–π | `{"–ì–æ–±–ª–∏–Ω (MeXXanik)": "–ì–æ–±–ª–∏–Ω MeXXanik"}` |
| `male_names` | List | PASS 3, 6 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏–º—ë–Ω | `["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–Ω–¥—Ä–µ–π", ...]` |
| `female_names` | List | PASS 3, 6 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏–º—ë–Ω | `["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ê–Ω–Ω–∞", ...]` |
| `filename_blacklist` | List | PASS 1, 3 | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º—É—Å–æ—Ä–∞ | `["—Å–±–æ—Ä–Ω–∏–∫", "–∞–Ω—Ç–æ–ª–æ–≥–∏—è", ...]` |
| `library_path` | str | PASS 1 | –ü–∞–ø–∫–∞ —Å FB2 —Ñ–∞–π–ª–∞–º–∏ | `"C:/Users/.../EBook Library"` |
| `generate_csv` | bool | –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª | –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏ CSV | `true` |
| `author_series_patterns_in_files` | List[Dict] | PASS 2 | –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ | [—Å–º. –Ω–∏–∂–µ] |

### 10.1 –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è PASS 2: author_series_patterns_in_files

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Feb 2026):

```json
"author_series_patterns_in_files": [
  {
    "pattern": "(Author) - Title",
    "example": "(–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤) - –ò—Å—Ç–æ—Ä–∏—è –†–æ—Å—Å–∏–∏.fb2"
  },
  {
    "pattern": "Author - Title",
    "example": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ - –ò—Å—Ç–æ—Ä–∏—è –†–æ—Å—Å–∏–∏.fb2"
  },
  {
    "pattern": "Author. Title",
    "example": "–ë–µ–ª–æ—É—Å. –ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞.fb2"
  },
  {
    "pattern": "Title (Author)",
    "example": "–í–æ–π–Ω–∞ –∏ –º–∏—Ä (–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π).fb2"
  },
  {
    "pattern": "Title - (Author)",
    "example": "–í–æ–π–Ω–∞ –∏ –º–∏—Ä - (–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π).fb2"
  },
  {
    "pattern": "Author - Series.Title",
    "example": "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ 1. –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏.fb2"
  },
  {
    "pattern": "Author. Series. Title",
    "example": "–ê–Ω–∏—Å–∏–º–æ–≤. –í–∞—Ä–∏–∞–Ω—Ç ¬´–ë–∏—Å¬ª 2. –ì–æ–¥ –º–µ—Ä—Ç–≤–æ–π –∑–º–µ–∏.fb2"
  },
  {
    "pattern": "Author, Author. Title. (Series)",
    "example": "–ñ–∏–≤–æ–π, –ü—Ä–æ–∑–æ—Ä–æ–≤. –õ–µ–≥–∏–æ–Ω (–õ–µ–≥–∏–æ–Ω 1-3).fb2"
  },
  {
    "pattern": "Author. Title. (Series)",
    "example": "–ê–Ω–∏—Å–∏–º–æ–≤. –í–∞—Ä–∏–∞–Ω—Ç ¬´–ë–∏—Å¬ª 2. –ì–æ–¥ –º–µ—Ä—Ç–≤–æ–π –∑–º–µ–∏.fb2"
  },
  {
    "pattern": "Author - Title (Series. service_words)",
    "example": "–ê–≤—Ä–∞–º–µ–Ω–∫–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä - –°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏ (–°–æ–ª–¥–∞—Ç —É–¥–∞—á–∏. –¢–µ—Ç—Ä–∞–ª–æ–≥–∏—è).fb2",
    "note": "FIXED Feb 2026: –¢–µ–ø–µ—Ä—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Å–∫–æ–±–∫–∏ (e.g., ' - 2021')"
  },
  {
    "pattern": "Author. Title (Series. service_words)",
    "example": "–î–µ–º—á–µ–Ω–∫–æ. –•–æ–ª—å–º–≥—Ä–∞–¥—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (–•–æ–ª—å–º–≥—Ä–∞–¥—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏. –¢—Ä–∏–ª–æ–≥–∏—è).fb2"
  },
  {
    "pattern": "Author, Author - Title (Series. service_words)",
    "example": "–ó–µ–º–ª—è–Ω–æ–π –ê–Ω–¥—Ä–µ–π, –û—Ä–ª–æ–≤ –ë–æ—Ä–∏—Å - –ê–∫–∞–¥–µ–º–∏–∫ (–°—Ç—Ä–∞–Ω–Ω–∏–∫ 4-5) - 2022.fb2",
    "note": "NEW Feb 2026: –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è multi-author —Ñ–∞–π–ª–æ–≤ —Å —Å–µ—Ä–∏–µ–π –≤ —Å–∫–æ–±–∫–∞—Ö"
  }
]
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Feb 2026:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω regex –¥–ª—è "Author - Title (Series. service_words)" - —Ç–µ–ø–µ—Ä—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω "Author, Author - Title (Series. service_words)" –¥–ª—è multi-author —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ–ø–µ—Ä—å —É—á–∏—Ç—ã–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–ª–æ–≤ –≤ series (—Ç–æ–º, –∫–Ω–∏–≥–∞, —á–∞—Å—Ç—å, —Ç–µ—Ç—Ä–∞–ª–æ–≥–∏—è, –¥–∏–ª–æ–≥–∏—è, –∏ —Ç.–¥.)

---

## 11. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ (Feb 2026)

### 11.1 Commit 5431307: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Ñ–∞–º–∏–ª–∏–∏ –ø—Ä–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ –∏–º–µ–Ω–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** "–ò–≤–∞–Ω–æ–≤ –î–º–∏—Ç—Ä–∏–π" –∏–∑ —Ñ–∞–π–ª–∞ ‚Üí "–î–º–∏—Ç—Ä–∏–π" –≤ –≤—ã–≤–æ–¥–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `_expand_author_to_full_name()` –∑–∞–º–µ–Ω—è–ª–∞ –±–æ–ª–µ–µ –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –Ω–∞ –º–µ–Ω–µ–µ –ø–æ–ª–Ω—É—é –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–º–µ–Ω–æ–π
if len(words) > len(full_name_words):
    return partial_author  # –ë–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ filename
else:
    return full_name  # –ë–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ metadata
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–ò–≤–∞–Ω–æ–≤ –î–º–∏—Ç—Ä–∏–π" –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º

---

### 11.2 Commit 0e2478a: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Å–ª–æ–≤ –≤ –∏–º–µ–Ω–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** "–¢—ë –ò–ª—å—è" –∏–∑ —Ñ–∞–π–ª–∞ ‚Üí "–ò–ª—å—è –¢–µ" (–ø–µ—Ä–µ–ø—É—Ç–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤)

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è –Ω–∞—Ö–æ–¥–∏–ª–∞ –æ–±–∞ —Å–ª–æ–≤–∞ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –Ω–æ –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –≤–µ—Ä—Å–∏—é –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å–ª–∏ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å–ª–æ–≤–∞ –≤ —Ä–∞–∑–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
partial_words_set = set(w.lower() for w in words)
full_name_words_set = set(w.lower() for w in full_name_words)
if (len(words) == len(full_name_words) and 
    partial_words_set == full_name_words_set):
    return partial_author  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –∏–∑ filename
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–¢–µ –ò–ª—å—è" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤

---

### 11.3 Commit 8b3875b: –°–±–æ—Ä –≤—Å–µ—Ö —Å–æ–∞–≤—Ç–æ—Ä–æ–≤-–æ–¥–Ω–æ—Ñ–∞–º–∏–ª—å—Ü–µ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** Filename "–ë–µ–ª–∞—à" + metadata "–õ—é–¥–º–∏–ª–∞ –ë–µ–ª–∞—à; –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë–µ–ª–∞—à" ‚Üí —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞–≤—Ç–æ—Ä

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞—Å—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –≤ —Ü–∏–∫–ª–µ.

**–†–µ—à–µ–Ω–∏–µ:**
```python
matching_authors = []  # –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –∞–≤—Ç–æ—Ä–æ–≤
for full_name in metadata_authors_list:
    if surname_matches(full_name, surname):
        matching_authors.append(full_name)

# –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –∞–≤—Ç–æ—Ä–æ–≤ - –≤–µ—Ä–Ω—É—Ç—å –∏—Ö
if matching_authors:
    if len(matching_authors) > 1:
        matching_authors.sort()
        return "; ".join(matching_authors)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë–µ–ª–∞—à; –õ—é–¥–º–∏–ª–∞ –ë–µ–ª–∞—à" (–æ–±–∞ —Å–æ–∞–≤—Ç–æ—Ä–∞), –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

### 11.4 Commit 1d0d26f: –î–µ–±–∞–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è PASS 2 - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–æ–∫ + –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ü–∞–ø–∫–∞ "–ñ–µ—Ä–µ–±—å—ë–≤" –ø–∞—Ä—Å–∏–ª–∞—Å—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –æ—Ç–¥–µ–ª—å–Ω–æ (–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
2. "–ñ–µ—Ä–µ–±—å—ë–≤" –Ω–µ –≤ known_authors ‚Üí `_contains_author_name()` –≤–æ–∑–≤—Ä–∞—â–∞–ª False
3. CSV –æ—à–∏–±–æ—á–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–ª proposed_author = "–õ–µ–Ω–ò–∑–¥–∞—Ç" (–∏–∑ –ø–∞–ø–∫–∏) –≤–º–µ—Å—Ç–æ "–ñ–µ—Ä–µ–±—å—ë–≤"

**–†–µ—à–µ–Ω–∏—è:**

#### A. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–ø–æ–∫ –≤ PASS 2
```python
folder_cache = {}  # –ö–ª—é—á: –ø–∞–ø–∫–∞, –ó–Ω–∞—á–µ–Ω–∏–µ: –∞–≤—Ç–æ—Ä

for folder_path in parts_to_check:
    if folder_path in folder_cache:
        parsed_author = folder_cache[folder_path]
    else:
        parsed_author = self._parse_author_from_folder_name(folder_name)
        folder_cache[folder_path] = parsed_author  # –ö–µ—à–∏—Ä—É–µ–º
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ö–∞–∂–¥–∞—è –ø–∞–ø–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë ‚Üí –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

#### B. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–∫—Ä–∏—Ç–∏–∫–∏ –≤ `_contains_author_name()`
```python
def _normalize_diacritics(self, text: str) -> str:
    """–ñ–µ—Ä–µ–±—å—ë–≤ ‚Üí –∂–µ—Ä–µ–±—å–µ–≤"""
    nfd = unicodedata.normalize('NFD', text)
    return ''.join(c for c in nfd if unicodedata.category(c) != 'Mn')

# –í –ø—Ä–æ–≤–µ—Ä–∫–µ:
text_normalized = self._normalize_diacritics(text_lower)
```

**–≠—Ñ—Ñ–µ–∫—Ç:** "–ñ–µ—Ä–µ–±—å—ë–≤" (—Å —ë) —Ç–µ–ø–µ—Ä—å —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å "–∂–µ—Ä–µ–±—å–µ–≤" (–±–µ–∑ –¥–∏–∞–∫—Ä–∏—Ç–∏–∫–∏) –≤ –∫–æ–Ω—Ñ–∏–≥–µ

#### C. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ `_looks_like_author_name()`
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–º–µ–Ω–∏ –ë–ï–ó —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±—ã—Ç—å –≤ known_authors
def _looks_like_author_name(self, text: str) -> bool:
    if len(text) < 2 or len(text) > 100:
        return False
    has_letter = any(c.isalpha() for c in text)
    if not has_letter:
        return False
    # –ù–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ —á–∏—Å–µ–ª
    return True

# –í extraction:
if self._contains_author_name(author) or self._looks_like_author_name(author):
    best_author = author
```

**–≠—Ñ—Ñ–µ–∫—Ç:** "–ñ–µ—Ä–µ–±—å—ë–≤" —Ç–µ–ø–µ—Ä—å –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ filename –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –≤ known_authors

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
proposed_author: "–í–ª–∞–¥–∏—Å–ª–∞–≤ –ñ–µ—Ä–µ–±—å–µ–≤" (–≤–º–µ—Å—Ç–æ –æ—à–∏–±–æ—á–Ω–æ–≥–æ "–õ–µ–Ω–ò–∑–¥–∞—Ç")
normalized_author: "–ñ–µ—Ä–µ–±—å–µ–≤ –í–ª–∞–¥–∏—Å–ª–∞–≤"
source: "filename"
```

---

### 11.5 Commit 9bd28a8: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Ñ–∞–º–∏–ª–∏–π –¥–ª—è —Å–æ–∞–≤—Ç–æ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** Filename "–ö–∞–º–µ–Ω—Å–∫–∏–µ - –í–∏—Ç—è–∑—å.fb2" (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ) + metadata "–Æ—Ä–∏–π –ö–∞–º–µ–Ω—Å–∫–∏–π; –í–µ—Ä–∞ –ö–∞–º–µ–Ω—Å–∫–∞—è" ‚Üí –æ–±–∞ –∞–≤—Ç–æ—Ä–∞ —Ç–µ—Ä—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** "–ö–∞–º–µ–Ω—Å–∫–∏–µ" –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª —Å "–ö–∞–º–µ–Ω—Å–∫–∏–π" –∏–ª–∏ "–ö–∞–º–µ–Ω—Å–∫–∞—è"

**–†–µ—à–µ–Ω–∏—è:**

#### A. –§—É–Ω–∫—Ü–∏—è `_extract_surname_from_fullname()` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–∞–º–∏–ª–∏–∏
```python
def _extract_surname_from_fullname(self, full_name: str) -> str:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ñ–∞–º–∏–ª–∏—é –∏–∑ –ø–æ–ª–Ω–æ–≥–æ –∏–º–µ–Ω–∏, –ø—Ä–æ–≤–µ—Ä—è—è –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –ø—Ä–æ—Ç–∏–≤ known_names
    
    –õ–æ–≥–∏–∫–∞:
    1. –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ª–æ–≤–∞
    2. –ò—â–µ–º –∫–∞–∫–æ–µ —Å–ª–æ–≤–æ –µ—Å—Ç—å –≤ known_names (—ç—Ç–æ –ò–ú–Ø)
    3. –û—Å—Ç–∞–ª—å–Ω–æ–µ = –§–ê–ú–ò–õ–ò–Ø
    4. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã (–ê., –ê.–í., –ê.–í.–ú.)
    
    –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞:
    - "–Æ—Ä–∏–π –ö–∞–º–µ–Ω—Å–∫–∏–π" ‚Üí "–ö–∞–º–µ–Ω—Å–∫–∏–π"
    - "–ö–∞–º–µ–Ω—Å–∫–∏–π –Æ—Ä–∏–π" ‚Üí "–ö–∞–º–µ–Ω—Å–∫–∏–π"
    - "–ê.–í. –ß–µ—Ö–æ–≤" ‚Üí "–ß–µ—Ö–æ–≤"
    - "–ß–µ—Ö–æ–≤ –ê.–í." ‚Üí "–ß–µ—Ö–æ–≤"
    """
```

**–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ù–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ —Ñ–∞–º–∏–ª–∏—è –≤—Å–µ–≥–¥–∞ –≤ –∫–æ–Ω—Ü–µ –∏–ª–∏ –≤ –Ω–∞—á–∞–ª–µ - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–æ—Ç–∏–≤ `known_names`

#### B. –§—É–Ω–∫—Ü–∏—è `_normalize_surname_endings()` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏–π
```python
def _normalize_surname_endings(self, surname: str) -> str:
    """–£–¥–∞–ª—è–µ—Ç –≥–µ–Ω–¥–µ—Ä–Ω—ã–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä—É—Å—Å–∫–∏—Ö —Ñ–∞–º–∏–ª–∏–π
    
    –ö–∞–º–µ–Ω—Å–∫–∏–µ ‚Üí –ö–∞–º–µ–Ω—Å–∫ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ)
    –ö–∞–º–µ–Ω—Å–∫–∏–π ‚Üí –ö–∞–º–µ–Ω—Å–∫ (–º—É–∂—Å–∫–æ–µ)
    –ö–∞–º–µ–Ω—Å–∫–∞—è ‚Üí –ö–∞–º–µ–Ω—Å–∫ (–∂–µ–Ω—Å–∫–æ–µ)
    –ö–æ–ª—å—Ü–∫–∏–µ ‚Üí –ö–æ–ª—å—Ü
    –ö–æ–ª—å—Ü–∫–∏–π ‚Üí –ö–æ–ª—å—Ü
    –ö–æ–ª—å—Ü–∫–∞—è ‚Üí –ö–æ–ª—å—Ü
    """
```

#### C. –û–±–Ω–æ–≤–ª–µ–Ω–∞ `_expand_author_to_full_name()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
```python
# –ò–∑–≤–ª–µ–∫–∞–µ–º —Ñ–∞–º–∏–ª–∏—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ
metadata_surname = self._extract_surname_from_fullname(full_name)
metadata_surname_normalized = self._normalize_surname_endings(metadata_surname)

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ—Ä–Ω–∏
if surname_normalized_lower == metadata_surname_normalized_lower:
    matching_authors.append(full_name)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
filename: "–ö–∞–º–µ–Ω—Å–∫–∏–µ - –í–∏—Ç—è–∑—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.fb2"
proposed_author: "–Æ—Ä–∏–π –ö–∞–º–µ–Ω—Å–∫–∏–π; –í–µ—Ä–∞ –ö–∞–º–µ–Ω—Å–∫–∞—è"
normalized_author: "–ö–∞–º–µ–Ω—Å–∫–∞—è –í–µ—Ä–∞, –ö–∞–º–µ–Ω—Å–∫–∏–π –Æ—Ä–∏–π"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ —Å–ª–æ–≤ –≤ –∏–º–µ–Ω–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–æ–≤ –∏ –≥–µ–Ω–¥–µ—Ä–Ω—ã—Ö –æ–∫–æ–Ω—á–∞–Ω–∏–π
- –°–æ–±–∏—Ä–∞–µ—Ç –í–°–ï —Å–æ–∞–≤—Ç–æ—Ä–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ñ–∞–º–∏–ª–∏–µ–π

---

## –ì–æ—Ç–æ–≤–æ.


## 9. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ (Co-authorship)

### 9.1 –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, '–ë–µ–ª–∞—à –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –õ—é–¥–º–∏–ª–∞') —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–±–∞ –∏–º–µ–Ω–∏ –≤ –ø–æ–ª–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –§–ò.
